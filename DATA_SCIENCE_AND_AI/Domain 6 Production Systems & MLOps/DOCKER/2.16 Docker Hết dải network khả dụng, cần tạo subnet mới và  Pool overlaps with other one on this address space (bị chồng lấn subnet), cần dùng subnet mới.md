```
=> CACHED [intent-api 8/10] RUN pip3 install --no-cache-dir --upgrade pip && pip3 install --no-cache-dir -r /app/requi 0.0s => CACHED [intent-api 9/10] COPY src/ /app/src/ 0.0s => CACHED [intent-api 10/10] RUN mkdir -p /app/src/logs 0.0s => [intent-api] exporting to image 0.0s => => exporting layers 0.0s => => writing image sha256:f82813ab1604d9c58868f6d27b9ac37fdf15a01eb3c227088b45a42362d255f4 0.0s => => naming to docker.io/library/miniprod_nlp2_intentclassification_mappingfastresponse_t1_2025_stepupeducation-intent-api 0.0s [+] Running 1/0 âœ˜ Network miniprod_nlp2_intentclassification_mappingfastresponse_t1_2025_stepupeducation_intent-network Error 0.0s failed to create network miniprod_nlp2_intentclassification_mappingfastresponse_t1_2025_stepupeducation_intent-network: Error response from daemon: could not find an available, non-overlapping IPv4 address pool among the defaults to assign to the network Î¸73Â° [ubuntu@mgc-dev2-3090:~/truc_ai/MiniProd_NLP2_IntentClassification_MappingFastResponse_T1_2025_StepUpEducation/src] master(+10/-4)* Â± Lá»—i gÃ¬ Ä‘Ã¢y nhá»‰
```

## 1. Váº¥n Ä‘á» gáº·p pháº£i

### Lá»—i chÃ­nh

```
failed to create network miniprod_nlp2_intentclassification_mappingfastresponse_t1_2025_stepupeducation_intent-network: 
Error response from daemon: could not find an available, non-overlapping IPv4 address pool among the defaults to assign to the network
```

### Triá»‡u chá»©ng

- Docker Compose khÃ´ng thá»ƒ táº¡o custom network má»›i
- Container build thÃ nh cÃ´ng nhÆ°ng khÃ´ng thá»ƒ start do lá»—i network
- Lá»—i xáº£y ra liÃªn tá»¥c dÃ¹ Ä‘Ã£ thá»­ docker network prune

### NguyÃªn nhÃ¢n gá»‘c rá»…

Docker daemon Ä‘Ã£ cáº¡n kiá»‡t cÃ¡c dáº£i IP kháº£ dá»¥ng do cÃ³ quÃ¡ nhiá»u networks Ä‘ang tá»“n táº¡i trÃªn há»‡ thá»‘ng.

## 2. Kiá»ƒm tra cÃ¡c máº¡ng hiá»‡n táº¡i

### Network inventory

Há»‡ thá»‘ng hiá»‡n cÃ³ **30+ Docker networks** Ä‘ang hoáº¡t Ä‘á»™ng:

```bash
$ docker network ls
NETWORK ID     NAME                                                                   DRIVER    SCOPE
1ee83a85e17e   ai-agent-coach_robot-ai-workflow-network-master                        bridge    local
01684692a642   ai-agent-master_robot-ai-workflow-network-master                       bridge    local
22a276825d4a   ai-agent-noti_robot-ai-workflow-network-master                         bridge    local
b4815173bfb5   ai-agent-router-dev_robot-ai-workflow-network-master                   bridge    local
# ... vÃ  25+ networks khÃ¡c
```

```bash
docker network ls -q | xargs -n1 docker network inspect --format '{{.Name}}: {{range .IPAM.Config}}{{.Subnet}} (gw {{.Gateway}}){{end}}'

```

```
Î¸74Â° [ubuntu@mgc-dev2-3090:~/cuong_dn/robot-lesson-workflow/utils/UI] manual-refactor-agent-registry(+9/-4)+* Â± docker network ls -q | xargs -n1 docker network inspect --format '{{.Name}}: {{range .IPAM.Config}}{{.Subnet}} (gw {{.Gateway}}){{end}}'
ai-agent-coach_robot-ai-workflow-network-master: 192.168.160.0/20 (gw 192.168.160.1)
ai-agent-master_robot-ai-workflow-network-master: 172.22.0.0/16 (gw 172.22.0.1)
ai-agent-noti_robot-ai-workflow-network-master: 172.24.0.0/16 (gw 172.24.0.1)
ai-agent-router-dev_robot-ai-workflow-network-master: 192.168.224.0/20 (gw 192.168.224.1)
ai-agent-router_robot-ai-workflow-network-master: 192.168.144.0/20 (gw 192.168.144.1)
ai_service_default: 172.23.0.0/16 (gw 172.23.0.1)
bridge: 172.17.0.0/16 (gw 172.17.0.1)
deploy_default: 172.31.0.0/16 (gw 172.31.0.1)
deployapi_server_default: 192.168.192.0/20 (gw 192.168.192.1)
deployproduction_intent_network: 192.168.128.0/20 (gw 192.168.128.1)
dify_default_dev: 192.168.176.0/20 (gw 192.168.176.1)
dify_ssrf_proxy_network_dev: 192.168.112.0/20 (gw 192.168.112.1)
docker_default: 172.25.0.0/16 (gw 172.25.0.1)
docker_ssrf_proxy_network: 192.168.240.0/20 (gw 192.168.240.1)
host: 
kokoro_default: 172.26.0.0/16 (gw 172.26.0.1)
langfuse_default: 170.28.0.0/24 (gw )
langgraph_n8n_langgraph-n8n-network-master: 172.19.0.0/16 (gw 172.19.0.1)
legal_rag: 192.168.80.0/20 (gw 192.168.80.1)
lesson-builder-backend_web: 170.26.0.0/24 (gw )
ls_ai_automation_default: 172.28.0.0/16 (gw 172.28.0.1)
milvus: 172.21.0.0/16 (gw 172.21.0.1)
miniprod_nlp2_intentclassification_mappingfastresponse_t1_2025_stepupeducation_intent-network: 10.20.0.0/24 (gw 10.20.0.1)
n8n_n8n-services-network-master: 172.18.0.0/16 (gw 172.18.0.1)
none: 
personalized-ai-coach-dev_robot-ai-workflow-network-master: 192.168.64.0/20 (gw 192.168.64.1)
personalized-ai-coach_robot-ai-workflow-network-master: 192.168.32.0/20 (gw 192.168.32.1)
prod_deploy_default: 172.29.0.0/16 (gw 172.29.0.1)
robot-ai-lesson_robot-ai-workflow-network-master: 192.168.48.0/20 (gw 192.168.48.1)
robot-ai-service_default: 172.27.0.0/16 (gw 172.27.0.1)
robot-ai-workflow-dev_robot-ai-workflow-network-dev: 172.30.0.0/16 (gw 172.30.0.1)
robot-ai-workflow_robot-ai-workflow-network-master: 192.168.0.0/20 (gw 192.168.0.1)
robot-lesson-workflow-dev_studio-ai-platform-workflow-network-master: 192.168.16.0/20 (gw 192.168.16.1)
tool_su_table_to_json_default: 192.168.208.0/20 (gw 192.168.208.1)
vioedu_vioedu-generator-math-network: 192.168.96.0/20 (gw 192.168.96.1)
voicetrans_voicetrans_app: 172.20.0.0/16 (gw 172.20.0.1)
Î¸74Â° [ubuntu@mgc-dev2-3090:~/cuong_dn/robot-lesson-workflow/utils/UI] manual-refactor-agent-registry(+9/-4)+* Â± 
```
### IP Range Analysis

Tá»« `ip route` output, cÃ¡c dáº£i IP Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng:

**172.x.x.x networks:**

- 172.17.0.0/16 (docker0 - default bridge)
- 172.18.0.0/16 Ä‘áº¿n 172.31.0.0/16 (14 networks)

**192.168.x.x networks:**

- 192.168.0.0/20 Ä‘áº¿n 192.168.240.0/20 (16 networks)

**170.x.x.x networks:**

- 170.26.0.0/24, 170.28.0.0/24

**Tá»•ng cá»™ng: 32 active networks** sá»­ dá»¥ng háº§u háº¿t cÃ¡c dáº£i IP máº·c Ä‘á»‹nh cá»§a Docker.

## 3. Giáº£i phÃ¡p Ä‘Æ°á»£c Ã¡p dá»¥ng

### BÆ°á»›c 1: Cleanup cÆ¡ báº£n

```bash
# Thá»­ dá»n dáº¹p networks khÃ´ng sá»­ dá»¥ng
docker network prune -f
# Káº¿t quáº£: KhÃ´ng cÃ³ network nÃ o bá»‹ xÃ³a (táº¥t cáº£ Ä‘á»u Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng)
```

### BÆ°á»›c 2: Chá»‰nh sá»­a Network Configuration

#### Docker Compose Configuration má»›i:

```yaml
version: '3.8'

services:
  intent-api:
    build: .
    container_name: intent-classification-api
    ports:
      - "20012:20012"
    env_file:
      - .env
    volumes:
      # Model persistence
      - ./src/exported_models:/app/src/exported_models
      - ./src/trained_models:/app/src/trained_models
      # Response files
      - ./src/intent_reponse.json:/app/src/intent_reponse.json
      - ./src/intent_reponse_v2.json:/app/src/intent_reponse_v2.json
      - ./src/fixed_response.json:/app/src/fixed_response.json
      # Logs
      - ./logs:/app/src/logs
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:20012/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    deploy:
      resources:
        limits:
          memory: 4G
        reservations:
          memory: 2G
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    runtime: nvidia
    networks:
      - intent-network

networks:
  intent-network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 10.10.0.0/24
          gateway: 10.10.0.1
```

#### CÃ¡c dáº£i nÃ o cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng 

- Dáº£i:Â `10.10.0.0/24`Â â†’ IP usable:Â `10.10.0.1`Â â†’Â `10.10.0.254`
- Gateway (cá»•ng ra máº¡ng) pháº£i lÃ  má»™t Ä‘á»‹a chá»‰ IP há»£p lá»‡Â **trong khoáº£ng 10.10.0.1 Ä‘áº¿n 10.10.0.254** 
- BÃ¬nh thÆ°á»ng ngÆ°á»i ta hay chá»n .1 vÃ¬ tiá»‡n nhá»› (10.10.0.1), 
- Gateway khÃ´ng Ä‘Æ°á»£c lÃ Â `10.10.0.0`Â (network), khÃ´ng Ä‘Æ°á»£c lÃ Â `10.10.0.255`Â (broadcast) vÃ  miá»…n khÃ´ng trÃ¹ng vá»›i cÃ¡c container khÃ¡c. 
https://docs.docker.com/reference/compose-file/networks/
https://www.warp.dev/terminus/docker-compose-networks

---
# soáº¹t 24 

```
networks:
  name-network:               # tÃªn máº¡ng báº¡n táº¡o
    driver: bridge              # kiá»ƒu máº¡ng: bridge (máº·c Ä‘á»‹nh cá»§a Docker)
    ipam:                       # IP Address Management - quáº£n lÃ½ dáº£i IP
      driver: default
      config:
        - subnet: 10.200.0.0/24 # dáº£i máº¡ng (CIDR) dÃ¹ng cho network nÃ y
          gateway: 10.200.0.1   # Ä‘á»‹a chá»‰ gateway (cá»•ng máº·c Ä‘á»‹nh) cá»§a network
```

```
networks:
  name-network:               # tÃªn máº¡ng báº¡n táº¡o
    driver: bridge              # kiá»ƒu máº¡ng: bridge (máº·c Ä‘á»‹nh cá»§a Docker)
    ipam:                       # IP Address Management - quáº£n lÃ½ dáº£i IP
      driver: default
      config:
        - subnet: 10.3.0.0/24 # dáº£i máº¡ng (CIDR) dÃ¹ng cho network nÃ y
          gateway: 10.3.0.1   # Ä‘á»‹a chá»‰ gateway (cá»•ng máº·c Ä‘á»‹nh) cá»§a network
```

- Báº¡n Ä‘ang táº¡o má»™t máº¡ng Docker tÃªn **`intent-network`**.
    
- Máº¡ng nÃ y cÃ³ dáº£i IP riÃªng: `10.200.0.0/24`.
    
- Docker sáº½ cáº¥p phÃ¡t IP cho container trong dáº£i nÃ y (vÃ­ dá»¥ `10.200.0.2`, `10.200.0.3`â€¦).
    
- Gateway (`10.200.0.1`) lÃ  â€œcáº§u ná»‘iâ€ Ä‘á»ƒ container Ä‘i ra internet hoáº·c giao tiáº¿p vá»›i host.

---

`/24` (soáº¹t 24) lÃ  cÃ¡ch viáº¿t táº¯t trong **CIDR notation** (Classless Inter-Domain Routing) Ä‘á»ƒ chá»‰ Ä‘á»™ dÃ i **subnet mask**.

- `/24` nghÄ©a lÃ  **24 bit Ä‘áº§u tiÃªn** cá»§a Ä‘á»‹a chá»‰ IP dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh **network**, cÃ²n láº¡i **8 bit cuá»‘i** Ä‘á»ƒ Ä‘Ã¡nh sá»‘ host.
    
- Subnet mask tÆ°Æ¡ng á»©ng lÃ  **255.255.255.0**.
    
- NhÆ° váº­y, má»™t máº¡ng `/24` cÃ³ thá»ƒ chá»©a tá»‘i Ä‘a **256 Ä‘á»‹a chá»‰ IP** (tá»« `.0` Ä‘áº¿n `.255`), trong Ä‘Ã³:
    
    - `.0` lÃ  Ä‘á»‹a chá»‰ network,
        
    - `.255` lÃ  Ä‘á»‹a chá»‰ broadcast,
        
    - cÃ²n láº¡i ~254 Ä‘á»‹a chá»‰ dÃ nh cho host/container.
        

VÃ­ dá»¥:

- `10.200.0.0/24` â†’ dáº£i IP kháº£ dá»¥ng: `10.200.0.1` Ä‘áº¿n `10.200.0.254`.
    
- `192.168.1.0/24` â†’ dáº£i IP kháº£ dá»¥ng: `192.168.1.1` Ä‘áº¿n `192.168.1.254`.
    

ğŸ‘‰ Náº¿u báº¡n Ä‘á»ƒ `/16` thÃ¬ sáº½ cÃ³ 65,534 IP kháº£ dá»¥ng (quÃ¡ rá»™ng, dá»… xung Ä‘á»™t).  
ğŸ‘‰ Vá»›i Docker, thÆ°á»ng dÃ¹ng `/24` Ä‘á»ƒ Ä‘á»§ chá»— cho vÃ i container nhÆ°ng khÃ´ng chiáº¿m nhiá»u dáº£i IP.


---
# 4. ChÃº Ã½ váº¥n Ä‘á»: chá»“ng láº¥n subnet  


KhÃ´ng Ä‘Æ°á»£c. Náº¿u hai file Docker Compose khai bÃ¡o hai network vá»›i **cÃ¹ng má»™t subnet**, dÃ¹ gateway khÃ¡c, thÃ¬ Docker váº«n bÃ¡o lá»—i "Pool overlaps with other one on this address space" vÃ  khÃ´ng cho phÃ©p táº¡o.[docker+2](https://docs.docker.com/reference/cli/docker/network/create/)

## Giáº£i thÃ­ch

- Docker yÃªu cáº§u cÃ¡c network khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¡c subnet bá»‹ trÃ¹ng hoáº·c chá»“ng láº¥n nhauâ€”even náº¿u gateway khÃ¡c, subnet váº«n lÃ  pháº¡m vi Ä‘á»‹a chá»‰ IP nÃªn sáº½ bá»‹ lá»—i overlap.[thorsell+1](https://thorsell.io/2024/02/05/docker-network.html)
    
- Gateway chá»‰ lÃ  Ä‘á»‹a chá»‰ máº·c Ä‘á»‹nh routing trong subnet, nhÆ°ng subnet thÃ¬ Ä‘áº¡i diá»‡n cho toÃ n bá»™ dáº£i Ä‘á»‹a chá»‰ mÃ  network quáº£n lÃ½. Viá»‡c trÃ¹ng subnet sáº½ dáº«n tá»›i xung Ä‘á»™t NAT/routing, nÃªn gateway khÃ¡c cÅ©ng khÃ´ng Ä‘Æ°á»£c phÃ©p.[stackoverflow+2](https://stackoverflow.com/questions/67674332/docker-network-bridge-overlapping-with-ip-addressing-used-for-the-vpn-clients-on)

- Náº¿u muá»‘n cÃ³ hai network riÃªng biá»‡t, pháº£i dÃ¹ng hai subnet khÃ¡c nhau, vÃ­ dá»¥:
    
    - Network A: `10.10.0.0/24`
        
    - Network B: `10.20.0.0/24`
        
- Gateway cÃ³ thá»ƒ Ä‘áº·t tÃ¹y Ã½ trong má»—i subnet (nhÆ°ng khÃ´ng Ä‘Æ°á»£c trÃ¹ng subnet).
    

Docker sáº½ chá»‰ cho phÃ©p táº¡o nhiá»u network náº¿u subnet hoÃ n toÃ n khÃ´ng chá»“ng láº¥n nhau, gateway khÃ´ng áº£nh hÆ°á»Ÿng tá»›i Ä‘iá»u kiá»‡n nÃ y.[docker+2](https://docs.docker.com/reference/cli/docker/network/create/)

1. [https://docs.docker.com/reference/cli/docker/network/create/](https://docs.docker.com/reference/cli/docker/network/create/)
2. [https://thorsell.io/2024/02/05/docker-network.html](https://thorsell.io/2024/02/05/docker-network.html)
3. [https://stackoverflow.com/questions/67674332/docker-network-bridge-overlapping-with-ip-addressing-used-for-the-vpn-clients-on](https://stackoverflow.com/questions/67674332/docker-network-bridge-overlapping-with-ip-addressing-used-for-the-vpn-clients-on)
4. [https://forums.docker.com/t/docker-compose-multiple-networks/128718](https://forums.docker.com/t/docker-compose-multiple-networks/128718)
5. [https://stackoverflow.com/questions/38088279/communication-between-multiple-docker-compose-projects](https://stackoverflow.com/questions/38088279/communication-between-multiple-docker-compose-projects)
6. [https://www.reddit.com/r/docker/comments/ldkmry/how_to_run_two_docker_hosts_with_macvlan_on_the/](https://www.reddit.com/r/docker/comments/ldkmry/how_to_run_two_docker_hosts_with_macvlan_on_the/)
7. [https://docs.docker.com/compose/how-tos/networking/](https://docs.docker.com/compose/how-tos/networking/)
8. [https://www.netmaker.io/resources/docker-compose-network](https://www.netmaker.io/resources/docker-compose-network)
9. [https://github.com/moby/moby/issues/20179](https://github.com/moby/moby/issues/20179)
10. [https://docs.docker.com/engine/network/](https://docs.docker.com/engine/network/)
11. [https://github.com/moby/moby/issues/26912](https://github.com/moby/moby/issues/26912)
12. [https://forums.docker.com/t/network-with-255-255-255-255-as-subnet/79321](https://forums.docker.com/t/network-with-255-255-255-255-as-subnet/79321)
13. [https://stackoverflow.com/questions/50514275/docker-bridge-conflicts-with-host-network](https://stackoverflow.com/questions/50514275/docker-bridge-conflicts-with-host-network)
14. [https://philippmundhenk.github.io/Docker_IP_addresses/](https://philippmundhenk.github.io/Docker_IP_addresses/)


# 5. Summay PhÃ¢n biá»‡t 2 loáº¡i lá»—i trÃªn 

| Loáº¡i lá»—i                 | ThÃ´ng bÃ¡o lá»—i                                                                                              | NguyÃªn nhÃ¢n                                                         | VÃ­ dá»¥ subnet                                                             | Giáº£i phÃ¡p                                                                                                                                                                                                                                                                                                                              |
| ------------------------ | ---------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Háº¿t dáº£i network kháº£ dá»¥ng | could not find an available, non-overlapping IPv4 address pool among the defaults to assign to the network | Docker Ä‘Ã£ dÃ¹ng háº¿t dáº£i IP máº·c Ä‘á»‹nh hoáº·c cÃ¡c subnet khÃ´ng cÃ²n Ä‘á»§ nhá» | CÃ³ nhiá»u máº¡ng/16chiáº¿m gáº§n háº¿t 172.x.x.x, 192.168.x.x máº·c Ä‘á»‹nh            | - DÃ¹ng má»™t subnet hoÃ n toÃ n má»›i ngoÃ i vÃ¹ng Ä‘Ã£ bá»‹ Docker chiáº¿m háº¿t (vÃ­ dá»¥ dÃ¹ng dáº£i10.x.x.x/24thay vÃ¬ cÃ¡c dáº£i máº·c Ä‘á»‹nh) - XÃ³a bá»›t cÃ¡c network khÃ´ng sá»­ dá»¥ng (docker network prunehoáº·cdocker network rm <network_name>) - Má»Ÿ rá»™ng/add thÃªm pools kháº£ dá»¥ng trong/etc/docker/daemon.jsonvá»›idefault-address-pools, rá»“i restart Docker daemon |
| Chá»“ng láº¥n (overlap)      | Pool overlaps with other one on this address space                                                         | Hai network dÃ¹ng cÃ¹ng hoáº·c chá»“ng láº¥n subnet, dÃ¹ gateway khÃ¡c nhau   | A:10.10.0.0/24 B:10.10.0.0/24 Hoáº·c: A:10.10.0.0/16, B:10.10.1.0/24       | - Äá»•i sang subnet/dáº£i IP chÆ°a bá»‹ trÃ¹ng hoáº·c chá»“ng vá»›i network nÃ o khÃ¡c - Kiá»ƒm tra subnet cÃ¡c network hiá»‡n cÃ³ trÆ°á»›c khi khai bÃ¡o má»›i báº±ngdocker network ls,docker network inspect - XÃ³a cÃ¡c network khÃ´ng cÃ²n cáº§n dÃ¹ng náº¿u bá»‹ trÃ¹ng                                                                                                     |

# 6. Check dáº£i network

```bash
docker network ls -q | xargs -n1 docker network inspect \ --format '{{.Name}}: {{range .IPAM.Config}}{{.Subnet}}{{end}}'
```

```
docker network ls -q | xargs -n1 docker network inspect \ --format '{{.Name}}: {{range .IPAM.Config}}{{.Subnet}}{{end}}'
```


```
#!/bin/bash

echo "=== Kiá»ƒm tra cÃ¡c dáº£i IP Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi Docker networks ==="
echo ""

# Láº¥y táº¥t cáº£ cÃ¡c subnet Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng
echo "ğŸ“Š Danh sÃ¡ch cÃ¡c subnet Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng:"
for net in $(docker network ls -q); do 
  docker network inspect $net 2>/dev/null | grep -oP '"Subnet":\s*"\K[^"]+' || true
done | sort -V | uniq

echo ""
echo "=== TÃ¬m dáº£i máº¡ng cÃ²n trá»‘ng ==="

# Kiá»ƒm tra cÃ¡c dáº£i máº¡ng phá»• biáº¿n
check_range() {
  local range=$1
  local name=$2
  if for net in $(docker network ls -q); do docker network inspect $net 2>/dev/null | grep -q "\"Subnet\": \"$range"; done 2>/dev/null; then
    echo "âŒ $name ($range) - ÄANG Sá»¬ Dá»¤NG"
    return 1
  else
    echo "âœ… $name ($range) - CÃ“ THá»‚ DÃ™NG"
    return 0
  fi
}

echo ""
echo "ğŸ” Kiá»ƒm tra cÃ¡c dáº£i máº¡ng phá»• biáº¿n:"
AVAILABLE_RANGES=()

# Kiá»ƒm tra dáº£i 172.32-172.50
for i in {32..50}; do
  if check_range "172.$i.0.0/16" "Docker network $i"; then
    AVAILABLE_RANGES+=("172.$i.0.0/16")
  fi
done

# Kiá»ƒm tra dáº£i 10.250-10.255
for i in {250..255}; do
  if check_range "10.$i.0.0/24" "10.$i.0.0/24"; then
    AVAILABLE_RANGES+=("10.$i.0.0/24")
  fi
done

# Kiá»ƒm tra dáº£i 192.168.200-192.168.255
for i in {200..255}; do
  if check_range "192.168.$i.0/24" "192.168.$i.0/24"; then
    AVAILABLE_RANGES+=("192.168.$i.0/24")
    break  # Chá»‰ cáº§n 1 dáº£i lÃ  Ä‘á»§
  fi
done

echo ""
echo "=== Gá»£i Ã½ dáº£i máº¡ng cÃ²n trá»‘ng ==="
if [ ${#AVAILABLE_RANGES[@]} -gt 0 ]; then
  echo "ğŸ’¡ CÃ¡c dáº£i cÃ³ thá»ƒ sá»­ dá»¥ng:"
  for range in "${AVAILABLE_RANGES[@]}"; do
    echo "   âœ… $range"
  done
  echo ""
  echo "ğŸ’¡ Khuyáº¿n nghá»‹ sá»­ dá»¥ng: ${AVAILABLE_RANGES[0]}"
else
  echo "âš ï¸  KhÃ´ng tÃ¬m tháº¥y dáº£i máº¡ng tá»± Ä‘á»™ng. Vui lÃ²ng chá»‰ Ä‘á»‹nh subnet thá»§ cÃ´ng trong docker-compose.yml"
fi

```

Output 

```
=== Kiá»ƒm tra cÃ¡c dáº£i IP Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi Docker networks ===

ğŸ“Š Danh sÃ¡ch cÃ¡c subnet Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng:
10.0.0.0/24
10.2.0.0/24
10.3.0.0/24
10.6.0.0/24
10.10.0.0/24
10.11.0.0/24
10.20.0.0/24
10.30.0.0/24
10.99.0.0/16
10.200.0.0/24
10.200.10.0/24
111.71.200.0/24
170.26.0.0/24
170.28.0.0/24
170.129.1.4/24
170.169.0.0/24
172.17.0.0/16
172.18.0.0/16
172.19.0.0/16
172.20.0.0/16
172.21.0.0/16
172.22.0.0/16
172.23.0.0/16
172.24.0.0/16
172.25.0.0/16
172.26.0.0/16
172.27.0.0/16
172.28.0.0/16
172.29.0.0/16
172.30.0.0/16
172.31.0.0/16
172.100.0.40/16
192.168.0.0/20
192.168.16.0/20
192.168.32.0/20
192.168.48.0/20
192.168.64.0/20
192.168.80.0/20
192.168.96.0/20
192.168.112.0/20
192.168.128.0/20
192.168.144.0/20
192.168.160.0/20
192.168.176.0/20
192.168.192.0/20
192.168.208.0/20
192.168.224.0/20
192.168.240.0/20

=== TÃ¬m dáº£i máº¡ng cÃ²n trá»‘ng ===

ğŸ” Kiá»ƒm tra cÃ¡c dáº£i máº¡ng phá»• biáº¿n:
âœ… Docker network 32 (172.32.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 33 (172.33.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 34 (172.34.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 35 (172.35.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 36 (172.36.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 37 (172.37.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 38 (172.38.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 39 (172.39.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 40 (172.40.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 41 (172.41.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 42 (172.42.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 43 (172.43.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 44 (172.44.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 45 (172.45.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 46 (172.46.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 47 (172.47.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 48 (172.48.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 49 (172.49.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… Docker network 50 (172.50.0.0/16) - CÃ“ THá»‚ DÃ™NG
âœ… 10.250.0.0/24 (10.250.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 10.251.0.0/24 (10.251.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 10.252.0.0/24 (10.252.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 10.253.0.0/24 (10.253.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 10.254.0.0/24 (10.254.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 10.255.0.0/24 (10.255.0.0/24) - CÃ“ THá»‚ DÃ™NG
âœ… 192.168.200.0/24 (192.168.200.0/24) - CÃ“ THá»‚ DÃ™NG

=== Gá»£i Ã½ dáº£i máº¡ng cÃ²n trá»‘ng ===
ğŸ’¡ CÃ¡c dáº£i cÃ³ thá»ƒ sá»­ dá»¥ng:
   âœ… 172.32.0.0/16
   âœ… 172.33.0.0/16
   âœ… 172.34.0.0/16
   âœ… 172.35.0.0/16
   âœ… 172.36.0.0/16
   âœ… 172.37.0.0/16
   âœ… 172.38.0.0/16
   âœ… 172.39.0.0/16
   âœ… 172.40.0.0/16
   âœ… 172.41.0.0/16
   âœ… 172.42.0.0/16
   âœ… 172.43.0.0/16
   âœ… 172.44.0.0/16
   âœ… 172.45.0.0/16
   âœ… 172.46.0.0/16
   âœ… 172.47.0.0/16
   âœ… 172.48.0.0/16
   âœ… 172.49.0.0/16
   âœ… 172.50.0.0/16
   âœ… 10.250.0.0/24
   âœ… 10.251.0.0/24
   âœ… 10.252.0.0/24
   âœ… 10.253.0.0/24
   âœ… 10.254.0.0/24
   âœ… 10.255.0.0/24
   âœ… 192.168.200.0/24

ğŸ’¡ Khuyáº¿n nghá»‹ sá»­ dá»¥ng: 172.32.0.0/16
```



---

# Váº¥n Ä‘á»: 2 docker compose á»Ÿ 2 network khÃ¡c nhau ? 


```
# Project name riÃªng cho API service
name: context-handling-service

services:
  api:
    build:
      context: .
      dockerfile: ./Dockerfile
    container_name: context_handling_api
    restart: unless-stopped
    env_file:
      - .env
    environment:
      LOGGING_LEVEL: INFO
      ENVIRONMENT: production
      HOST: 0.0.0.0
    ports:
      - "${PORT-30020}:30020"
    networks:
      - context_handling_network

networks:
  context_handling_network:             # tÃªn máº¡ng báº¡n táº¡o
    driver: bridge              # kiá»ƒu máº¡ng: bridge (máº·c Ä‘á»‹nh cá»§a Docker)
    ipam:                       # IP Address Management - quáº£n lÃ½ dáº£i IP
      driver: default
      config:
        - subnet: 10.3.0.0/24 # dáº£i máº¡ng (CIDR) dÃ¹ng cho network nÃ y
          gateway: 10.3.0.1   # Ä‘á»‹a chá»‰ gateway (cá»•ng máº·c Ä‘á»‹nh) cá»§a network
```


```
name: context-handling-worker

services:
  worker:
    build:
      context: .
      dockerfile: ./Dockerfile.worker
    image: v1-context-handling-worker:latest
    container_name: context-handling-worker
    restart: unless-stopped
    env_file:
      - .env
    networks:
      - context_handling_network
    environment:
      LOGGING_LEVEL: INFO
    deploy:
      replicas: 1

networks:
  context_handling_network:
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 10.6.0.0/24
          gateway: 10.6.0.1
```

---
### Thá»±c Tráº¡ng Network

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  Network 1: context-handling-service_context_handling_network   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Subnet: 10.3.0.0/24                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚    â”‚
â”‚  â”‚  â”‚ API             â”‚                                    â”‚    â”‚
â”‚  â”‚  â”‚ IP: 10.3.0.2    â”‚                                    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  Network 2: context-handling-worker_context_handling_network    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Subnet: 10.6.0.0/24                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚    â”‚
â”‚  â”‚  â”‚ Worker          â”‚                                    â”‚    â”‚
â”‚  â”‚  â”‚ IP: 10.6.0.2    â”‚                                    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  âŒ 2 networks ISOLATED - khÃ´ng thá»ƒ ping/curl trá»±c tiáº¿p        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Táº¡i Sao Váº«n "Hoáº¡t Äá»™ng"?

Tá»« code grep, tÃ´i tháº¥y **API vÃ  Worker KHÃ”NG gá»i trá»±c tiáº¿p nhau**. ChÃºng giao tiáº¿p qua **shared services**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   API   â”‚                              â”‚  Worker  â”‚          â”‚
â”‚  â”‚ 10.3.x  â”‚                              â”‚  10.6.x  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚                                        â”‚                â”‚
â”‚       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                â”‚
â”‚       â””â”€â”€â”€â–ºâ”‚  External Services (Host)    â”‚â—„â”€â”€â”€â”˜                â”‚
â”‚            â”‚                              â”‚                     â”‚
â”‚            â”‚  â€¢ RabbitMQ (message queue)  â”‚                     â”‚
â”‚            â”‚  â€¢ PostgreSQL (database)     â”‚                     â”‚
â”‚            â”‚  â€¢ Redis (cache)             â”‚                     â”‚
â”‚            â”‚  â€¢ Memory API (103.253.20.30:6699)                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                 â”‚
â”‚  âœ… Giao tiáº¿p GIÃN TIáº¾P qua shared services                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# MECE vá» network ? 

Äá»ƒ Ä‘áº£m báº£o tÃ­nhÂ **MECE**Â (Mutually Exclusive - KhÃ´ng trÃ¹ng láº·p, Collectively Exhaustive - KhÃ´ng bá» sÃ³t) cho cÃ¡c phÆ°Æ¡ng phÃ¡p triá»ƒn khai Network trong Docker Compose, tÃ´i sáº½ phÃ¢n tÃ¡ch váº¥n Ä‘á» theoÂ **3 Chiá»u (Dimensions)**Â chÃ­nh.

---

## Chiá»u 1: PhÃ¢n loáº¡i theo Quyá»n Quáº£n LÃ½ & VÃ²ng Äá»i (Lifecycle & Ownership)

_CÃ¢u há»i cá»‘t lÃµi: Ai lÃ  ngÆ°á»i táº¡o ra vÃ  kiá»ƒm soÃ¡t network nÃ y?_

## 1. Implicit Management (Máº·c Ä‘á»‹nh)

- **MÃ´ táº£:**Â Báº¡n khÃ´ng khai bÃ¡o gÃ¬ cáº£. Docker Compose tá»± Ä‘á»™ng táº¡o má»™t networkÂ `default`Â (driver: bridge) khi cháº¡yÂ `up`Â vÃ  xÃ³a khiÂ `down`.
    
- **Äáº·c Ä‘iá»ƒm:**Â TÃªn network thÆ°á»ng lÃ Â `<project_name>_default`.
    
- **Use case:**Â Hello World, Quick POC, Scripts Ä‘Æ¡n giáº£n.
    

## 2. Explicit Management (Khai bÃ¡o TÆ°á»ng minh)

- **MÃ´ táº£:**Â Báº¡n Ä‘á»‹nh nghÄ©a rÃµ blockÂ `networks:`Â trong file YAML nhÆ°ng khÃ´ng dÃ¹ngÂ `external: true`. Compose váº«n quáº£n lÃ½ vÃ²ng Ä‘á»i (táº¡o/xÃ³a), nhÆ°ng báº¡n kiá»ƒm soÃ¡t thÃ´ng sá»‘ (subnet, driver).
    
- **Äáº·c Ä‘iá»ƒm:**Â Isolated, Custom Driver, Custom Config.
    
- **Use case:**Â Production Standard (nhÆ° mÃ´ hÃ¬nh Hybrid Ä‘Ã£ bÃ n), CÃ´ láº­p Database, chia Tier (Frontend/Backend).
    

## 3. External Management (Khai bÃ¡o NgoÃ i)

- **MÃ´ táº£:**Â Network Ä‘Ã£ tá»“n táº¡i trÆ°á»›c khi cháº¡y Compose (`docker network create`). Báº¡n dÃ¹ngÂ `external: true`.
    
- **Äáº·c Ä‘iá»ƒm:**Â Compose chá»‰ "join" vÃ o, khÃ´ng cÃ³ quyá»n xÃ³a hay sá»­a config cá»§a network.
    
- **Use case:**Â Chia sáº» giá»¯a nhiá»u project (Microservices), káº¿t ná»‘i vá»›i Reverse Proxy (Traefik/Nginx), Shared Infrastructure.
    

---

## Chiá»u 2: PhÃ¢n loáº¡i theo CÆ¡ cháº¿ Váº­n chuyá»ƒn (Driver Technology)

_CÃ¢u há»i cá»‘t lÃµi: GÃ³i tin (Packet) di chuyá»ƒn nhÆ° tháº¿ nÃ o?_

## 1. Bridge (Cáº§u ná»‘i - Standard)

- **CÆ¡ cháº¿:**Â Táº¡o má»™t switch áº£o (software bridge) trÃªn host. Container cÃ³ IP riÃªng trong subnet áº£o, giao tiáº¿p ra ngoÃ i qua NAT.
    
- **CÃ¡ch dÃ¹ng:**Â `driver: bridge`.
    
- **Æ¯u Ä‘iá»ƒm:**Â CÃ´ láº­p tá»‘t (Isolation), Port mapping linh hoáº¡t.
    
- **NhÆ°á»£c Ä‘iá»ƒm:**Â Tá»‘n má»™t chÃºt overhead do NAT.
    
- **Best Practice:**Â Máº·c Ä‘á»‹nh cho háº§u háº¿t cÃ¡c Web App, DB.
    

## 2. Host (Cháº¡y tráº§n - Performance)

- **CÆ¡ cháº¿:**Â Loáº¡i bá» lá»›p network isolation. Container dÃ¹ng chung IP vÃ  Port vá»›i mÃ¡y Host.
    
- **CÃ¡ch dÃ¹ng:**Â `driver: host`Â hoáº·cÂ `network_mode: host`.
    
- **Æ¯u Ä‘iá»ƒm:**Â Hiá»‡u nÄƒng cao nháº¥t (Zero latency), khÃ´ng cáº§n NAT.
    
- **NhÆ°á»£c Ä‘iá»ƒm:**Â Rá»§i ro báº£o máº­t (Container chiáº¿m quyá»n port host), xung Ä‘á»™t port náº¿u cháº¡y nhiá»u replica.
    
- **Best Practice:**Â **AI Training/Inference**Â (Ä‘á»ƒ tá»‘i Æ°u I/O vá»›i GPU), cÃ¡c á»©ng dá»¥ng cáº§n xá»­ lÃ½ lÆ°á»£ng packet cá»±c lá»›n.
    

## 3. None (KhÃ´ng máº¡ng - Security)

- **CÆ¡ cháº¿:**Â Container cÃ³ stack network loopback (localhost) nhÆ°ng khÃ´ng cÃ³ card máº¡ng ra ngoÃ i.
    
- **CÃ¡ch dÃ¹ng:**Â `driver: none`Â hoáº·cÂ `network_mode: none`.
    
- **Æ¯u Ä‘iá»ƒm:**Â Báº£o máº­t tuyá»‡t Ä‘á»‘i (Air-gapped).
    
- **Best Practice:**Â CÃ¡c job xá»­ lÃ½ dá»¯ liá»‡u nháº¡y cáº£m (Private Key generation), Batch job tÃ­nh toÃ¡n thuáº§n tÃºy khÃ´ng cáº§n internet.
    

## 4. Service / Container (Sidecar Pattern)

- **CÆ¡ cháº¿:**Â Má»™t container dÃ¹ng chung namespace network cá»§a má»™t container khÃ¡c.
    
- **CÃ¡ch dÃ¹ng:**Â `network_mode: service:<tÃªn_service>`.
    
- **Æ¯u Ä‘iá»ƒm:**Â 2 container giao tiáº¿p quaÂ `localhost`.
    
- **Best Practice:**Â Monitoring Agent (Datadog), Log collector, hoáº·c Debugging tool gáº¯n vÃ o service chÃ­nh.
    

## 5. Macvlan / IPvlan (Direct Hardware - Legacy/Specialized)

- **CÆ¡ cháº¿:**Â Cáº¥p cho container má»™t MAC address váº­t lÃ½ riÃªng, container xuáº¥t hiá»‡n nhÆ° má»™t thiáº¿t bá»‹ váº­t lÃ½ trÃªn máº¡ng LAN cá»§a cty.
    
- **CÃ¡ch dÃ¹ng:**Â `driver: macvlan`.
    
- **Best Practice:**Â á»¨ng dá»¥ng Legacy cáº§n IP tÄ©nh tháº­t, Monitor máº¡ng cáº¥p tháº¥p, tÃ­ch há»£p vÃ o háº¡ táº§ng máº¡ng doanh nghiá»‡p (VPN, VLAN).
    

---

## Chiá»u 3: PhÃ¢n loáº¡i theo Cáº¥u trÃºc Äá»‹nh danh & Káº¿t ná»‘i (Configuration)

_CÃ¢u há»i cá»‘t lÃµi: CÃ¡c service tÃ¬m tháº¥y nhau nhÆ° tháº¿ nÃ o?_

## 1. Dynamic IP (DNS Discovery)

- **CÃ¡ch triá»ƒn khai:**Â Máº·c Ä‘á»‹nh. Docker cung cáº¥p DNS Server ná»™i bá»™. Gá»i nhau báº±ng tÃªn service (`db`,Â `redis`).
    
- **TÃ­nh cháº¥t:**Â IP thay Ä‘á»•i má»—i láº§n restart.
    
- **ÄÃ¡nh giÃ¡:**Â Chuáº©n má»±c cho Cloud Native.
    

## 2. Static IP (Cá»‘ Ä‘á»‹nh - Anti-pattern in Cloud)

- **CÃ¡ch triá»ƒn khai:**Â Khai bÃ¡oÂ `ipv4_address: 172.16.238.10`Â trong service config.
    
- **TÃ­nh cháº¥t:**Â Hard-code Ä‘á»‹a chá»‰ IP.
    
- **ÄÃ¡nh giÃ¡:**Â NÃªn trÃ¡nh. Chá»‰ dÃ¹ng khi tÃ­ch há»£p vá»›i cÃ¡c há»‡ thá»‘ng Legacy ngu ngá»‘c khÃ´ng há»— trá»£ DNS.
    

## 3. Aliases (Biá»‡t danh)

- **CÃ¡ch triá»ƒn khai:**Â `aliases: ["database-primary", "db-prod"]`.
    
- **TÃ­nh cháº¥t:**Â Má»™t service cÃ³ nhiá»u tÃªn miá»n ná»™i bá»™.
    
- **ÄÃ¡nh giÃ¡:**Â Há»¯u Ã­ch khi migration hoáº·c A/B testing (chuyá»ƒn hÆ°á»›ng traffic mÃ  khÃ´ng Ä‘á»•i code app).


---

```
docker network ls && docker network inspect $(docker network ls -q) --format '{{.Name}}: {{range .IPAM.Config}}{{.Subnet}}{{end}}'
```