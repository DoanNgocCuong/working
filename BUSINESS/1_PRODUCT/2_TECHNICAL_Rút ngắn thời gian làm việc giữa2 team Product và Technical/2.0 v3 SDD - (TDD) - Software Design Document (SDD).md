```
deep research vá» template chuáº©n cá»§a 1 SDD
```

## TÃªn gá»i phá»• biáº¿n nháº¥t: **Software Design Document (SDD)**


# Step 1: Deep research vá» template chuáº©n cá»§a SDD (Manu + Gemini + Perflexity - cÃ³ thá»ƒ Ä‘em báº£n TDD Ä‘á»ƒ so sÃ¡nh)

**Software Design Document (SDD)** lÃ  tÃªn chuáº©n vÃ  phá»• biáº¿n nháº¥t cho tÃ i liá»‡u "tá»« tá»•ng quan Ä‘áº¿n chi tiáº¿t", Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong industry vÃ  Ä‘Æ°á»£c chuáº©n hÃ³a bá»Ÿi IEEE Std 1016-2009.[copilot4devops+3](https://copilot4devops.com/solid-software-design-document/)â€‹

## Táº¡i sao SDD lÃ  tÃªn Ä‘Ãºng cho full-stack design document

**Äá»‹nh nghÄ©a IEEE**: SDD Ä‘Æ°á»£c thiáº¿t káº¿ rÃµ rÃ ng Ä‘á»ƒ bao trÃ¹m cáº£ **preliminary design (HLD)** vÃ  **detailed design (LLD)** trong má»™t tÃ i liá»‡u duy nháº¥t, phá»¥c vá»¥ nhÆ° "blueprint chi tiáº¿t cho implementation" vÃ  "primary reference for code development".[wildart.github+2](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)â€‹

**Scope cá»§a SDD theo chuáº©n**:

- Stage 1: Overall system architecture + data architecture (HLD)
    
- Stage 2: Detailed data structures + algorithms for the chosen architecture (LLD)[engstandards.lanl+2](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)â€‹
    

**Thá»±c táº¿ sá»­ dá»¥ng**: CÃ¡c tá»• chá»©c lá»›n (IEEE, LANL, NASA) vÃ  nhiá»u template open-source Ä‘á»u dÃ¹ng tÃªn "SDD" cho tÃ i liá»‡u end-to-end design.[github+2](https://github.com/jam01/SDD-Template)â€‹

## So sÃ¡nh vá»›i "Software Architecture Document"

**Software Architecture Document (SAD)** thÆ°á»ng **chá»‰ táº­p trung vÃ o high-level architecture**, khÃ´ng bao gá»“m chi tiáº¿t implementation nhÆ° LLD.[wiki.sei.cmu+3](https://wiki.sei.cmu.edu/confluence/display/SAD/Software+Architecture+Documentation+Template?src=contextnavpagetreemode)â€‹

PhÃ¢n biá»‡t rÃµ:

- **Architecture** = high-level structure, components, relationships, patterns[lucidchart+2](https://www.lucidchart.com/blog/software-architecture-vs-design)â€‹
    
- **Design** = cáº£ architecture + detailed module design, algorithms, data structures[stackoverflow+2](https://stackoverflow.com/questions/704855/software-design-vs-software-architecture)â€‹
    

Náº¿u chá»‰ dÃ¹ng tÃªn "Architecture Document", ngÆ°á»i Ä‘á»c sáº½ **khÃ´ng expect** tÃ¬m tháº¥y LLD (class diagrams, pseudocode, detailed logic) trong Ä‘Ã³.[geeksforgeeks+1](https://www.geeksforgeeks.org/system-design/difference-between-software-design-and-software-architecture/)â€‹

## Template chuáº©n cho SDD

Theo IEEE Std 1016-2009, cáº¥u trÃºc SDD gá»“m:

## Core sections (báº¯t buá»™c)

1. **Introduction**: Purpose, scope, overview, definitions[github+2](https://github.com/jam01/SDD-Template)â€‹
    
2. **System Overview**: High-level description, context[wildart.github+1](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)â€‹
    
3. **System Architecture** (HLD):
    
    - Architectural design
        
    - Decomposition description (components, subsystems)
        
    - Design rationale[wvu+2](https://community.wvu.edu/~hhammar/CU/swarch/lecture%20slides/slides%203%20documenting%20sw%20arch/complete%20example%20on%20documenting%20sw%20arch/SAD-OnlineCateringService.doc)â€‹
        
4. **Data Design** (HLD + LLD):
    
    - Data description
        
    - Data dictionary (entities, attributes, types)[engstandards.lanl+1](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)â€‹
        
5. **Component Design** (LLD):
    
    - Detailed design cá»§a tá»«ng component
        
    - Algorithms, pseudocode
        
    - Class diagrams, method signatures[stackoverflow+2](https://stackoverflow.com/questions/10297869/design-documents-high-level-and-low-level-design-documents)â€‹
        
6. **Human Interface Design**: UI/UX mockups, screen flows[wildart.github+1](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)â€‹
    
7. **Requirements Matrix**: Traceability giá»¯a requirements vÃ  design entities[wvu+1](https://community.wvu.edu/~hhammar/CU/swarch/lecture%20slides/slides%203%20documenting%20sw%20arch/complete%20example%20on%20documenting%20sw%20arch/SAD-OnlineCateringService.doc)â€‹
    
8. **Appendices**: Diagrams, glossary[engstandards.lanl+1](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)â€‹
    

## Template examples cÃ³ sáºµn

**GitHub templates**:

- IEEE 1016-2009 compliant SDD template (Markdown): [github.com/jam01/SDD-Template](https://github.com/jam01/SDD-Template)[github](https://github.com/jam01/SDD-Template)â€‹
    
- Modern SDD template vá»›i detailed design sections: [gist.github.com/iamhenry](https://gist.github.com/iamhenry/2dbabd0d59051eae360d8cfa6a2782bd)[gist.github](https://gist.github.com/iamhenry/2dbabd0d59051eae360d8cfa6a2782bd)â€‹
    
- DID-compliant SDD vá»›i architecture diagrams: [github.com/VCTLabs](https://github.com/VCTLabs/software_design_description_template)[github](https://github.com/VCTLabs/software_design_description_template/blob/master/README.rst)â€‹
    

**IEEE official template** (PDF/Word):

- LANL Engineering Standards: [engstandards.lanl.gov/esm/software/SWDD-template.docx](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)[engstandards.lanl](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)â€‹
    
- IEEE 1016 full standard: IEEE Std 1016-1998/2009[bilkent+1](http://cs.bilkent.edu.tr/~cagatay/cs413/1016-1998_00741934.pdf)â€‹
    

## Káº¿t luáº­n & khuyáº¿n nghá»‹

```
**DÃ¹ng tÃªn**: **"Software Design Document (SDD)"** hoáº·c **"<System Name> â€“ Software Design Document"**

**LÃ½ do**:

- ÄÆ°á»£c chuáº©n hÃ³a bá»Ÿi IEEE, Ä‘Æ°á»£c industry hiá»ƒu rá»™ng rÃ£i[copilot4devops+2](https://copilot4devops.com/solid-software-design-document/)â€‹
    
- RÃµ rÃ ng bao gá»“m cáº£ HLD vÃ  LLD trong má»™t tÃ i liá»‡u[docuwriter+2](https://www.docuwriter.ai/posts/sdd-example-document)â€‹
    
- CÃ³ nhiá»u template máº«u, dá»… tÃ¬m reference[gist.github+2](https://gist.github.com/iamhenry/2dbabd0d59051eae360d8cfa6a2782bd)â€‹
    

**TrÃ¡nh dÃ¹ng**:

- "Software Architecture Document" náº¿u cÃ³ LLD (vÃ¬ architecture thÆ°á»ng chá»‰ cÃ³ HLD)[wiki.sei.cmu+1](https://wiki.sei.cmu.edu/confluence/display/SAD/Software+Architecture+Documentation+Template?src=contextnavpagetreemode)â€‹
    
- "End-to-End Software Design Document" (thá»«a tá»«, khÃ´ng phá»• biáº¿n)[zoolatech](https://zoolatech.com/blog/end-to-end-software-development/)â€‹
    
- "Software Architecture and Design Document" (dÃ i dÃ²ng, khÃ´ng chuáº©n)
    

**Náº¿u muá»‘n nháº¥n máº¡nh full-stack**, cÃ³ thá»ƒ thÃªm subtitle:

- "Software Design Document (High-Level & Low-Level Design)"
    
- hoáº·c trong pháº§n Purpose viáº¿t: "This SDD covers both architectural design (HLD) and detailed component design (LLD)..."[wildart.github+1](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)â€‹
    

1. [https://copilot4devops.com/solid-software-design-document/](https://copilot4devops.com/solid-software-design-document/)
2. [https://github.com/jam01/SDD-Template](https://github.com/jam01/SDD-Template)
3. [https://wildart.github.io/MISG5020/standards/SDD_Template.pdf](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)
4. [https://engstandards.lanl.gov/esm/software/SWDD-template.docx](https://engstandards.lanl.gov/esm/software/SWDD-template.docx)
5. [http://cs.bilkent.edu.tr/~cagatay/cs413/1016-1998_00741934.pdf](http://cs.bilkent.edu.tr/~cagatay/cs413/1016-1998_00741934.pdf)
6. [https://www.scribd.com/doc/242647886/Design-Specification-Doc-IEEE](https://www.scribd.com/doc/242647886/Design-Specification-Doc-IEEE)
7. [https://github.com/VCTLabs/software_design_description_template/blob/master/README.rst](https://github.com/VCTLabs/software_design_description_template/blob/master/README.rst)
8. [https://wiki.sei.cmu.edu/confluence/display/SAD/Software+Architecture+Documentation+Template?src=contextnavpagetreemode](https://wiki.sei.cmu.edu/confluence/display/SAD/Software+Architecture+Documentation+Template?src=contextnavpagetreemode)
9. [https://www.voa.va.gov/DocumentView.aspx?DocumentID=188](https://www.voa.va.gov/DocumentView.aspx?DocumentID=188)
10. [https://www.lucidchart.com/blog/software-architecture-vs-design](https://www.lucidchart.com/blog/software-architecture-vs-design)
11. [https://www.geeksforgeeks.org/system-design/difference-between-software-design-and-software-architecture/](https://www.geeksforgeeks.org/system-design/difference-between-software-design-and-software-architecture/)
12. [https://stackoverflow.com/questions/704855/software-design-vs-software-architecture](https://stackoverflow.com/questions/704855/software-design-vs-software-architecture)
13. [https://testrigor.com/blog/system-design-vs-software-architecture/](https://testrigor.com/blog/system-design-vs-software-architecture/)
14. [https://community.wvu.edu/~hhammar/CU/swarch/lecture%20slides/slides%203%20documenting%20sw%20arch/complete%20example%20on%20documenting%20sw%20arch/SAD-OnlineCateringService.doc](https://community.wvu.edu/~hhammar/CU/swarch/lecture%20slides/slides%203%20documenting%20sw%20arch/complete%20example%20on%20documenting%20sw%20arch/SAD-OnlineCateringService.doc)
15. [https://stackoverflow.com/questions/10297869/design-documents-high-level-and-low-level-design-documents](https://stackoverflow.com/questions/10297869/design-documents-high-level-and-low-level-design-documents)
16. [https://gist.github.com/iamhenry/2dbabd0d59051eae360d8cfa6a2782bd](https://gist.github.com/iamhenry/2dbabd0d59051eae360d8cfa6a2782bd)
17. [https://www.docuwriter.ai/posts/sdd-example-document](https://www.docuwriter.ai/posts/sdd-example-document)
18. [https://zoolatech.com/blog/end-to-end-software-development/](https://zoolatech.com/blog/end-to-end-software-development/)
19. [https://www.ecs.csun.edu/~rlingard/COMP684/Example2SoftArch.htm](https://www.ecs.csun.edu/~rlingard/COMP684/Example2SoftArch.htm)
20. [https://github.com/bflorat/architecture-document-template](https://github.com/bflorat/architecture-document-template)
21. [https://bit.ai/templates/software-design-document-template](https://bit.ai/templates/software-design-document-template)
22. [https://github.com/joelparkerhenderson/architecture-decision-record](https://github.com/joelparkerhenderson/architecture-decision-record)
23. [https://www.multiplayer.app/system-architecture/software-design-document-template/](https://www.multiplayer.app/system-architecture/software-design-document-template/)
24. [https://document360.com/blog/software-design-document/](https://document360.com/blog/software-design-document/)
25. [https://ccis.ksu.edu.sa/sites/ccis.ksu.edu.sa/files/attach/project_i-final-report-template.doc](https://ccis.ksu.edu.sa/sites/ccis.ksu.edu.sa/files/attach/project_i-final-report-template.doc)
26. [https://blog.cm-dm.com/public/Templates/system-architecture-template.doc](https://blog.cm-dm.com/public/Templates/system-architecture-template.doc)
27. [https://softwaredominos.com/home/software-design-development-articles/high-level-solution-design-documents-what-is-it-and-when-do-you-need-one/](https://softwaredominos.com/home/software-design-development-articles/high-level-solution-design-documents-what-is-it-and-when-do-you-need-one/)
28. [https://ccis.ksu.edu.sa/sites/ccis.ksu.edu.sa/files/attach/project_ii-final-report-template_0.doc](https://ccis.ksu.edu.sa/sites/ccis.ksu.edu.sa/files/attach/project_ii-final-report-template_0.doc)
29. [https://www.reddit.com/r/webdev/comments/wow2qr/good_examples_of_software_architecture/](https://www.reddit.com/r/webdev/comments/wow2qr/good_examples_of_software_architecture/)
30. [https://www.studocu.vn/vn/document/truong-dai-hoc-cong-nghiep-thanh-pho-ho-chi-minh/software-architecture/software-architecture-document-template/94501984](https://www.studocu.vn/vn/document/truong-dai-hoc-cong-nghiep-thanh-pho-ho-chi-minh/software-architecture/software-architecture-document-template/94501984)
31. [https://www.youtube.com/watch?v=AHbqU7GYhYA](https://www.youtube.com/watch?v=AHbqU7GYhYA)
32. [https://www.se.rit.edu/~co-operators/SoftwareArchitectureDocumentation.pdf](https://www.se.rit.edu/~co-operators/SoftwareArchitectureDocumentation.pdf)
33. [https://www.imaginarycloud.com/blog/software-architecture-vs-design](https://www.imaginarycloud.com/blog/software-architecture-vs-design)
34. [https://www.linkedin.com/pulse/low-level-design-document-structure-comprehensive-godhandaraman-kzvnc](https://www.linkedin.com/pulse/low-level-design-document-structure-comprehensive-godhandaraman-kzvnc)
35. [https://www.atlassian.com/work-management/knowledge-sharing/documentation/software-design-document](https://www.atlassian.com/work-management/knowledge-sharing/documentation/software-design-document)
36. [https://testrigor.com/blog/high-level-design-hld-vs-low-level-design-lld/](https://testrigor.com/blog/high-level-design-hld-vs-low-level-design-lld/)
37. [https://www.reddit.com/r/SoftwareEngineering/comments/106jk5k/what_is_the_difference_between_architecture/](https://www.reddit.com/r/SoftwareEngineering/comments/106jk5k/what_is_the_difference_between_architecture/)
38. [http://learnprogramingbyluckysir.blogspot.com/2015/11/how-to-write-effective-design-by-using.html](http://learnprogramingbyluckysir.blogspot.com/2015/11/how-to-write-effective-design-by-using.html)
39. [https://www.geeksforgeeks.org/system-design/difference-between-high-level-design-and-low-level-design/](https://www.geeksforgeeks.org/system-design/difference-between-high-level-design-and-low-level-design/)
40. [https://tecnovy.com/en/software-architecture-vs-design](https://tecnovy.com/en/software-architecture-vs-design)
41. [https://complextester.wordpress.com/2012/08/10/making-of-hld-lld/](https://complextester.wordpress.com/2012/08/10/making-of-hld-lld/)
42. [https://www.scaler.com/topics/high-level-design-and-low-level-design/](https://www.scaler.com/topics/high-level-design-and-low-level-design/)
43. [https://dev.to/mohini_chauhan_1403/software-design-vs-software-architecture-stop-mixing-up-these-two-tech-twins-38o2](https://dev.to/mohini_chauhan_1403/software-design-vs-software-architecture-stop-mixing-up-these-two-tech-twins-38o2)
44. [https://getsdeready.com/lld-vs-hld-key-differences-for-sdes/](https://getsdeready.com/lld-vs-hld-key-differences-for-sdes/)
45. [https://funix.edu.vn/chia-se-kien-thuc/thiet-ke-he-thong-cap-cao-hld/](https://funix.edu.vn/chia-se-kien-thuc/thiet-ke-he-thong-cap-cao-hld/)
46. [https://www.theknowledgeacademy.com/blog/software-architecture-vs-design/](https://www.theknowledgeacademy.com/blog/software-architecture-vs-design/)
47. [https://github.com/AdriaticOrg/sdd](https://github.com/AdriaticOrg/sdd)
48. [http://thecreatingexperts.com/wp-content/uploads/2014/06/HLD.doc](http://thecreatingexperts.com/wp-content/uploads/2014/06/HLD.doc)
49. [https://github.com/wepay/design_doc_template](https://github.com/wepay/design_doc_template)
50. [https://github.com/topics/design-document](https://github.com/topics/design-document)
51. [https://senior.ceng.metu.edu.tr/2014/hebelegubelegom/documents/InitialDesignReport.pdf](https://senior.ceng.metu.edu.tr/2014/hebelegubelegom/documents/InitialDesignReport.pdf)
52. [https://github.com/VCTLabs/MIL-STD-498](https://github.com/VCTLabs/MIL-STD-498)
53. [https://ieeexplore.ieee.org/iel1/2822/6884/00278258.pdf](https://ieeexplore.ieee.org/iel1/2822/6884/00278258.pdf)
54. [https://www.reddit.com/r/networking/comments/bhnp79/hlds_and_llds_documentation_templatesexamples/](https://www.reddit.com/r/networking/comments/bhnp79/hlds_and_llds_documentation_templatesexamples/)
55. [https://github.com/imayobrown/DesignDocumentTemplates](https://github.com/imayobrown/DesignDocumentTemplates)
```


# Báº¢N HIá»†N Táº I: TECHNICAL DEEP-DIVE SPECIFICATION (TDD)

**Version 3.1 - Universal Pro Edition**  
_Ãp dá»¥ng cho: Backend, Frontend, AI/ML Systems_

---

## ğŸ“‹ METADATA (Document Header)

_Báº¯t buá»™c cÃ³ á»Ÿ Ä‘áº§u má»i tÃ i liá»‡u TDD_

```yaml
# ============================================
# DOCUMENT METADATA
# ============================================
Title: [TÃªn Module/System - VD: User Authentication Service]
Document ID: TDD-[PROJECT]-[MODULE]-[VERSION] # VD: TDD-PIKA-AUTH-001
Author: [Primary Engineer/Architect]
Co-Authors: [CÃ¡c contributor khÃ¡c]
Reviewers: 
  - Technical: [Tech Lead Name]
  - Product: [Product Manager Name]  
  - Security: [Security Engineer Name]
  - QA: [QA Lead Name]

Status: [Draft | In Review | Approved | Implemented | Deprecated]
Priority: [P0-Critical | P1-High | P2-Medium | P3-Low]

# Timeline
Created: YYYY-MM-DD
Last Updated: YYYY-MM-DD
Target Release: YYYY-MM-DD (Sprint/Quarter)
Review Deadline: YYYY-MM-DD

# Versioning
Version: X.Y.Z (Semantic Versioning)
# X = Major breaking changes
# Y = New features
# Z = Bug fixes/minor updates

# Related Documents
Related Docs:
  - PRD: [Link to Product Requirements Document]
  - ADR: [Link to Architecture Decision Records]
  - API Spec: [Link to OpenAPI/Swagger]
  - UI Design: [Link to Figma/Sketch]
  - Test Plan: [Link to Test Strategy Document]
```

**ğŸ“Œ Tips:**

- LuÃ´n update `Last Updated` khi cÃ³ thay Ä‘á»•i
- Version bump theo quy táº¯c: Bug fix â†’ Z++, New feature â†’ Y++, Breaking change â†’ X++
- Status flow: Draft â†’ In Review â†’ Approved â†’ Implemented

---

## 1. OVERVIEW & CONTEXT

_Tá»•ng quan ngáº¯n gá»n - Giá»¯ dÆ°á»›i 1 trang A4_

### 1.1. Executive Summary (TL;DR)

|Item|Description|
|:--|:--|
|**Problem Statement**|[1-2 cÃ¢u mÃ´ táº£ váº¥n Ä‘á» cáº§n giáº£i quyáº¿t]|
|**Proposed Solution**|[1-2 cÃ¢u mÃ´ táº£ giáº£i phÃ¡p]|
|**Business Impact**|[Quantifiable value - VD: TÄƒng conversion 20%, giáº£m latency 50%]|
|**Technical Impact**|[VD: Reduce infra cost 30%, improve reliability to 99.9%]|
|**Estimated Effort**|[X ngÆ°á»i Ã— Y sprint = Z man-days]|
|**Risk Level**|[Low/Medium/High] vá»›i brief justification|

**Example:**

```
Problem: Há»‡ thá»‘ng authentication hiá»‡n táº¡i khÃ´ng scale Ä‘Æ°á»£c quÃ¡ 1000 concurrent users,
         response time tÄƒng exponentially khi load cao.

Solution: Migrate tá»« session-based sang JWT + Redis distributed cache,
          implement rate limiting vÃ  connection pooling.

Impact: 
- Business: Giáº£m bounce rate 15%, support 10x more users
- Technical: p99 latency tá»« 2s â†’ 200ms, uptime 99.9%
```

### 1.2. Background & Motivation

#### 1.2.1. Why Now?

- **Business Driver:** [Táº¡i sao timing nÃ y quan trá»ng? VD: Chuáº©n bá»‹ cho Black Friday]
- **Technical Debt:** [Debt nÃ o Ä‘ang block progress?]
- **Market Opportunity:** [CÆ¡ há»™i thá»‹ trÆ°á»ng náº¿u cÃ³]

#### 1.2.2. Current State (As-Is)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CURRENT ARCHITECTURE                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [MÃ´ táº£ há»‡ thá»‘ng hiá»‡n táº¡i - diagram náº¿u cáº§n]               â”‚
â”‚                                                             â”‚
â”‚  Pain Points:                                               â”‚
â”‚  1. [Issue 1 + Impact]                                      â”‚
â”‚  2. [Issue 2 + Impact]                                      â”‚
â”‚  3. [Issue 3 + Impact]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.3. Target State (To-Be)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TARGET ARCHITECTURE                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [MÃ´ táº£ há»‡ thá»‘ng sau khi implement - diagram]              â”‚
â”‚                                                             â”‚
â”‚  Benefits:                                                  â”‚
â”‚  1. [Benefit 1 + Metric]                                    â”‚
â”‚  2. [Benefit 2 + Metric]                                    â”‚
â”‚  3. [Benefit 3 + Metric]                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 1.2.4. Alternatives Considered

|Alternative|Pros|Cons|Why Rejected|
|:--|:--|:--|:--|
|Option A|- Pro 1<br>- Pro 2|- Con 1<br>- Con 2|[LÃ½ do]|
|Option B|- Pro 1<br>- Pro 2|- Con 1<br>- Con 2|[LÃ½ do]|
|**Selected**|- Pro 1<br>- Pro 2|- Con 1 (mitigated by X)|âœ… Best fit|

### 1.3. Success Criteria

#### Definition of Done (DoD)

**Technical Criteria:**

- [ ] All unit tests pass (coverage â‰¥ 80%)
- [ ] Integration tests pass
- [ ] Performance benchmarks met (see NFR section)
- [ ] Security scan clean (no Critical/High vulnerabilities)
- [ ] Documentation updated

**Business Criteria:**

- [ ] [Metric 1] achieved: [Target value]
- [ ] [Metric 2] achieved: [Target value]
- [ ] Stakeholder sign-off obtained

#### Key Performance Indicators (KPIs)

|KPI|Current|Target|Measurement Method|
|:--|:--|:--|:--|
|Response Time (p95)|500ms|100ms|Datadog APM|
|Error Rate|2%|0.1%|Prometheus metrics|
|Throughput|100 rps|1000 rps|Load test (k6)|
|Uptime|99%|99.9%|StatusPage|

---

## 2. GOALS / SCOPE / NON-GOALS / ASSUMPTIONS

_Äá»‹nh nghÄ©a biÃªn giá»›i rÃµ rÃ ng - "Non-goals are as important as goals"_

### 2.1. Goals (Má»¥c tiÃªu)

#### 2.1.1. Business Goals

|Goal|Metric|Target|Timeline|
|:--|:--|:--|:--|
|Improve user retention|Churn rate|Giáº£m 15%|Q2 2025|
|Reduce support tickets|Tickets/week|Giáº£m 30%|Q2 2025|

#### 2.1.2. Technical Goals

|Goal|Metric|Target|Timeline|
|:--|:--|:--|:--|
|Improve performance|p95 latency|< 200ms|Sprint 5|
|Increase reliability|Uptime SLA|99.9%|Sprint 6|
|Reduce tech debt|Code coverage|> 80%|Ongoing|

#### 2.1.3. User Experience Goals

|Goal|Metric|Target|
|:--|:--|:--|
|Faster time-to-value|First meaningful interaction|< 30s|
|Reduce friction|Steps to complete task|< 3 clicks|

### 2.2. In-Scope (LÃ m)

**MVP Features (Must Have):**

1. âœ… [Feature 1]: [Brief description]
2. âœ… [Feature 2]: [Brief description]
3. âœ… [Feature 3]: [Brief description]

**Phase 2 Features (Should Have):**

1. ğŸ“‹ [Feature 4]: [Brief description]
2. ğŸ“‹ [Feature 5]: [Brief description]

### 2.3. Out-of-Scope / Non-Goals (KHÃ”NG lÃ m)

> âš ï¸ **Quan trá»ng:** Liá»‡t kÃª rÃµ nhá»¯ng gÃ¬ KHÃ”NG lÃ m Ä‘á»ƒ trÃ¡nh scope creep

|Non-Goal|Reason|Future Consideration?|
|:--|:--|:--|
|Multi-language support|Budget constraint|Phase 3 (Q4)|
|Mobile app|Different team scope|Parallel project|
|Legacy system migration|Out of timeline|Next fiscal year|
|Admin dashboard redesign|Not blocking|Low priority|

### 2.4. Assumptions

> ğŸ’¡ **Assumptions = Risks cáº§n validate sá»›m**

|ID|Assumption|Impact if Wrong|Validation Method|
|:--|:--|:--|:--|
|A1|AWS region ap-southeast-1 available|High - delay deployment|Check AWS status|
|A2|Redis cluster Ä‘Ã£ Ä‘Æ°á»£c provision|Medium - need alternative|Confirm with DevOps|
|A3|API Gateway supports rate limiting|Low - can implement custom|Test in staging|
|A4|User base < 100K in first 6 months|Medium - may need rescale|Monitor growth|

### 2.5. Constraints

#### 2.5.1. Technical Constraints

|Constraint|Reason|Workaround|
|:--|:--|:--|
|Must use Python 3.11+|Company standard|N/A|
|PostgreSQL only (no NoSQL)|Compliance requirement|N/A|
|AWS services only|Vendor lock-in policy|N/A|
|Max Docker image size 500MB|CI/CD pipeline limit|Multi-stage build|

#### 2.5.2. Business Constraints

|Constraint|Impact|Mitigation|
|:--|:--|:--|
|Budget < $50K/year|Limited infra options|Reserved instances, spot|
|Launch before Q2 2025|Tight timeline|Reduce MVP scope|
|2 engineers only|Resource limit|Prioritize ruthlessly|

#### 2.5.3. Compliance Constraints

|Regulation|Requirement|Implementation|
|:--|:--|:--|
|GDPR|Data residency in EU|Use eu-west-1 region|
|GDPR|Right to be forgotten|Implement data deletion API|
|PCI-DSS|No PII in logs|Log masking middleware|
|SOC2|Audit trail|Comprehensive logging|

### 2.6. Dependencies

#### 2.6.1. External Dependencies

|Dependency|Owner|Risk Level|Fallback|
|:--|:--|:--|:--|
|Stripe Payment API|External|Medium|PayPal backup|
|OpenAI API|External|High|Local LLM fallback|
|SendGrid Email|External|Low|AWS SES|

#### 2.6.2. Internal Dependencies

|Dependency|Team|Status|ETA|
|:--|:--|:--|:--|
|User Service API v2|Platform Team|In Progress|Week 3|
|Design System v3|Frontend Team|Done|âœ…|
|Database migration|DBA Team|Pending|Week 2|

#### 2.6.3. Dependency Graph

```mermaid
graph LR
    A[This Project] --> B[User Service]
    A --> C[Payment Service]
    A --> D[Notification Service]
    B --> E[Database]
    C --> F[Stripe API]
    D --> G[SendGrid]
```

---

## 3. USER STORIES / USE CASES

_MÃ´ táº£ hÃ nh vi ngÆ°á»i dÃ¹ng theo format chuáº©n_

### 3.1. Primary Actors

|Actor|Description|Access Level|
|:--|:--|:--|
|End User|NgÆ°á»i dÃ¹ng cuá»‘i sá»­ dá»¥ng sáº£n pháº©m|Basic|
|Admin|Quáº£n trá»‹ viÃªn há»‡ thá»‘ng|Full|
|API Consumer|Service khÃ¡c gá»i API|Service-to-service|
|System (Cron)|Automated jobs|Internal|

### 3.2. User Stories

#### Format chuáº©n:

```gherkin
User Story ID: US-[NUMBER]
Priority: [P0/P1/P2/P3]
Estimate: [Story Points]

As a [role]
I want to [action/capability]
So that [benefit/value]

Acceptance Criteria:
- Given [precondition]
  When [action]
  Then [expected result]
  
Technical Notes:
- [Implementation hints]
- [Edge cases to consider]
```

#### US-001: User Login

```gherkin
User Story ID: US-001
Priority: P0
Estimate: 5 points

As a registered user
I want to login with email and password
So that I can access my personalized dashboard

Acceptance Criteria:
- Given valid credentials
  When I submit login form
  Then I am redirected to dashboard within 2 seconds
  And I receive a JWT token valid for 24 hours

- Given invalid credentials
  When I submit login form
  Then I see error message "Invalid email or password"
  And login attempt is logged for security audit

- Given account is locked (5 failed attempts)
  When I try to login
  Then I see message "Account locked. Try again in 15 minutes"
  And I receive email notification about locked account

Technical Notes:
- Rate limit: 5 attempts per 15 minutes per IP
- Password hashing: bcrypt with cost factor 12
- JWT includes: user_id, role, exp, iat
```

#### US-002: [TÃªn User Story]

```gherkin
# ThÃªm cÃ¡c user stories khÃ¡c theo format tÆ°Æ¡ng tá»±
```

### 3.3. User Flows / Journey Maps

#### 3.3.1. Happy Path Flow

```mermaid
flowchart TD
    A[User visits /login] --> B{Has account?}
    B -->|Yes| C[Enter credentials]
    B -->|No| D[Click Register]
    C --> E{Valid?}
    E -->|Yes| F[Generate JWT]
    F --> G[Redirect to Dashboard]
    E -->|No| H[Show error]
    H --> C
    D --> I[Registration Flow]
```

#### 3.3.2. Error Flow

```mermaid
flowchart TD
    A[User enters credentials] --> B{Validate}
    B -->|Invalid format| C[Show validation error]
    B -->|Valid format| D[Check credentials]
    D -->|Wrong password| E{Attempt count?}
    E -->|< 5| F[Show error + remaining attempts]
    E -->|>= 5| G[Lock account 15min]
    D -->|User not found| H[Show generic error]
```

### 3.4. Edge Cases & Error Scenarios

|Scenario|Expected Behavior|Priority|
|:--|:--|:--|
|Network timeout during login|Show "Connection error. Please retry." + retry button|P0|
|Session expired mid-action|Redirect to login with return URL|P0|
|Concurrent login from 2 devices|Allow both, track in sessions table|P1|
|Browser refresh during 2FA|Preserve state in localStorage|P1|
|SQL injection in email field|Sanitize input, return 400 Bad Request|P0|
|Password with unicode chars|Support UTF-8, normalize before hash|P2|

### 3.5. Domain-Specific Additions

#### ğŸ–¥ï¸ Frontend-specific

- **Wireframes:** [Link to Figma/Sketch]
- **Mockups:** [Link to high-fidelity designs]
- **Interaction States:** Loading, Success, Error, Empty states
- **Responsive Breakpoints:** Mobile (320px), Tablet (768px), Desktop (1024px+)

#### ğŸ¤– AI/ML-specific

- **Inference Scenarios:** Batch processing, Real-time prediction
- **Model Failure Modes:** What happens when model returns low confidence?
- **Fallback Behavior:** Rule-based fallback when model unavailable
- **Human-in-the-loop:** When to escalate to human review

---

## 4. API CONTRACT & INTERFACES

_Äáº·c táº£ giao tiáº¿p giá»¯a components - Source of truth cho integration_

### 4.1. API Design Principles

|Principle|Implementation|
|:--|:--|
|Protocol|REST (OpenAPI 3.0) / GraphQL / gRPC|
|Versioning|URI versioning: `/v1/`, `/v2/`|
|Naming|Nouns for resources, kebab-case: `/user-profiles`|
|Filtering|Query params: `?status=active&sort=-created_at`|
|Pagination|Cursor-based: `?cursor=xxx&limit=20`|
|Authentication|JWT Bearer token in Authorization header|
|Rate Limiting|100 req/min per user, 1000 req/min per IP|

### 4.2. Endpoint Specifications

#### 4.2.1. Authentication Endpoints

##### POST /v1/auth/login

```yaml
Summary: Authenticate user and return JWT token
Tags: [Authentication]
Security: None (public endpoint)

Request:
  Headers:
    Content-Type: application/json
    X-Request-ID: string (optional, for tracing)
    X-Client-Version: string (optional, for compatibility)
  
  Body:
    type: object
    required: [email, password]
    properties:
      email:
        type: string
        format: email
        maxLength: 255
        example: "user@example.com"
      password:
        type: string
        minLength: 8
        maxLength: 128
        example: "SecureP@ss123"
      remember_me:
        type: boolean
        default: false
        description: "If true, token valid for 30 days instead of 24 hours"

Response:
  200 OK:
    description: Login successful
    body:
      type: object
      properties:
        data:
          type: object
          properties:
            access_token:
              type: string
              example: "eyJhbGciOiJIUzI1NiIs..."
            refresh_token:
              type: string
              example: "dGhpcyBpcyBhIHJlZnJl..."
            token_type:
              type: string
              enum: [Bearer]
            expires_in:
              type: integer
              description: "Seconds until expiration"
              example: 86400
            user:
              type: object
              properties:
                id: {type: string, format: uuid}
                email: {type: string}
                name: {type: string}
                role: {type: string, enum: [user, admin]}
        meta:
          type: object
          properties:
            request_id: {type: string}
            timestamp: {type: string, format: date-time}
  
  400 Bad Request:
    description: Invalid input
    body: {$ref: '#/components/schemas/ErrorResponse'}
  
  401 Unauthorized:
    description: Invalid credentials
    body: {$ref: '#/components/schemas/ErrorResponse'}
  
  429 Too Many Requests:
    description: Rate limit exceeded
    headers:
      Retry-After: {type: integer, description: "Seconds to wait"}
      X-RateLimit-Limit: {type: integer}
      X-RateLimit-Remaining: {type: integer}
    body: {$ref: '#/components/schemas/ErrorResponse'}

Rate Limit: 5 requests per 15 minutes per IP
Idempotency: Not required (stateless)
```

##### POST /v1/auth/refresh

```yaml
Summary: Refresh access token using refresh token
Tags: [Authentication]
Security: None (uses refresh token in body)

Request:
  Body:
    type: object
    required: [refresh_token]
    properties:
      refresh_token:
        type: string
        example: "dGhpcyBpcyBhIHJlZnJl..."

Response:
  200 OK:
    body:
      data:
        access_token: string
        expires_in: integer
  
  401 Unauthorized:
    description: Invalid or expired refresh token
```

#### 4.2.2. Resource Endpoints

##### GET /v1/users/{user_id}

```yaml
Summary: Get user profile by ID
Tags: [Users]
Security: Bearer JWT (scope: read:users)

Path Parameters:
  user_id:
    type: string
    format: uuid
    required: true

Query Parameters:
  include:
    type: array
    items: {type: string, enum: [profile, settings, activity]}
    description: "Related resources to include"
    example: "?include=profile,settings"

Response:
  200 OK:
    body:
      data:
        id: string
        email: string
        name: string
        created_at: string (ISO 8601)
        profile: object (if included)
        settings: object (if included)
  
  404 Not Found:
    description: User not found
```

### 4.3. Data Models (Schemas)

#### 4.3.1. Request/Response Schemas

```typescript
// TypeScript interfaces for type safety

interface User {
  id: string;           // UUID v4
  email: string;        // Unique, lowercase
  name: string;         // Display name
  role: 'user' | 'admin';
  status: 'active' | 'inactive' | 'suspended';
  created_at: string;   // ISO 8601
  updated_at: string;   // ISO 8601
}

interface PaginatedResponse<T> {
  data: T[];
  meta: {
    total: number;
    page: number;
    per_page: number;
    total_pages: number;
  };
  links: {
    self: string;
    first: string;
    prev: string | null;
    next: string | null;
    last: string;
  };
}

interface ErrorResponse {
  error: {
    code: string;           // Machine-readable: "RESOURCE_NOT_FOUND"
    message: string;        // Human-readable: "User with ID 123 not found"
    details?: object;       // Additional context
    trace_id: string;       // For debugging: "abc-123-xyz"
    timestamp: string;      // ISO 8601
    path: string;           // Request path
  };
}
```

#### 4.3.2. JSON Schema (for validation)

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CreateUserRequest",
  "type": "object",
  "required": ["email", "password", "name"],
  "properties": {
    "email": {
      "type": "string",
      "format": "email",
      "maxLength": 255
    },
    "password": {
      "type": "string",
      "minLength": 8,
      "maxLength": 128,
      "pattern": "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$"
    },
    "name": {
      "type": "string",
      "minLength": 2,
      "maxLength": 100
    }
  },
  "additionalProperties": false
}
```

### 4.4. Error Handling Standards

#### 4.4.1. Error Code Registry

|HTTP Code|Error Code|Description|User Message|
|:--|:--|:--|:--|
|400|`VALIDATION_ERROR`|Invalid request payload|"Please check your input"|
|400|`INVALID_FORMAT`|Wrong data format|"Invalid {field} format"|
|401|`INVALID_CREDENTIALS`|Wrong email/password|"Invalid email or password"|
|401|`TOKEN_EXPIRED`|JWT expired|"Session expired. Please login again"|
|403|`FORBIDDEN`|No permission|"You don't have permission"|
|404|`RESOURCE_NOT_FOUND`|Entity not found|"{Resource} not found"|
|409|`CONFLICT`|Duplicate resource|"{Resource} already exists"|
|429|`RATE_LIMITED`|Too many requests|"Too many requests. Try again later"|
|500|`INTERNAL_ERROR`|Server error|"Something went wrong. Please try again"|
|503|`SERVICE_UNAVAILABLE`|Dependency down|"Service temporarily unavailable"|

#### 4.4.2. Error Response Format

```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid request payload",
    "details": {
      "fields": [
        {
          "field": "email",
          "message": "Must be a valid email address",
          "code": "INVALID_FORMAT"
        },
        {
          "field": "password",
          "message": "Must be at least 8 characters",
          "code": "TOO_SHORT"
        }
      ]
    },
    "trace_id": "abc-123-xyz-789",
    "timestamp": "2025-01-15T10:30:00Z",
    "path": "/v1/auth/register",
    "documentation_url": "https://docs.api.com/errors/VALIDATION_ERROR"
  }
}
```

### 4.5. API Versioning Strategy

```
Version Lifecycle:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Alpha   â”‚â”€â”€â”€â–ºâ”‚   Beta   â”‚â”€â”€â”€â–ºâ”‚  Stable  â”‚â”€â”€â”€â–ºâ”‚ Deprecatedâ”‚
â”‚ /v2-alphaâ”‚    â”‚ /v2-beta â”‚    â”‚   /v2    â”‚    â”‚   /v1    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚              â”‚
                                     â”‚    Sunset    â”‚
                                     â”‚    Period    â”‚
                                     â”‚   (6 months) â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Deprecation Headers:
- Deprecation: true
- Sunset: Sat, 01 Jan 2026 00:00:00 GMT
- Link: <https://api.example.com/v2>; rel="successor-version"
```

### 4.6. Domain-Specific API Additions

#### ğŸ–¥ï¸ Frontend Component API

```typescript
// Component Props Interface
interface ButtonProps {
  variant: 'primary' | 'secondary' | 'danger';
  size: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  loading?: boolean;
  onClick: (event: React.MouseEvent) => void;
  children: React.ReactNode;
}

// Event Callbacks
interface FormCallbacks {
  onSubmit: (data: FormData) => Promise<void>;
  onError: (error: Error) => void;
  onSuccess: (result: Result) => void;
}
```

#### ğŸ¤– AI/ML Model API

```yaml
POST /v1/predict
Summary: Make prediction using ML model

Request:
  Body:
    model_id: string
    features:
      type: array
      items:
        type: object
        properties:
          name: string
          value: number | string | array

Response:
  200 OK:
    prediction: number | string | array
    confidence: number (0-1)
    model_version: string
    inference_time_ms: number
    feature_importance: object (optional)
```

---

## 5. DATA MODEL & STORAGE DESIGN

_Thiáº¿t káº¿ lÆ°u trá»¯ dá»¯ liá»‡u - Schema, Indexing, Caching_

### 5.1. Entity Relationship Diagram (ERD)

```mermaid
erDiagram
    USERS ||--o{ USER_SESSIONS : has
    USERS ||--o{ USER_PROFILES : has
    USERS ||--o{ AUDIT_LOGS : creates
    
    USERS {
        uuid id PK
        varchar(255) email UK
        varchar(255) password_hash
        varchar(100) name
        enum role "user|admin"
        enum status "active|inactive|suspended"
        timestamp created_at
        timestamp updated_at
        timestamp deleted_at
    }
    
    USER_SESSIONS {
        uuid id PK
        uuid user_id FK
        varchar(500) token_hash
        varchar(45) ip_address
        varchar(500) user_agent
        timestamp expires_at
        timestamp created_at
    }
    
    USER_PROFILES {
        uuid id PK
        uuid user_id FK "unique"
        varchar(255) avatar_url
        date date_of_birth
        varchar(20) phone
        jsonb preferences
        timestamp updated_at
    }
    
    AUDIT_LOGS {
        bigserial id PK
        uuid user_id FK
        varchar(50) action
        varchar(100) resource_type
        uuid resource_id
        jsonb old_value
        jsonb new_value
        varchar(45) ip_address
        timestamp created_at
    }
```

### 5.2. Schema Definition

#### 5.2.1. Table: users

```sql
-- PostgreSQL Schema
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    role VARCHAR(20) NOT NULL DEFAULT 'user' 
        CHECK (role IN ('user', 'admin')),
    status VARCHAR(20) NOT NULL DEFAULT 'active' 
        CHECK (status IN ('active', 'inactive', 'suspended')),
    email_verified_at TIMESTAMP WITH TIME ZONE,
    last_login_at TIMESTAMP WITH TIME ZONE,
    failed_login_attempts INTEGER NOT NULL DEFAULT 0,
    locked_until TIMESTAMP WITH TIME ZONE,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    deleted_at TIMESTAMP WITH TIME ZONE,  -- Soft delete
    
    -- Constraints
    CONSTRAINT users_email_unique UNIQUE (email),
    CONSTRAINT users_email_lowercase CHECK (email = LOWER(email))
);

-- Indexes
CREATE INDEX idx_users_email ON users(email) WHERE deleted_at IS NULL;
CREATE INDEX idx_users_status ON users(status) WHERE deleted_at IS NULL;
CREATE INDEX idx_users_created_at ON users(created_at DESC);
CREATE INDEX idx_users_deleted_at ON users(deleted_at) WHERE deleted_at IS NOT NULL;

-- Trigger for updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_users_updated_at
    BEFORE UPDATE ON users
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

-- Comments
COMMENT ON TABLE users IS 'Core user accounts table';
COMMENT ON COLUMN users.password_hash IS 'bcrypt hash with cost factor 12';
COMMENT ON COLUMN users.deleted_at IS 'Soft delete timestamp - NULL means active';
```

#### 5.2.2. Table: user_sessions

```sql
CREATE TABLE user_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    refresh_token_hash VARCHAR(255) NOT NULL,
    ip_address INET,
    user_agent VARCHAR(500),
    device_fingerprint VARCHAR(255),
    is_revoked BOOLEAN NOT NULL DEFAULT FALSE,
    expires_at TIMESTAMP WITH TIME ZONE NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    last_used_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_sessions_user_id ON user_sessions(user_id) 
    WHERE is_revoked = FALSE;
CREATE INDEX idx_sessions_token ON user_sessions(refresh_token_hash) 
    WHERE is_revoked = FALSE;
CREATE INDEX idx_sessions_expires ON user_sessions(expires_at) 
    WHERE is_revoked = FALSE;

-- Partition by month (for high-volume systems)
-- CREATE TABLE user_sessions_2025_01 PARTITION OF user_sessions
--     FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');
```

### 5.3. Indexing Strategy

|Table|Index Name|Columns|Type|Purpose|
|:--|:--|:--|:--|:--|
|users|idx_users_email|email|B-tree|Login lookup|
|users|idx_users_status|status|B-tree|Filter by status|
|users|idx_users_search|name, email|GIN (pg_trgm)|Full-text search|
|sessions|idx_sessions_user|user_id|B-tree|User's sessions|
|sessions|idx_sessions_token|token_hash|Hash|Token validation|
|audit_logs|idx_audit_created|created_at|BRIN|Time-range queries|
|audit_logs|idx_audit_user|user_id, created_at|B-tree|User activity|

#### Index Guidelines:

```sql
-- DO: Create indexes for frequent queries
CREATE INDEX idx_users_email ON users(email);

-- DO: Use partial indexes to reduce size
CREATE INDEX idx_active_users ON users(email) WHERE status = 'active';

-- DO: Use covering indexes for common queries
CREATE INDEX idx_users_list ON users(status, created_at DESC) INCLUDE (email, name);

-- DON'T: Over-index (each index slows writes)
-- DON'T: Index low-cardinality columns alone (e.g., boolean)
-- DON'T: Forget to analyze after bulk inserts
```

### 5.4. Data Versioning & Migration

#### 5.4.1. Migration Strategy (Alembic)

```python
# migrations/versions/001_create_users_table.py
"""Create users table

Revision ID: 001
Revises: 
Create Date: 2025-01-15 10:00:00
"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

revision = '001'
down_revision = None
branch_labels = None
depends_on = None

def upgrade():
    op.create_table(
        'users',
        sa.Column('id', postgresql.UUID(), nullable=False, 
                  server_default=sa.text('gen_random_uuid()')),
        sa.Column('email', sa.String(255), nullable=False),
        sa.Column('password_hash', sa.String(255), nullable=False),
        sa.Column('name', sa.String(100), nullable=False),
        sa.Column('role', sa.String(20), nullable=False, server_default='user'),
        sa.Column('status', sa.String(20), nullable=False, server_default='active'),
        sa.Column('created_at', sa.DateTime(timezone=True), 
                  nullable=False, server_default=sa.text('NOW()')),
        sa.Column('updated_at', sa.DateTime(timezone=True), 
                  nullable=False, server_default=sa.text('NOW()')),
        sa.Column('deleted_at', sa.DateTime(timezone=True), nullable=True),
        sa.PrimaryKeyConstraint('id'),
        sa.UniqueConstraint('email', name='users_email_unique')
    )
    op.create_index('idx_users_email', 'users', ['email'], 
                    postgresql_where=sa.text('deleted_at IS NULL'))

def downgrade():
    op.drop_index('idx_users_email')
    op.drop_table('users')
```

#### 5.4.2. Zero-Downtime Migration Pattern

```
Phase 1: Add new column (nullable)
Phase 2: Dual-write (write to both old and new)
Phase 3: Backfill existing data
Phase 4: Switch reads to new column
Phase 5: Stop writing to old column
Phase 6: Remove old column

Example Timeline:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Day 1   â”‚ Day 2   â”‚ Day 3   â”‚ Day 4   â”‚ Day 5   â”‚ Day 6        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Add col â”‚ Dual    â”‚ Backfillâ”‚ Switch  â”‚ Stop    â”‚ Drop old     â”‚
â”‚ (null)  â”‚ write   â”‚ data    â”‚ reads   â”‚ old wr  â”‚ column       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.5. Caching Strategy

#### 5.5.1. Cache Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CACHING ARCHITECTURE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   Browser   â”‚   â”‚   CDN       â”‚   â”‚  Application    â”‚  â”‚
â”‚   â”‚   Cache     â”‚   â”‚   (Edge)    â”‚   â”‚  Cache (Redis)  â”‚  â”‚
â”‚   â”‚   (L1)      â”‚   â”‚   (L2)      â”‚   â”‚  (L3)           â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â”‚                 â”‚                    â”‚           â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                           â”‚                                â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â”‚  Database   â”‚                        â”‚
â”‚                    â”‚  (Source)   â”‚                        â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.5.2. Cache Configuration

|Data Type|Cache Key Pattern|TTL|Invalidation Strategy|
|:--|:--|:--|:--|
|User profile|`user:{user_id}`|1 hour|Write-through on update|
|Session|`session:{token_hash}`|24 hours|Explicit delete on logout|
|API response|`api:{endpoint}:{hash}`|5 min|Time-based expiry|
|Rate limit|`ratelimit:{ip}:{endpoint}`|1 min|Sliding window|
|Feature flag|`feature:{flag_name}`|30 sec|Pub/sub notification|

#### 5.5.3. Redis Cache Implementation

```python
# cache_manager.py
import redis
import json
from typing import Optional, Any
from functools import wraps

class CacheManager:
    def __init__(self, redis_url: str):
        self.redis = redis.from_url(redis_url, decode_responses=True)
        
    def get(self, key: str) -> Optional[Any]:
        value = self.redis.get(key)
        return json.loads(value) if value else None
    
    def set(self, key: str, value: Any, ttl: int = 3600):
        self.redis.setex(key, ttl, json.dumps(value))
    
    def delete(self, key: str):
        self.redis.delete(key)
    
    def delete_pattern(self, pattern: str):
        """Delete all keys matching pattern"""
        cursor = 0
        while True:
            cursor, keys = self.redis.scan(cursor, match=pattern, count=100)
            if keys:
                self.redis.delete(*keys)
            if cursor == 0:
                break

# Decorator for caching
def cached(key_template: str, ttl: int = 3600):
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, **kwargs):
            cache_key = key_template.format(**kwargs)
            cached_value = cache_manager.get(cache_key)
            if cached_value:
                return cached_value
            result = await func(*args, **kwargs)
            cache_manager.set(cache_key, result, ttl)
            return result
        return wrapper
    return decorator

# Usage
@cached(key_template="user:{user_id}", ttl=3600)
async def get_user(user_id: str) -> dict:
    return await db.users.find_one({"id": user_id})
```

### 5.6. Data Retention & Archival

|Data Type|Retention Period|Archive Strategy|Deletion Method|
|:--|:--|:--|:--|
|User data|Until account deletion + 30 days|Cold storage (S3 Glacier)|Hard delete after retention|
|Audit logs|7 years (compliance)|Monthly archive to S3|Automated after 7 years|
|Session data|30 days after expiry|No archive|Hard delete|
|Analytics|2 years|Aggregate then archive|Hard delete raw data|

#### GDPR Compliance: Right to be Forgotten

```python
async def delete_user_data(user_id: str, requester_id: str):
    """
    GDPR Article 17 - Right to erasure
    """
    # 1. Verify request authorization
    if not await verify_deletion_request(user_id, requester_id):
        raise UnauthorizedError("Not authorized to delete this data")
    
    # 2. Create deletion audit record BEFORE deleting
    await create_audit_log(
        action="GDPR_DELETION_REQUEST",
        user_id=user_id,
        requester_id=requester_id
    )
    
    # 3. Anonymize data in related tables
    await db.execute("""
        UPDATE orders SET customer_email = 'deleted@anonymized.com'
        WHERE user_id = :user_id
    """, {"user_id": user_id})
    
    # 4. Delete user record
    await db.execute("""
        DELETE FROM users WHERE id = :user_id
    """, {"user_id": user_id})
    
    # 5. Invalidate caches
    cache.delete_pattern(f"user:{user_id}*")
    cache.delete_pattern(f"session:*:{user_id}")
    
    # 6. Queue background job for external systems
    await queue.publish("user.deleted", {"user_id": user_id})
    
    return {"status": "deleted", "user_id": user_id}
```

### 5.7. Domain-Specific Data Additions

#### ğŸ–¥ï¸ Frontend State Management

```typescript
// Redux Store Structure
interface RootState {
  auth: {
    user: User | null;
    token: string | null;
    isAuthenticated: boolean;
    loading: boolean;
  };
  ui: {
    theme: 'light' | 'dark';
    sidebar: {
      isOpen: boolean;
      activeItem: string;
    };
    notifications: Notification[];
  };
  entities: {
    users: Record<string, User>;
    posts: Record<string, Post>;
  };
}

// Local Storage Strategy
const STORAGE_KEYS = {
  AUTH_TOKEN: 'auth_token',
  USER_PREFERENCES: 'user_prefs',
  THEME: 'theme',
};

// Session Storage (cleared on tab close)
const SESSION_KEYS = {
  FORM_DRAFT: 'form_draft',
  SCROLL_POSITION: 'scroll_pos',
};
```

#### ğŸ¤– AI/ML Data Management

```yaml
# Feature Store Schema
feature_groups:
  user_features:
    entity_key: user_id
    features:
      - name: login_count_7d
        dtype: int64
        description: "Number of logins in last 7 days"
      - name: avg_session_duration
        dtype: float64
        description: "Average session duration in seconds"
    ttl: 86400  # 24 hours
    
  item_features:
    entity_key: item_id
    features:
      - name: embedding_vector
        dtype: array<float64>[128]
        description: "Item embedding from trained model"
      - name: popularity_score
        dtype: float64
        description: "Normalized popularity (0-1)"

# Model Versioning
model_registry:
  - model_name: "user_churn_predictor"
    version: "v2.3.1"
    artifact_path: "s3://models/churn/v2.3.1/"
    metrics:
      auc_roc: 0.87
      precision: 0.82
      recall: 0.79
    status: "production"
    created_at: "2025-01-10"

# Dataset Lineage
dataset_lineage:
  training_data_v3:
    source: "s3://data/raw/users/"
    transformations:
      - "remove_pii"
      - "normalize_features"
      - "split_train_test"
    output: "s3://data/processed/training_v3/"
    created_by: "pipeline/feature_engineering"
    created_at: "2025-01-05"
```

---

## 6. SYSTEM ARCHITECTURE & FLOW

_Kiáº¿n trÃºc tá»•ng thá»ƒ vÃ  luá»“ng dá»¯ liá»‡u theo C4 Model_

### 6.1. High-Level Architecture (C4 Model)

#### Level 1: System Context Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SYSTEM CONTEXT DIAGRAM                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚  User   â”‚                                    â”‚  External APIs  â”‚ â”‚
â”‚     â”‚(Browser)â”‚                                    â”‚ (Stripe, etc.)  â”‚ â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                                                  â”‚          â”‚
â”‚          â”‚ HTTPS                                     HTTPS  â”‚          â”‚
â”‚          â–¼                                                  â–¼          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                                                              â”‚    â”‚
â”‚   â”‚                    [SYSTEM NAME]                             â”‚    â”‚
â”‚   â”‚                                                              â”‚    â”‚
â”‚   â”‚    - Provides user authentication                            â”‚    â”‚
â”‚   â”‚    - Manages user profiles                                   â”‚    â”‚
â”‚   â”‚    - Handles business logic                                  â”‚    â”‚
â”‚   â”‚                                                              â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚          â”‚                                                  â”‚          â”‚
â”‚          â”‚                                                  â”‚          â”‚
â”‚          â–¼                                                  â–¼          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Database   â”‚                                   â”‚    Email    â”‚   â”‚
â”‚   â”‚ (PostgreSQL)â”‚                                   â”‚  (SendGrid) â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Level 2: Container Diagram

```mermaid
graph TB
    subgraph "External"
        User[ğŸ‘¤ User<br/>Browser/Mobile]
        Admin[ğŸ‘¤ Admin<br/>Dashboard]
        External[ğŸŒ External APIs]
    end
    
    subgraph "System Boundary"
        LB[Load Balancer<br/>nginx/ALB]
        
        subgraph "Application Layer"
            API[API Gateway<br/>Kong/AWS API GW]
            Auth[Auth Service<br/>Python/FastAPI]
            Core[Core Service<br/>Python/FastAPI]
            Worker[Background Worker<br/>Celery]
        end
        
        subgraph "Data Layer"
            Cache[(Redis<br/>Cache + Sessions)]
            DB[(PostgreSQL<br/>Primary DB)]
            Queue[RabbitMQ<br/>Message Queue]
            S3[S3<br/>File Storage]
        end
    end
    
    User --> LB
    Admin --> LB
    LB --> API
    API --> Auth
    API --> Core
    Auth --> Cache
    Auth --> DB
    Core --> DB
    Core --> Queue
    Queue --> Worker
    Worker --> External
    Worker --> S3
```

### 6.2. Component Diagram (C4 Level 3)

```mermaid
graph TB
    subgraph "Auth Service"
        AuthController[Auth Controller<br/>/api/v1/auth/*]
        AuthService[Auth Service<br/>Business Logic]
        TokenService[Token Service<br/>JWT Management]
        UserRepo[User Repository<br/>Data Access]
        SessionRepo[Session Repository<br/>Data Access]
    end
    
    AuthController --> AuthService
    AuthService --> TokenService
    AuthService --> UserRepo
    AuthService --> SessionRepo
    TokenService --> Cache[(Redis)]
    UserRepo --> DB[(PostgreSQL)]
    SessionRepo --> DB
```

### 6.3. Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA FLOW: User Login                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â–ºâ”‚   API   â”‚â”€â”€â”€â–ºâ”‚   Auth   â”‚â”€â”€â”€â–ºâ”‚ Validate â”‚â”€â”€â”€â–ºâ”‚ User â”‚ â”‚
â”‚  â”‚        â”‚    â”‚ Gateway â”‚    â”‚ Service  â”‚    â”‚   DB     â”‚    â”‚  DB  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                            â”‚                              â”‚     â”‚
â”‚       â”‚                            â”‚                              â”‚     â”‚
â”‚       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚       â”‚    â”‚ Rate Limit  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚ Password    â”‚â—„â”€â”€â”€â”€â”˜     â”‚
â”‚       â”‚    â”‚   Check     â”‚         â”‚         â”‚ Verify      â”‚           â”‚
â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚       â”‚         â”‚                  â”‚                â”‚                   â”‚
â”‚       â”‚         â–¼                  â”‚                â–¼                   â”‚
â”‚       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚       â”‚â—„â”€â”€â”€â”‚  Redis  â”‚            â”‚          â”‚ Generate â”‚              â”‚
â”‚       â”‚    â”‚  Cache  â”‚            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   JWT    â”‚              â”‚
â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â”‚                           â”‚                                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4. Sequence Diagrams (Critical Paths)

#### 6.4.1. User Login Flow

```mermaid
sequenceDiagram
    autonumber
    participant C as Client
    participant GW as API Gateway
    participant RL as Rate Limiter
    participant AS as Auth Service
    participant R as Redis
    participant DB as PostgreSQL
    
    C->>GW: POST /v1/auth/login {email, password}
    GW->>RL: Check rate limit
    
    alt Rate limit exceeded
        RL-->>C: 429 Too Many Requests
    end
    
    RL->>AS: Forward request
    AS->>DB: SELECT user by email
    
    alt User not found
        AS-->>C: 401 Invalid credentials
    end
    
    DB-->>AS: User record
    AS->>AS: Verify password (bcrypt)
    
    alt Password invalid
        AS->>DB: INCREMENT failed_attempts
        AS-->>C: 401 Invalid credentials
    end
    
    AS->>AS: Generate JWT + Refresh Token
    AS->>R: Store session {token_hash, user_id, expires_at}
    AS->>DB: UPDATE last_login_at, RESET failed_attempts
    AS-->>C: 200 OK {access_token, refresh_token, user}
```

#### 6.4.2. Token Refresh Flow

```mermaid
sequenceDiagram
    participant C as Client
    participant AS as Auth Service
    participant R as Redis
    participant DB as PostgreSQL
    
    C->>AS: POST /v1/auth/refresh {refresh_token}
    AS->>R: GET session by token_hash
    
    alt Session not found or revoked
        AS-->>C: 401 Invalid token
    end
    
    R-->>AS: Session data
    AS->>AS: Validate expiration
    
    alt Token expired
        AS-->>C: 401 Token expired
    end
    
    AS->>AS: Generate new access_token
    AS->>R: UPDATE last_used_at
    AS-->>C: 200 OK {access_token}
```

### 6.5. State Machine Diagrams

#### 6.5.1. User Account States

```mermaid
stateDiagram-v2
    [*] --> Pending: Register
    Pending --> Active: Verify Email
    Pending --> [*]: Delete (30 days)
    Active --> Suspended: Admin Action / Policy Violation
    Active --> Locked: 5 Failed Logins
    Active --> Inactive: No login 90 days
    Suspended --> Active: Admin Restore
    Locked --> Active: 15 min timeout / Admin unlock
    Inactive --> Active: Login
    Active --> Deleted: User Request (GDPR)
    Deleted --> [*]: Data Purged (30 days)
```

#### 6.5.2. Order Processing States

```mermaid
stateDiagram-v2
    [*] --> Created: Create Order
    Created --> PaymentPending: Submit
    PaymentPending --> PaymentFailed: Payment Error
    PaymentPending --> Paid: Payment Success
    PaymentFailed --> PaymentPending: Retry
    PaymentFailed --> Cancelled: Max Retries
    Paid --> Processing: Start Fulfillment
    Processing --> Shipped: Ship Order
    Shipped --> Delivered: Delivery Confirmed
    Delivered --> Completed: Auto after 7 days
    Delivered --> Refunded: Refund Request
    Completed --> [*]
    Cancelled --> [*]
    Refunded --> [*]
```

### 6.6. Domain-Specific Architecture

#### ğŸ–¥ï¸ Frontend Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND ARCHITECTURE (React)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        Presentation Layer                        â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚  â”‚  Pages   â”‚  â”‚  Layouts â”‚  â”‚Componentsâ”‚  â”‚ Design Systemâ”‚    â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                       Application Layer                          â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚  â”‚  Hooks   â”‚  â”‚ Contexts â”‚  â”‚  Store   â”‚  â”‚  Services    â”‚    â”‚  â”‚
â”‚   â”‚  â”‚(useAuth) â”‚  â”‚(ThemeProv)â”‚  â”‚ (Redux)  â”‚  â”‚ (API Client)â”‚    â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                      Infrastructure Layer                        â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚  â”‚  Router  â”‚  â”‚   i18n   â”‚  â”‚Analytics â”‚  â”‚Error Boundaryâ”‚    â”‚  â”‚
â”‚   â”‚  â”‚(React R) â”‚  â”‚(react-i18n)â”‚ â”‚(Mixpanel)â”‚  â”‚  (Sentry)   â”‚    â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ¤– AI/ML Pipeline Architecture

```mermaid
graph LR
    subgraph "Data Pipeline"
        Raw[Raw Data] --> Ingest[Data Ingestion]
        Ingest --> Clean[Data Cleaning]
        Clean --> Feature[Feature Engineering]
        Feature --> Store[(Feature Store)]
    end
    
    subgraph "Training Pipeline"
        Store --> Train[Model Training]
        Train --> Eval[Evaluation]
        Eval --> Registry[(Model Registry)]
    end
    
    subgraph "Serving Pipeline"
        Registry --> Deploy[Model Deployment]
        Deploy --> Serve[Model Serving]
        Serve --> Monitor[Monitoring]
        Monitor --> Alert[Alerts]
    end
    
    subgraph "Feedback Loop"
        Serve --> Log[Prediction Logs]
        Log --> Analyze[Analysis]
        Analyze --> Retrain{Retrain?}
        Retrain -->|Yes| Train
    end
```

---

## 7. IMPLEMENTATION DETAILS (Deep-Dive)

_Chi tiáº¿t thuáº­t toÃ¡n vÃ  logic xá»­ lÃ½ kÃ¨m theo pseudo code_

### 7.1. Processing Pipeline Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      REQUEST PROCESSING PIPELINE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Request                                                               â”‚
â”‚      â”‚                                                                  â”‚
â”‚      â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. INGEST  â”‚â”€â”€â–ºâ”‚ 2. VALIDATEâ”‚â”€â”€â–ºâ”‚3. TRANSFORMâ”‚â”€â”€â–ºâ”‚ 4. PROCESS â”‚    â”‚
â”‚  â”‚            â”‚   â”‚            â”‚   â”‚            â”‚   â”‚            â”‚    â”‚
â”‚  â”‚ - Parse    â”‚   â”‚ - Schema   â”‚   â”‚ - Normalizeâ”‚   â”‚ - Business â”‚    â”‚
â”‚  â”‚ - Decode   â”‚   â”‚ - Sanitize â”‚   â”‚ - Enrich   â”‚   â”‚ - Logic    â”‚    â”‚
â”‚  â”‚ - Log      â”‚   â”‚ - Auth     â”‚   â”‚ - Map      â”‚   â”‚ - Rules    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚          â”‚
â”‚                                                             â–¼          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 8. RESPOND â”‚â—„â”€â”€â”‚ 7. FORMAT  â”‚â—„â”€â”€â”‚ 6. CACHE   â”‚â—„â”€â”€â”‚ 5. STORE   â”‚    â”‚
â”‚  â”‚            â”‚   â”‚            â”‚   â”‚            â”‚   â”‚            â”‚    â”‚
â”‚  â”‚ - Serializeâ”‚   â”‚ - Transformâ”‚   â”‚ - Set TTL  â”‚   â”‚ - Persist  â”‚    â”‚
â”‚  â”‚ - Compress â”‚   â”‚ - Filter   â”‚   â”‚ - Invalidateâ”‚  â”‚ - Index    â”‚    â”‚
â”‚  â”‚ - Send     â”‚   â”‚ - Paginate â”‚   â”‚ - Warm     â”‚   â”‚ - Replicateâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2. Per-Module Specification

#### 7.2.1. Authentication Module

|Attribute|Description|
|:--|:--|
|**Responsibility**|User authentication, token management, session handling|
|**Input**|Email, password, refresh token|
|**Output**|JWT access token, refresh token, user profile|
|**Dependencies**|UserRepository, TokenService, CacheService|

##### Pseudo Code: Login Flow

```python
"""
Authentication Service - Login Flow
"""

class AuthService:
    def __init__(self, user_repo, token_service, cache, config):
        self.user_repo = user_repo
        self.token_service = token_service
        self.cache = cache
        self.config = config
    
    async def login(self, email: str, password: str, remember_me: bool = False) -> AuthResult:
        """
        Authenticate user and return tokens
        
        Algorithm:
        1. Normalize email (lowercase, trim)
        2. Check rate limit
        3. Fetch user from database
        4. Verify password using bcrypt
        5. Check account status (not locked/suspended)
        6. Generate JWT access token
        7. Generate refresh token
        8. Store session in Redis
        9. Update user last_login_at
        10. Return tokens and user profile
        
        Time Complexity: O(1) average
        Space Complexity: O(1)
        """
        
        # Step 1: Normalize
        email = email.lower().strip()
        
        # Step 2: Check rate limit (fail fast)
        rate_key = f"login_attempts:{email}"
        attempts = await self.cache.incr(rate_key)
        if attempts == 1:
            await self.cache.expire(rate_key, 900)  # 15 minutes
        
        if attempts > self.config.MAX_LOGIN_ATTEMPTS:
            raise RateLimitError(
                message="Too many login attempts",
                retry_after=await self.cache.ttl(rate_key)
            )
        
        # Step 3: Fetch user
        user = await self.user_repo.find_by_email(email)
        if not user:
            # Security: Same error for non-existent user
            raise AuthenticationError("Invalid email or password")
        
        # Step 4: Verify password
        if not self._verify_password(password, user.password_hash):
            # Track failed attempt
            await self._increment_failed_attempts(user)
            raise AuthenticationError("Invalid email or password")
        
        # Step 5: Check account status
        if user.status == 'locked':
            if user.locked_until > datetime.utcnow():
                raise AccountLockedError(
                    message="Account is locked",
                    locked_until=user.locked_until
                )
            else:
                # Auto-unlock after timeout
                await self._unlock_account(user)
        
        if user.status == 'suspended':
            raise AccountSuspendedError("Account is suspended")
        
        # Step 6 & 7: Generate tokens
        token_expiry = timedelta(days=30 if remember_me else 1)
        access_token = self.token_service.create_access_token(
            user_id=user.id,
            role=user.role,
            expires_in=timedelta(hours=1)
        )
        refresh_token = self.token_service.create_refresh_token(
            user_id=user.id,
            expires_in=token_expiry
        )
        
        # Step 8: Store session
        session = Session(
            user_id=user.id,
            refresh_token_hash=self._hash_token(refresh_token),
            expires_at=datetime.utcnow() + token_expiry,
            ip_address=self._get_client_ip(),
            user_agent=self._get_user_agent()
        )
        await self.cache.set(
            f"session:{session.id}",
            session.to_dict(),
            ex=int(token_expiry.total_seconds())
        )
        
        # Step 9: Update user
        await self.user_repo.update(user.id, {
            'last_login_at': datetime.utcnow(),
            'failed_login_attempts': 0,
            'locked_until': None
        })
        
        # Clear rate limit on success
        await self.cache.delete(rate_key)
        
        # Step 10: Return result
        return AuthResult(
            access_token=access_token,
            refresh_token=refresh_token,
            token_type='Bearer',
            expires_in=3600,
            user=user.to_public_dict()
        )
    
    def _verify_password(self, plain: str, hashed: str) -> bool:
        """Verify password using bcrypt with constant-time comparison"""
        return bcrypt.checkpw(plain.encode(), hashed.encode())
    
    async def _increment_failed_attempts(self, user: User):
        """Track failed login and potentially lock account"""
        new_attempts = user.failed_login_attempts + 1
        updates = {'failed_login_attempts': new_attempts}
        
        if new_attempts >= self.config.MAX_FAILED_ATTEMPTS:
            updates['status'] = 'locked'
            updates['locked_until'] = datetime.utcnow() + timedelta(minutes=15)
            
            # Send notification
            await self.notification_service.send_account_locked_email(user)
        
        await self.user_repo.update(user.id, updates)
```

### 7.3. Business Logic Rules

|Rule ID|Description|Formula/Logic|Pseudo Code|
|:--|:--|:--|:--|
|BL-001|Rate limiting|Max 100 req/min per user|`if count > 100: reject`|
|BL-002|Password policy|Min 8 chars, 1 upper, 1 lower, 1 digit, 1 special|`regex.match(pattern)`|
|BL-003|Token expiry|Access: 1h, Refresh: 30d|`exp = now + duration`|
|BL-004|Account lockout|5 failed attempts = 15min lock|`if attempts >= 5: lock(15m)`|

```python
# Business Rules Implementation

class BusinessRules:
    """Centralized business rules with validation"""
    
    # Rule: Password Policy
    PASSWORD_PATTERN = r'^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,128}$'
    
    @staticmethod
    def validate_password(password: str) -> tuple[bool, str]:
        """
        Validate password against security policy
        Returns: (is_valid, error_message)
        """
        if len(password) < 8:
            return False, "Password must be at least 8 characters"
        if len(password) > 128:
            return False, "Password must not exceed 128 characters"
        if not re.match(BusinessRules.PASSWORD_PATTERN, password):
            return False, "Password must contain uppercase, lowercase, number, and special character"
        
        # Check common passwords (optional)
        if password.lower() in COMMON_PASSWORDS:
            return False, "Password is too common"
        
        return True, ""
    
    # Rule: Discount Calculation
    @staticmethod
    def calculate_discount(subtotal: Decimal, items_count: int, user_tier: str) -> Decimal:
        """
        Calculate discount based on business rules
        
        Rules:
        - Base: 0% discount
        - If items >= 10: +10% discount
        - If subtotal >= 1000: +5% discount
        - Tier bonus: Silver +2%, Gold +5%, Platinum +10%
        - Max discount: 25%
        """
        discount_percent = Decimal('0')
        
        # Volume discount
        if items_count >= 10:
            discount_percent += Decimal('10')
        
        # Subtotal discount
        if subtotal >= Decimal('1000'):
            discount_percent += Decimal('5')
        
        # Tier bonus
        tier_bonus = {
            'silver': Decimal('2'),
            'gold': Decimal('5'),
            'platinum': Decimal('10')
        }
        discount_percent += tier_bonus.get(user_tier.lower(), Decimal('0'))
        
        # Cap at 25%
        discount_percent = min(discount_percent, Decimal('25'))
        
        return (subtotal * discount_percent / 100).quantize(Decimal('0.01'))
```

### 7.4. Integration Points

```python
"""
External Service Integration Patterns
"""

class ExternalServiceClient:
    """
    Base class for external API integrations
    Implements: Retry, Timeout, Circuit Breaker
    """
    
    def __init__(self, base_url: str, api_key: str, config: IntegrationConfig):
        self.base_url = base_url
        self.api_key = api_key
        self.config = config
        self.circuit_breaker = CircuitBreaker(
            failure_threshold=config.failure_threshold,  # 5 failures
            recovery_timeout=config.recovery_timeout     # 30 seconds
        )
        self.session = aiohttp.ClientSession(
            timeout=aiohttp.ClientTimeout(total=config.timeout),  # 30 seconds
            headers={
                'Authorization': f'Bearer {api_key}',
                'Content-Type': 'application/json',
                'User-Agent': f'MyService/{VERSION}'
            }
        )
    
    @retry(
        stop=stop_after_attempt(3),
        wait=wait_exponential(multiplier=1, min=1, max=10),
        retry=retry_if_exception_type((TimeoutError, ConnectionError))
    )
    async def _request(self, method: str, endpoint: str, **kwargs) -> dict:
        """
        Make HTTP request with retry and circuit breaker
        
        Retry Strategy:
        - Max attempts: 3
        - Backoff: Exponential (1s, 2s, 4s)
        - Retry on: Timeout, Connection Error, 5xx
        - Don't retry: 4xx (client error)
        """
        if self.circuit_breaker.is_open():
            raise CircuitOpenError("Service temporarily unavailable")
        
        url = f"{self.base_url}{endpoint}"
        
        try:
            async with self.session.request(method, url, **kwargs) as response:
                if response.status >= 500:
                    self.circuit_breaker.record_failure()
                    raise ServerError(f"Server error: {response.status}")
                
                if response.status >= 400:
                    error_body = await response.json()
                    raise ClientError(error_body.get('message', 'Unknown error'))
                
                self.circuit_breaker.record_success()
                return await response.json()
                
        except asyncio.TimeoutError:
            self.circuit_breaker.record_failure()
            raise TimeoutError(f"Request to {endpoint} timed out")


# Example: Payment Service Integration
class StripePaymentClient(ExternalServiceClient):
    """Stripe payment integration"""
    
    async def create_payment_intent(
        self, 
        amount: int,  # cents
        currency: str,
        customer_id: str,
        idempotency_key: str
    ) -> PaymentIntent:
        """
        Create Stripe payment intent
        
        Idempotency: Safe to retry with same idempotency_key
        """
        result = await self._request(
            'POST',
            '/v1/payment_intents',
            json={
                'amount': amount,
                'currency': currency,
                'customer': customer_id,
                'automatic_payment_methods': {'enabled': True}
            },
            headers={
                'Idempotency-Key': idempotency_key
            }
        )
        return PaymentIntent.from_dict(result)
```

### 7.5. Code Organization (Folder Structure)

Xem chi tiáº¿t trong file gá»‘c - Section 7.5 vá»›i cÃ¡c options:

- **Feature-Based:** Recommended cho Microservices
- **Layer-Based:** Traditional Monolith
- **AI/ML-specific:** Data-heavy, experiment-centric

---

## 8. SECURITY & COMPLIANCE

_Báº£o máº­t há»‡ thá»‘ng theo OWASP vÃ  compliance standards_

### 8.1. Authentication & Authorization

#### 8.1.1. Authentication Methods

|Method|Use Case|Implementation|
|:--|:--|:--|
|JWT Bearer|API authentication|RS256 signing, 1h expiry|
|OAuth 2.0|Third-party login|Google, GitHub providers|
|API Key|Service-to-service|HMAC-SHA256 signed|
|Session Cookie|Web browser|HttpOnly, Secure, SameSite=Strict|

#### 8.1.2. Authorization (RBAC)

```yaml
roles:
  admin:
    description: "Full system access"
    permissions:
      - users:read
      - users:write
      - users:delete
      - settings:read
      - settings:write
      - reports:read
      - reports:export
      
  manager:
    description: "Team management access"
    permissions:
      - users:read
      - users:write
      - reports:read
      
  user:
    description: "Standard user access"
    permissions:
      - users:read  # Own profile only
      - settings:read  # Own settings only

# Permission check pseudo code
def check_permission(user, resource, action):
    """
    Check if user has permission for action on resource
    
    1. Get user's role
    2. Get role's permissions
    3. Check if permission matches
    4. For resource-level: check ownership
    """
    role = get_role(user.role)
    required_permission = f"{resource}:{action}"
    
    if required_permission not in role.permissions:
        raise ForbiddenError()
    
    # Resource-level check
    if requires_ownership(resource, action):
        if not is_owner(user, resource):
            raise ForbiddenError()
```

### 8.2. Data Security

|Data Type|At Rest|In Transit|Access Control|
|:--|:--|:--|:--|
|Passwords|bcrypt (cost 12)|TLS 1.3|Never readable|
|PII (email, name)|AES-256-GCM|TLS 1.3|Role-based|
|Session tokens|SHA-256 hash|TLS 1.3|User only|
|API keys|SHA-256 hash|TLS 1.3|Service owner|
|Financial data|AES-256-GCM|TLS 1.3|PCI-DSS compliant|

```python
# Secret Management
import os
from cryptography.fernet import Fernet

class SecretManager:
    """
    Centralized secret management
    Production: Use AWS Secrets Manager / HashiCorp Vault
    """
    
    def __init__(self):
        # In production, fetch from vault
        self.encryption_key = os.environ['ENCRYPTION_KEY']
        self.cipher = Fernet(self.encryption_key)
    
    def encrypt(self, plaintext: str) -> str:
        """Encrypt sensitive data"""
        return self.cipher.encrypt(plaintext.encode()).decode()
    
    def decrypt(self, ciphertext: str) -> str:
        """Decrypt sensitive data"""
        return self.cipher.decrypt(ciphertext.encode()).decode()
```

### 8.3. API Security

#### 8.3.1. Input Validation

```python
from pydantic import BaseModel, validator, EmailStr
import re

class CreateUserRequest(BaseModel):
    email: EmailStr
    password: str
    name: str
    
    @validator('password')
    def validate_password(cls, v):
        if len(v) < 8:
            raise ValueError('Password must be at least 8 characters')
        if not re.search(r'[A-Z]', v):
            raise ValueError('Password must contain uppercase')
        if not re.search(r'[a-z]', v):
            raise ValueError('Password must contain lowercase')
        if not re.search(r'\d', v):
            raise ValueError('Password must contain digit')
        return v
    
    @validator('name')
    def sanitize_name(cls, v):
        # Remove potential XSS
        import html
        return html.escape(v.strip())
```

#### 8.3.2. Rate Limiting

```python
# Rate Limit Configuration
RATE_LIMITS = {
    'default': {'requests': 100, 'window': 60},        # 100/min
    'auth': {'requests': 5, 'window': 900},            # 5/15min
    'api': {'requests': 1000, 'window': 3600},         # 1000/hour
    'upload': {'requests': 10, 'window': 3600},        # 10/hour
}

# Sliding Window Implementation
async def check_rate_limit(key: str, limit_type: str = 'default') -> bool:
    config = RATE_LIMITS[limit_type]
    current_window = int(time.time() // config['window'])
    cache_key = f"ratelimit:{key}:{current_window}"
    
    count = await redis.incr(cache_key)
    if count == 1:
        await redis.expire(cache_key, config['window'] * 2)
    
    return count <= config['requests']
```

### 8.4. Compliance Checklist

|Regulation|Requirement|Implementation|Status|
|:--|:--|:--|:--|
|**GDPR**|Data minimization|Collect only needed data|âœ…|
|**GDPR**|Right to access|Export user data API|âœ…|
|**GDPR**|Right to erasure|Delete user data API|âœ…|
|**GDPR**|Data portability|JSON/CSV export|âœ…|
|**PCI-DSS**|No PII in logs|Log masking|âœ…|
|**PCI-DSS**|Encryption at rest|AES-256|âœ…|
|**SOC2**|Audit logging|Comprehensive logs|âœ…|
|**SOC2**|Access controls|RBAC implemented|âœ…|

### 8.5. Threat Model (STRIDE)

|Threat|Description|Mitigation|
|:--|:--|:--|
|**S**poofing|Fake identity|JWT validation, MFA|
|**T**ampering|Data modification|Input validation, checksums|
|**R**epudiation|Deny actions|Audit logging, signatures|
|**I**nformation Disclosure|Data leak|Encryption, access control|
|**D**enial of Service|Overload system|Rate limiting, CDN|
|**E**levation of Privilege|Gain unauthorized access|RBAC, principle of least privilege|

---

## 9. NON-FUNCTIONAL REQUIREMENTS (NFR)

_Performance, Scalability, Reliability targets_

### 9.1. Performance Targets

|Metric|Current|Target|Measurement|
|:--|:--|:--|:--|
|p50 Latency|200ms|50ms|Datadog APM|
|p95 Latency|800ms|200ms|Datadog APM|
|p99 Latency|2000ms|500ms|Datadog APM|
|Throughput|100 rps|1000 rps|Load test|
|Error Rate|2%|0.1%|Prometheus|
|Time to First Byte|500ms|100ms|RUM|

### 9.2. Scalability

```yaml
# Kubernetes HPA Configuration
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: api-service-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: api-service
  minReplicas: 3
  maxReplicas: 50
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
    - type: Pods
      pods:
        metric:
          name: requests_per_second
        target:
          type: AverageValue
          averageValue: "100"
```

### 9.3. Reliability & Availability

|Metric|Target|Meaning|
|:--|:--|:--|
|Uptime SLA|99.9%|Max 8.76h downtime/year|
|RTO|< 1 hour|Recovery Time Objective|
|RPO|< 15 minutes|Recovery Point Objective|
|MTBF|> 720 hours|Mean Time Between Failures|
|MTTR|< 30 minutes|Mean Time To Repair|

### 9.4. Capacity Planning

|Resource|Current Usage|Growth Rate|6-Month Projection|
|:--|:--|:--|:--|
|Users|10,000|20%/month|30,000|
|Requests/day|1M|15%/month|2.3M|
|Database size|50GB|10GB/month|110GB|
|Storage (S3)|200GB|50GB/month|500GB|
|Monthly cost|$5,000|10%/month|$8,000|

---

## 10. OBSERVABILITY (Logs/Metrics/Traces)

_GiÃ¡m sÃ¡t vÃ  debugging theo Golden Signals_

### 10.1. Logging Strategy

```python
# Structured Logging Configuration
import structlog

structlog.configure(
    processors=[
        structlog.contextvars.merge_contextvars,
        structlog.processors.add_log_level,
        structlog.processors.TimeStamper(fmt="iso"),
        structlog.processors.JSONRenderer()
    ],
    wrapper_class=structlog.make_filtering_bound_logger(logging.INFO),
)

# Usage
logger = structlog.get_logger()

# Good: Structured logging with context
logger.info(
    "user_login_success",
    user_id=user.id,
    email_masked=mask_email(user.email),
    ip_address=request.client.host,
    user_agent=request.headers.get("user-agent"),
    duration_ms=elapsed_ms
)

# Log Levels
# DEBUG: Detailed debugging (dev only)
# INFO: Business events (user actions, API calls)
# WARNING: Unexpected but handled situations
# ERROR: Errors that affect user experience
# CRITICAL: System-wide failures
```

### 10.2. Metrics (Golden Signals)

```yaml
# Prometheus Metrics Definition
metrics:
  # Latency
  - name: http_request_duration_seconds
    type: histogram
    labels: [method, endpoint, status_code]
    buckets: [0.01, 0.05, 0.1, 0.25, 0.5, 1.0, 2.5, 5.0, 10.0]
    
  # Traffic
  - name: http_requests_total
    type: counter
    labels: [method, endpoint, status_code]
    
  # Errors
  - name: http_errors_total
    type: counter
    labels: [method, endpoint, error_type]
    
  # Saturation
  - name: system_cpu_usage_percent
    type: gauge
  - name: system_memory_usage_bytes
    type: gauge
  - name: database_connections_active
    type: gauge
  - name: queue_depth
    type: gauge
```

### 10.3. Distributed Tracing

```python
# OpenTelemetry Setup
from opentelemetry import trace
from opentelemetry.exporter.otlp.proto.grpc.trace_exporter import OTLPSpanExporter
from opentelemetry.sdk.trace import TracerProvider
from opentelemetry.sdk.trace.export import BatchSpanProcessor

# Configure tracer
trace.set_tracer_provider(TracerProvider())
tracer = trace.get_tracer(__name__)
otlp_exporter = OTLPSpanExporter(endpoint="http://jaeger:4317")
trace.get_tracer_provider().add_span_processor(
    BatchSpanProcessor(otlp_exporter)
)

# Usage in code
with tracer.start_as_current_span("process_payment") as span:
    span.set_attribute("user_id", user_id)
    span.set_attribute("amount", amount)
    
    try:
        result = await payment_service.charge(user_id, amount)
        span.set_attribute("payment_id", result.id)
    except PaymentError as e:
        span.set_status(Status(StatusCode.ERROR))
        span.record_exception(e)
        raise
```

### 10.4. Alerting Rules

```yaml
# Prometheus Alert Rules
groups:
  - name: api-alerts
    rules:
      - alert: HighErrorRate
        expr: |
          sum(rate(http_errors_total[5m])) 
          / sum(rate(http_requests_total[5m])) > 0.01
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "High error rate detected"
          description: "Error rate is {{ $value | printf \"%.2f\" }}%"
          
      - alert: HighLatency
        expr: |
          histogram_quantile(0.95, 
            sum(rate(http_request_duration_seconds_bucket[5m])) 
            by (le, endpoint)
          ) > 0.5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "High p95 latency on {{ $labels.endpoint }}"
          
      - alert: ServiceDown
        expr: up{job="api-service"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Service {{ $labels.instance }} is down"
```

---

## 11. FAILURE MODES & RESILIENCE

_Xá»­ lÃ½ lá»—i vÃ  khÃ´i phá»¥c theo Netflix patterns_

### 11.1. Failure Mode Analysis (FMEA)

|ID|Failure Mode|Probability|Impact|RPN|Mitigation|
|:--|:--|:--|:--|:--|:--|
|F1|Database connection lost|Medium|Critical|12|Connection pooling, retry, replica failover|
|F2|Redis unavailable|Low|High|8|Local cache fallback, circuit breaker|
|F3|External API timeout|Medium|Medium|9|Retry with backoff, fallback response|
|F4|Out of memory|Low|Critical|10|Memory limits, graceful degradation|
|F5|Disk full|Low|High|6|Monitoring, auto-cleanup, alerts|

_RPN = Risk Priority Number (Probability Ã— Impact Ã— Detection)_

### 11.2. Retry Strategy

```python
from tenacity import retry, stop_after_attempt, wait_exponential, retry_if_exception_type

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=1, max=10),
    retry=retry_if_exception_type((TimeoutError, ConnectionError)),
    before_sleep=lambda retry_state: logger.warning(
        f"Retry {retry_state.attempt_number} after error"
    )
)
async def fetch_external_data(url: str):
    """
    Retry Strategy:
    - Attempt 1: Immediate
    - Attempt 2: Wait 1-2 seconds
    - Attempt 3: Wait 2-4 seconds (max 10s)
    - After 3 failures: Raise exception
    
    Idempotency: Ensure operation is safe to retry
    """
    async with aiohttp.ClientSession() as session:
        async with session.get(url, timeout=10) as response:
            return await response.json()
```

### 11.3. Circuit Breaker Pattern

```python
from circuitbreaker import circuit

class CircuitBreakerConfig:
    FAILURE_THRESHOLD = 5      # Open after 5 failures
    RECOVERY_TIMEOUT = 30      # Try again after 30 seconds
    EXPECTED_EXCEPTIONS = (TimeoutError, ConnectionError)

@circuit(
    failure_threshold=CircuitBreakerConfig.FAILURE_THRESHOLD,
    recovery_timeout=CircuitBreakerConfig.RECOVERY_TIMEOUT,
    expected_exception=CircuitBreakerConfig.EXPECTED_EXCEPTIONS
)
async def call_external_service(payload: dict):
    """
    Circuit States:
    - CLOSED: Normal operation, requests pass through
    - OPEN: Fail fast, no requests sent (after threshold failures)
    - HALF-OPEN: Test with single request after recovery timeout
    
    Transition:
    CLOSED --[5 failures]--> OPEN --[30s]--> HALF-OPEN
    HALF-OPEN --[success]--> CLOSED
    HALF-OPEN --[failure]--> OPEN
    """
    return await external_api.call(payload)
```

### 11.4. Graceful Degradation

```python
class FeatureFlags:
    """Feature flags for graceful degradation"""
    
    ENABLE_RECOMMENDATIONS = True
    ENABLE_REAL_TIME_ANALYTICS = True
    ENABLE_THIRD_PARTY_ENRICHMENT = True

async def get_user_dashboard(user_id: str):
    """
    Graceful degradation strategy:
    1. Core data: Always return (fail if unavailable)
    2. Enhanced data: Return cached/default if unavailable
    3. Optional data: Skip if unavailable
    """
    
    # Core: Must succeed
    user = await user_service.get(user_id)
    
    # Enhanced: Use cache fallback
    try:
        if FeatureFlags.ENABLE_RECOMMENDATIONS:
            recommendations = await recommendation_service.get(user_id)
        else:
            recommendations = []
    except ServiceUnavailableError:
        recommendations = await cache.get(f"recommendations:{user_id}") or []
        logger.warning("Falling back to cached recommendations")
    
    # Optional: Skip gracefully
    analytics = {}
    if FeatureFlags.ENABLE_REAL_TIME_ANALYTICS:
        try:
            analytics = await analytics_service.get(user_id)
        except Exception as e:
            logger.info(f"Skipping analytics: {e}")
    
    return {
        "user": user,
        "recommendations": recommendations,
        "analytics": analytics
    }
```

### 11.5. Timeout Configuration

|Operation|Connect Timeout|Read Timeout|Total Timeout|
|:--|:--|:--|:--|
|Database query|5s|30s|35s|
|External API|5s|30s|60s|
|Cache (Redis)|1s|5s|6s|
|File upload|10s|300s|310s|
|Background job|N/A|N/A|3600s|

---

## 12. TESTING STRATEGY

_Chiáº¿n lÆ°á»£c Ä‘áº£m báº£o cháº¥t lÆ°á»£ng theo Test Pyramid_

### 12.1. Test Pyramid

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   /â”‚   E2E     â”‚\     5%  - Critical flows only
                  / â”‚  (Cypress) â”‚ \
                 /  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  \
                /   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   \
               /    â”‚Integrationâ”‚    \   20% - API contracts, DB
              /     â”‚ (pytest)  â”‚     \
             /      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      \
            /       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       \
           /        â”‚   Unit    â”‚        \  75% - Business logic
          /         â”‚ (pytest)  â”‚         \
         /          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          \
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 12.2. Test Categories & Coverage

|Category|Target Coverage|Framework|Run Frequency|
|:--|:--|:--|:--|
|Unit Tests|80%+|pytest, Jest|Every commit|
|Integration Tests|60%+|pytest, Postman|Every PR|
|E2E Tests|Critical paths|Cypress, Playwright|Nightly|
|Performance Tests|Key endpoints|k6, Locust|Weekly|
|Security Tests|OWASP Top 10|OWASP ZAP|Monthly|

### 12.3. Sample Test Cases

```python
# Unit Test Example
import pytest
from unittest.mock import AsyncMock, patch
from services.auth_service import AuthService

class TestAuthService:
    @pytest.fixture
    def auth_service(self):
        return AuthService(
            user_repo=AsyncMock(),
            token_service=AsyncMock(),
            cache=AsyncMock()
        )
    
    @pytest.mark.asyncio
    async def test_login_success(self, auth_service):
        """Test successful login returns tokens"""
        # Arrange
        auth_service.user_repo.find_by_email.return_value = User(
            id="123",
            email="test@example.com",
            password_hash=bcrypt.hashpw(b"password123", bcrypt.gensalt()).decode(),
            status="active"
        )
        auth_service.token_service.create_access_token.return_value = "access_token"
        auth_service.token_service.create_refresh_token.return_value = "refresh_token"
        
        # Act
        result = await auth_service.login("test@example.com", "password123")
        
        # Assert
        assert result.access_token == "access_token"
        assert result.refresh_token == "refresh_token"
        auth_service.user_repo.find_by_email.assert_called_once_with("test@example.com")
    
    @pytest.mark.asyncio
    async def test_login_invalid_password_returns_error(self, auth_service):
        """Test login with wrong password raises AuthenticationError"""
        # Arrange
        auth_service.user_repo.find_by_email.return_value = User(
            id="123",
            email="test@example.com",
            password_hash=bcrypt.hashpw(b"correct_password", bcrypt.gensalt()).decode()
        )
        
        # Act & Assert
        with pytest.raises(AuthenticationError) as exc_info:
            await auth_service.login("test@example.com", "wrong_password")
        
        assert "Invalid email or password" in str(exc_info.value)
    
    @pytest.mark.asyncio
    async def test_login_rate_limited_after_5_attempts(self, auth_service):
        """Test rate limiting after 5 failed attempts"""
        # Arrange
        auth_service.cache.incr.return_value = 6
        auth_service.cache.ttl.return_value = 600
        
        # Act & Assert
        with pytest.raises(RateLimitError) as exc_info:
            await auth_service.login("test@example.com", "password")
        
        assert exc_info.value.retry_after == 600
```

### 12.4. Performance Test Script

```javascript
// k6 Load Test Script
import http from 'k6/http';
import { check, sleep } from 'k6';
import { Rate } from 'k6/metrics';

export const errorRate = new Rate('errors');

export const options = {
  stages: [
    { duration: '2m', target: 100 },   // Ramp up
    { duration: '5m', target: 100 },   // Steady state
    { duration: '2m', target: 200 },   // Peak
    { duration: '2m', target: 0 },     // Ramp down
  ],
  thresholds: {
    http_req_duration: ['p(95)<200'],  // p95 < 200ms
    errors: ['rate<0.01'],              // Error rate < 1%
  },
};

export default function () {
  const payload = JSON.stringify({
    email: `user${__VU}@example.com`,
    password: 'testpassword123',
  });

  const params = {
    headers: { 'Content-Type': 'application/json' },
  };

  const res = http.post('http://api.example.com/v1/auth/login', payload, params);

  check(res, {
    'status is 200': (r) => r.status === 200,
    'response time < 200ms': (r) => r.timings.duration < 200,
  });

  errorRate.add(res.status !== 200);
  sleep(1);
}
```

### 12.5. Acceptance Criteria (Definition of Done)

```markdown
## Definition of Done Checklist

### Code Quality
- [ ] All unit tests pass (coverage â‰¥ 80%)
- [ ] All integration tests pass
- [ ] No linting errors (ESLint/Pylint)
- [ ] No type errors (TypeScript/mypy)
- [ ] Code reviewed and approved by 2 engineers

### Security
- [ ] Security scan clean (Snyk/Sonar)
- [ ] No hardcoded secrets
- [ ] Input validation implemented
- [ ] Authorization checks in place

### Documentation
- [ ] API documentation updated (OpenAPI)
- [ ] README updated if needed
- [ ] ADR created for significant decisions
- [ ] Changelog entry added

### Deployment
- [ ] Feature flag configured
- [ ] Rollback plan documented
- [ ] Monitoring dashboards updated
- [ ] Alerts configured
```

---

## 13. DEPLOYMENT & OPERATIONS

_Triá»ƒn khai vÃ  váº­n hÃ nh_

### 13.1. Deployment Strategy

|Strategy|Use Case|Rollback Time|Risk|
|:--|:--|:--|:--|
|**Blue-Green**|Major releases|Instant|Low|
|**Canary**|Feature releases|Minutes|Low|
|**Rolling**|Minor updates|Minutes|Medium|
|**Recreate**|Breaking changes|Depends|High|

### 13.2. CI/CD Pipeline

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  # Stage 1: Build & Test
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: pip install -r requirements.txt
      
      - name: Run linting
        run: |
          pylint src/
          mypy src/
      
      - name: Run tests
        run: |
          pytest tests/ --cov=src --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3

  # Stage 2: Security Scan
  security:
    runs-on: ubuntu-latest
    needs: test
    steps:
      - uses: actions/checkout@v4
      
      - name: Run Snyk
        uses: snyk/actions/python@master
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      
      - name: Run Trivy
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: 'myapp:${{ github.sha }}'

  # Stage 3: Build & Push
  build:
    runs-on: ubuntu-latest
    needs: [test, security]
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4
      
      - name: Build Docker image
        run: |
          docker build -t myapp:${{ github.sha }} .
          docker tag myapp:${{ github.sha }} myapp:latest
      
      - name: Push to ECR
        run: |
          aws ecr get-login-password | docker login --username AWS --password-stdin $ECR_REGISTRY
          docker push $ECR_REGISTRY/myapp:${{ github.sha }}

  # Stage 4: Deploy
  deploy-staging:
    runs-on: ubuntu-latest
    needs: build
    environment: staging
    steps:
      - name: Deploy to Staging
        run: |
          kubectl set image deployment/api api=$ECR_REGISTRY/myapp:${{ github.sha }}
          kubectl rollout status deployment/api --timeout=5m

  deploy-production:
    runs-on: ubuntu-latest
    needs: deploy-staging
    environment: production
    steps:
      - name: Deploy to Production (Canary)
        run: |
          # Deploy to 10% of pods
          kubectl set image deployment/api-canary api=$ECR_REGISTRY/myapp:${{ github.sha }}
          
          # Monitor for 10 minutes
          sleep 600
          
          # Check error rate
          ERROR_RATE=$(curl -s "http://prometheus/api/v1/query?query=error_rate" | jq '.data.result[0].value[1]')
          if [ $(echo "$ERROR_RATE > 0.01" | bc) -eq 1 ]; then
            echo "Error rate too high, rolling back"
            kubectl rollout undo deployment/api-canary
            exit 1
          fi
          
          # Full rollout
          kubectl set image deployment/api api=$ECR_REGISTRY/myapp:${{ github.sha }}
```

### 13.3. Infrastructure as Code

```hcl
# terraform/main.tf
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
  }
  
  backend "s3" {
    bucket = "terraform-state-bucket"
    key    = "prod/terraform.tfstate"
    region = "ap-southeast-1"
  }
}

# EKS Cluster
module "eks" {
  source          = "terraform-aws-modules/eks/aws"
  cluster_name    = "production-cluster"
  cluster_version = "1.28"
  
  vpc_id     = module.vpc.vpc_id
  subnet_ids = module.vpc.private_subnets
  
  eks_managed_node_groups = {
    general = {
      min_size     = 3
      max_size     = 10
      desired_size = 5
      
      instance_types = ["t3.medium"]
      capacity_type  = "ON_DEMAND"
    }
  }
}

# RDS PostgreSQL
module "rds" {
  source = "terraform-aws-modules/rds/aws"
  
  identifier = "production-db"
  engine     = "postgres"
  engine_version = "15.4"
  
  instance_class = "db.r6g.large"
  allocated_storage = 100
  
  multi_az = true
  
  backup_retention_period = 7
  backup_window = "03:00-04:00"
  maintenance_window = "Mon:04:00-Mon:05:00"
}
```

### 13.4. Runbooks

```markdown
## Runbook: Service Restart

### When to Use
- Service not responding to health checks
- Memory usage > 90% for extended period

### Steps
1. Check current status:
   ```bash
   kubectl get pods -n production -l app=api
```

2. Check logs for errors:
    
    ```bash
    kubectl logs -n production -l app=api --tail=100
    ```
    
3. Restart pods (rolling):
    
    ```bash
    kubectl rollout restart deployment/api -n production
    ```
    
4. Monitor rollout:
    
    ```bash
    kubectl rollout status deployment/api -n production
    ```
    
5. Verify health:
    
    ```bash
    curl -s https://api.example.com/health | jq
    ```
    

### Escalation

If service doesn't recover within 15 minutes:

1. Page on-call engineer
2. Prepare rollback: `kubectl rollout undo deployment/api`

````

### 13.5. Disaster Recovery Plan

| Component | Backup Frequency | Retention | Recovery Procedure |
|:----------|:-----------------|:----------|:-------------------|
| Database | Daily full, hourly WAL | 30 days | Point-in-time recovery |
| Redis | Hourly RDB | 7 days | Restore from snapshot |
| S3 | Real-time replication | Indefinite | Cross-region failover |
| Secrets | On change | 30 versions | Restore from Vault |

---

## 14. TRADE-OFFS & ALTERNATIVES

*"Design is about trade-offs" - Every decision has consequences*

### 14.1. Key Design Decisions

#### ADR-001: Use PostgreSQL over MongoDB

```markdown
# ADR-001: Database Selection

## Status
Accepted

## Context
Need to select primary database for user data and transactions.

## Decision
Use PostgreSQL instead of MongoDB.

## Rationale
- Strong ACID guarantees required for financial transactions
- Complex relational queries (JOINs) common in our use cases
- Team has more PostgreSQL experience
- Better tooling for migrations (Alembic)

## Consequences
### Positive
- Data integrity guaranteed
- Mature ecosystem
- Cost-effective (can use RDS)

### Negative
- Less flexible schema (need migrations)
- Vertical scaling initially (shard later if needed)
- NoSQL patterns need workarounds (JSONB)

## Alternatives Considered
| Option | Pros | Cons | Why Rejected |
|--------|------|------|--------------|
| MongoDB | Flexible schema, horizontal scaling | Eventual consistency | ACID needed |
| CockroachDB | Distributed SQL | Operational complexity | Overkill for current scale |
````

### 14.2. Trade-off Analysis Matrix

|Decision|Option A|Option B|Chosen|Reason|
|:--|:--|:--|:--|:--|
|Cache Strategy|Write-through|Write-behind|Write-through|Consistency > Performance|
|API Style|REST|GraphQL|REST|Simpler, team familiar|
|Auth Tokens|Session|JWT|JWT|Stateless, scale better|
|Message Queue|RabbitMQ|Kafka|RabbitMQ|Simpler ops, sufficient throughput|

---

## 15. GLOSSARY & REFERENCES

### 15.1. Glossary

|Term|Definition|
|:--|:--|
|ADR|Architecture Decision Record - Document capturing design decisions|
|CQRS|Command Query Responsibility Segregation|
|DDD|Domain-Driven Design|
|FMEA|Failure Mode and Effects Analysis|
|HPA|Horizontal Pod Autoscaler (Kubernetes)|
|MTBF|Mean Time Between Failures|
|MTTR|Mean Time To Repair|
|RTO|Recovery Time Objective|
|RPO|Recovery Point Objective|
|SLA|Service Level Agreement|
|SLO|Service Level Objective|

### 15.2. References

- [Google Design Docs](https://www.industrialempathy.com/posts/design-docs-at-google/)
- [AWS Well-Architected Framework](https://aws.amazon.com/architecture/well-architected/)
- [C4 Model](https://c4model.com/)
- [OWASP Top 10](https://owasp.org/Top10/)
- [Google SRE Book](https://sre.google/sre-book/table-of-contents/)
- [ADR Templates](https://github.com/joelparkerhenderson/architecture-decision-record)

---

## 16. APPENDICES

### 16.1. Configuration Templates

```bash
# .env.example
# Application
APP_ENV=development
APP_DEBUG=true
APP_PORT=8000
APP_SECRET_KEY=your-secret-key-here

# Database
DATABASE_URL=postgresql://user:pass@localhost:5432/dbname
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# Redis
REDIS_URL=redis://localhost:6379/0

# External Services
STRIPE_API_KEY=sk_test_xxx
SENDGRID_API_KEY=SG.xxx

# Observability
DATADOG_API_KEY=xxx
SENTRY_DSN=https://xxx@sentry.io/xxx
```

### 16.2. Kubernetes Manifests

```yaml
# kubernetes/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-service
  labels:
    app: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: api
  template:
    metadata:
      labels:
        app: api
    spec:
      containers:
        - name: api
          image: myapp:latest
          ports:
            - containerPort: 8000
          resources:
            requests:
              cpu: "250m"
              memory: "512Mi"
            limits:
              cpu: "1000m"
              memory: "1Gi"
          livenessProbe:
            httpGet:
              path: /health
              port: 8000
            initialDelaySeconds: 30
            periodSeconds: 10
          readinessProbe:
            httpGet:
              path: /ready
              port: 8000
            initialDelaySeconds: 5
            periodSeconds: 5
          envFrom:
            - configMapRef:
                name: api-config
            - secretRef:
                name: api-secrets
```

---

## 17. CHANGE LOG

````markdown
## [3.1.0] - 2025-01-15
### Added
- Comprehensive pseudo code examples for all modules
- FMEA risk analysis table
- Kubernetes HPA configuration
- k6 load test scripts

### Changed
- Updated API versioning strategy
- Improved error handling standards
- Enhanced security section with STRIDE model

### Deprecated
- Legacy session-based auth (to be removed in v4.0)

## [3.0.0] - 2025-01-10
### Added
- Initial Universal Pro template
- Multi-domain support (BE, FE, AI/ML)
- C4 Model architecture diagrams

---

## ğŸ¯ COMPLETION CHECKLIST

```markdown
âœ… Metadata: Title, Author, Status, Version, Related Docs
âœ… 1. Overview: Problem + Solution + Impact (< 1 page)
âœ… 2. Goals/Scope: In-scope, Out-of-scope, Assumptions, Constraints, Dependencies
âœ… 3. User Stories: Primary stories vá»›i Acceptance Criteria + Flow diagrams
âœ… 4. API Contract: Full Request/Response specs, Error codes, Versioning
âœ… 5. Data Model: ERD + Schema SQL + Indexing + Caching + Retention
âœ… 6. Architecture: C4 Diagrams + Sequence diagrams + State machines
âœ… 7. Implementation: Per-module specs + Pseudo code + Business rules
âœ… 8. Security: AuthN/AuthZ + Encryption + Compliance + Threat model
âœ… 9. NFR: Latency/Throughput/SLA targets + Capacity planning
âœ… 10. Observability: Logging/Metrics/Tracing + Alerting rules
âœ… 11. Failure Modes: FMEA + Retry + Circuit breaker + Degradation
âœ… 12. Testing: Test pyramid + Sample tests + Performance tests + DoD
âœ… 13. Deployment: CI/CD + IaC + Runbooks + DR plan
âœ… 14. Trade-offs: ADRs + Decision matrix
âœ… 15. Glossary: Terms + References
âœ… 16. Appendices: Config templates + K8s manifests
âœ… 17. Change Log: Version history
````

---

<div align="center">

**â‚**

_Template nÃ y tá»•ng há»£p best practices tá»«: Google, AWS, Microsoft Azure, Meta, Abnormal AI, Stripe_

**Version 3.1 - Universal Pro Edition**

</div>


---
ÄÃ¢y lÃ  má»™t template ráº¥t toÃ n diá»‡n tÃªn lÃ  **"TECHNICAL DEEP-DIVE SPECIFICATION (TDD) v3.1"**. So sÃ¡nh chi tiáº¿t nÃ³ vá»›i chuáº©n **IEEE 1016 Software Design Document**:

## ğŸ“Š So sÃ¡nh: TDD Template vs IEEE 1016 SDD Chuáº©n

## âœ… Äiá»ƒm máº¡nh cá»§a TDD template

|KhÃ­a cáº¡nh|ÄÃ¡nh giÃ¡|Ghi chÃº|
|---|---|---|
|**Metadata**|â­â­â­â­â­|Chi tiáº¿t: title, author, reviewers, status, version semantic|
|**Overview**|â­â­â­â­â­|Executive summary, background, alternatives considered|
|**Scope Definition**|â­â­â­â­â­|RÃµ rÃ ng: Goals, In-scope, Out-of-scope, Assumptions, Constraints|
|**User Stories & Use Cases**|â­â­â­â­â­|Gherkin format, acceptance criteria, flow diagrams|
|**API Contract**|â­â­â­â­â­|Chi tiáº¿t: request/response, error codes, versioning strategy|
|**Data Model**|â­â­â­â­â­|ERD, SQL schema, indexing strategy, caching, retention policy|
|**Architecture**|â­â­â­â­â­|C4 Model (Level 1-3), sequence diagrams, state machines|
|**Implementation**|â­â­â­â­â­|Pseudo code chi tiáº¿t, business logic rules, integration patterns|
|**Security**|â­â­â­â­â­|AuthN/AuthZ, encryption, compliance, threat model (STRIDE)|
|**NFR**|â­â­â­â­â­|Performance targets, scalability, reliability, capacity planning|
|**Observability**|â­â­â­â­â­|Logging, metrics (Prometheus), tracing, alerting rules|
|**Testing**|â­â­â­â­â­|Test pyramid, sample test code, performance tests, DoD|
|**Deployment**|â­â­â­â­â­|CI/CD pipeline (GitHub Actions), IaC (Terraform), runbooks|
|**Trade-offs**|â­â­â­â­â­|ADRs, decision matrix vá»›i alternatives|

## âŒ Thiáº¿t sÃ³t so vá»›i IEEE 1016

|IEEE 1016 Section|Template TDD|TÃ¬nh tráº¡ng|
|---|---|---|
|**Requirements Traceability Matrix**|âŒ KhÃ´ng cÃ³|CRITICAL MISSING - Map requirement â†’ HLD â†’ LLD â†’ Test|
|**Interface Specifications (UI)**|âš ï¸ CÃ³ nhÆ°ng khÃ´ng Ä‘áº§y Ä‘á»§|Wireframes/mockups only mentioned for FE, khÃ´ng detail|
|**Data Dictionary**|âš ï¸ CÃ³ Schema nhÆ°ng sÆ¡|Cáº§n thÃªm detailed field definitions cho má»—i table|
|**Component Interaction Diagrams**|âš ï¸ CÃ³ sequence nhÆ°ng chá»‰ key flows|Thiáº¿u chi tiáº¿t hÃ³a cho táº¥t cáº£ components|
|**Class/Module Diagrams (UML)**|âŒ Chá»‰ cÃ³ code structure, khÃ´ng UML|Thiáº¿u class diagram, inheritance, composition|
|**Processing Pipeline Detail**|âš ï¸ CÃ³ (Section 7.1)|Tá»‘t nhÆ°ng cÃ³ thá»ƒ visualize hÆ¡n|
|**Design Rationale**|âœ… CÃ³ (Section 14)|Tá»‘t - ADR format, trade-off analysis|
|**Appendix (config, K8s manifests)**|âœ… CÃ³|Tá»‘t - thá»±c táº¿|

## ğŸ¯ Má»©c Ä‘á»™ tuÃ¢n thá»§ IEEE 1016

text

`IEEE 1016 Compliance Score: 85/100 âœ… CÃ³ Ä‘á»§ (85%) â”œâ”€â”€ Overview & Context â”œâ”€â”€ Goals/Scope/Constraints â”œâ”€â”€ Data Model & Storage â”œâ”€â”€ Architecture â”œâ”€â”€ Implementation Details â”œâ”€â”€ Security & Compliance â”œâ”€â”€ Testing â”œâ”€â”€ Deployment â””â”€â”€ Trade-offs & Decisions âŒ Thiáº¿u (15%) â”œâ”€â”€ Requirements Traceability Matrix (CRITICAL) â”œâ”€â”€ Detailed Component Interaction (táº¥t cáº£ flows) â”œâ”€â”€ UML Class Diagrams â””â”€â”€ Interface Definition (UI/UX detail)`

## ğŸ“‹ Cáº¥u trÃºc so sÃ¡nh chi tiáº¿t

## Section-by-Section Comparison

|IEEE 1016 Section|TDD Template Section|Fullness|Quality|
|---|---|---|---|
|**1. Introduction**|Metadata + Overview|95%|â­â­â­â­â­|
|**2. System Overview**|Section 1 + 6.1|90%|â­â­â­â­â­|
|**3. System Architecture**|Section 6 (C4 Model)|100%|â­â­â­â­â­|
|**4. Data Design**|Section 5 (ERD, Schema, Caching)|85%|â­â­â­â­|
|**5. Component/Module Design**|Section 7 (Implementation)|80%|â­â­â­â­|
|**6. Interface Design**|Section 4 (API) + Section 3 (User Stories)|75%|â­â­â­â­|
|**7. Human Interface Design**|Section 3 (Wireframes noted) + Appendix|50%|â­â­â­|
|**8. Requirements Traceability**|âŒ MISSING|0%|âŒ|
|**9. Design Rationale**|Section 14 (Trade-offs & ADRs)|100%|â­â­â­â­â­|
|**10. Testing Strategy**|Section 12|90%|â­â­â­â­â­|
|**11. Appendices**|Section 16|95%|â­â­â­â­â­|

## ğŸ”¥ Äiá»ƒm khÃ¡c biá»‡t chÃ­nh

## TDD Template CÃ“ nhÆ°ng IEEE 1016 KHÃ”NG

1. **User Stories in Gherkin format** (ráº¥t hay)paste.txtâ€‹
    
2. **Business Rules Engine** (Section 7.3)paste.txtâ€‹
    
3. **Failure Mode Analysis (FMEA)** (Section 11)paste.txtâ€‹
    
4. **Observability (Logging/Metrics/Tracing)** (Section 10)paste.txtâ€‹
    
5. **Golden Signals** vÃ  **Prometheus configuration**paste.txtâ€‹
    
6. **Runbooks & Disaster Recovery Plan** (Section 13.5)paste.txtâ€‹
    
7. **Performance Test Scripts (k6)** (Section 12.4)paste.txtâ€‹
    
8. **IaC Template (Terraform)** (Section 13.3)paste.txtâ€‹
    
9. **Definition of Done Checklist** (Section 12.5)paste.txtâ€‹
    
10. **Domain-Specific Additions** (FE, AI/ML)paste.txtâ€‹
    

## IEEE 1016 CÃ“ nhÆ°ng TDD Template KHÃ”NG

1. **Requirements Traceability Matrix** [file:130 thiáº¿u]
    
2. **Detailed UML Class Diagrams** [file:130 chá»‰ code structure]
    
3. **Formal Interface Specifications** (UI Elements, Events) [file:130 sÆ¡]
    
4. **Design Pattern Catalog** [file:130 implicit qua examples]
    
5. **Data Type Definitions** (chi tiáº¿t cho má»—i field) [file:130 incomplete]
    

## ğŸ’¡ Káº¿t luáº­n

## TDD v3.1 Template lÃ :

âœ… **Tá»‘t cho**: Backend/AI/ML systems, microservices architecture, production-ready design documents  
âœ… **PhÃ¹ há»£p vá»›i**: DevOps, CI/CD, observability-first mindset  
âœ… **Thá»±c táº¿ hÆ¡n**: CÃ³ CI/CD, IaC, runbooks, testing code samples  
âœ… **Comprehensive**: Bao trÃ¹m cáº£ deployment & operations (IEEE 1016 khÃ´ng cover)

âŒ **Thiáº¿u**: Requirements traceability (quan trá»ng cho formal projects)  
âŒ **Thiáº¿u**: UML diagrams (quan trá»ng cho team design review)  
âŒ **Thiáº¿u**: Formal UI/UX interface definitions

## IEEE 1016 lÃ :

âœ… **Chuáº©n hÃ³a**: Qui chuáº©n cho aerospace, defense, formal industries  
âœ… **Chi tiáº¿t**: Traceability matrix, UML, formal specifications  
âœ… **Há»c thuáº­t**: Tá»‘t cho learning, tham kháº£o

âŒ **Thiáº¿u**: Operational details (deployment, monitoring)  
âŒ **Thiáº¿u**: DevOps perspective  
âŒ **CÅ©**: TiÃªu chuáº©n tá»« 1998, chÆ°a update cho modern cloud-native

## ğŸ¯ Khuyáº¿n nghá»‹

**DÃ¹ng káº¿t há»£p cáº£ 2**:

1. **Template cÆ¡ báº£n**: IEEE 1016 (for structure & traceability)
    
2. **Add thá»±c táº¿**: TDD v3.1 (for deployment, testing, monitoring)
    
3. **ThÃªm missing**: Traceability matrix â†’ map requirements â†’ design â†’ tests
    

VÃ­ dá»¥ cáº¥u trÃºc tá»‘i Æ°u:

text

`IEEE 1016 Core Sections (1-3, 7-11) + TDD's Practical Additions (Observability, Deployment, IaC) + Custom Traceability Matrix (Requirements â†’ Design â†’ Tests) = Perfect SDD for modern teams`

Add to follow-up

Check sources

1. [https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/760047/415bf56f-0448-414f-bae5-4ac99efa97c9/paste.txt](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/760047/415bf56f-0448-414f-bae5-4ac99efa97c9/paste.txt)

---

---

# GEMINI: Comprehensive Research Report on System Design Document (SDD) Standards, Methodologies, and Templates

## 1. Introduction: The Strategic Imperative of Software Design Documentation

The System Design Document (SDD), alternatively known as the Software Design Description, stands as the pivotal artifact in the Systems Development Life Cycle (SDLC), bridging the chasm between abstract requirements and concrete implementation. It is the technical blueprint that transforms the "what" defined in the Software Requirements Specification (SRS) into the "how" of the engineering solution. In an era where software systems are increasingly distributed, complex, and critical to organizational operations, the SDD serves not merely as a bureaucratic deliverable but as the primary mechanism for risk mitigation, architectural alignment, and knowledge retention.

The absence of a robust SDD is often the root cause of "technical debt," a phenomenon where expedient, undocumented design decisions compound over time to make systems unmaintainable. Without a centralized "source of truth," development teams devolve into tribal knowledge silos, where architectural intent is lost, and integration points become fragile.1 Conversely, a well-structured SDD, compliant with international standards such as IEEE 1016 and ISO/IEC 12207, ensures that the systemâ€™s architecture is resilient, secure, and scalable. It provides the necessary visibility for stakeholders to validate that the proposed solution meets the architectural significant requirements (ASRs) before significant capital is invested in coding.3

This report provides an exhaustive analysis of the SDD, dissecting its theoretical foundations in engineering standards, its practical structure through High-Level (HLD) and Low-Level (LLD) design paradigms, and its evolution into modern "Docs as Code" methodologies. It specifically integrates the requirements of the Vietnamese technical standard TCVN 11930:2017 to provide a localized context for compliance.

## 2. Global and National Standardization Frameworks

The structure of an SDD is rarely arbitrary in professional engineering environments. It is governed by a hierarchy of standards that dictate the information content, organization, and process required to claim conformance.

### 2.1 IEEE 1016-2009: The International Benchmark

The IEEE 1016-2009 (Standard for Information Technologyâ€”Systems Designâ€”Software Design Descriptions) represents the gold standard for software design documentation. Evolving from the 1998 recommended practice, the 2009 revision elevated the specification to a full standard, harmonizing it with ISO/IEC/IEEE 42010 regarding architectural descriptions.5

The fundamental innovation of IEEE 1016-2009 is its shift from a rigid, monolithic template to a Viewpoint-View conceptual model. The standard recognizes that a single narrative cannot satisfy the diverse needs of all stakeholders (e.g., a database administrator needs different information than a security auditor). Therefore, the SDD is organized into "Design Views," where each view addresses specific "Design Concerns" governed by a "Design Viewpoint".7

#### 2.1.1 Analysis of Design Viewpoints

A compliant SDD must select relevant viewpoints to ensure completeness. The standard defines the following core viewpoints:

|   |   |   |
|---|---|---|
|Viewpoint|Primary Design Concerns|Design Elements & Entities|
|Context Viewpoint|System boundaries, external interactions, and actors. Determines what is inside vs. outside the system scope.|Actors, External Systems, Users, Use Case maps, System Boundaries.|
|Composition Viewpoint|Recursive decomposition of the system into subsystems and components. Focuses on the "part-of" relationships.|Subsystems, Modules, Libraries, Packages, Component hierarchies.|
|Logical Viewpoint|The conceptual structure of the solution, independent of physical implementation. Focuses on types and abstractions.|Classes, Interfaces, Inheritance trees, Polymorphism, Data Types.|
|Dependency Viewpoint|Interconnectivity and coupling. Critical for impact analysis and understanding ripple effects of changes.|"Uses," "Requires," "Imports," "Calls," and "Instantiates" relationships.|
|Information Viewpoint|Persistent data structure, flow, and management. Essential for data integrity and storage strategy.|Entities, Attributes, Relationships (ERD), Data Flow Diagrams (DFD), Schemas.|
|Interaction Viewpoint|Coordination of entities to achieve specific behaviors. Focuses on the temporal sequence of actions.|Sequence Diagrams, Collaboration Diagrams, Message Passing.|
|State Dynamics Viewpoint|Internal behavior of components that are state-dependent. Crucial for embedded systems or complex workflows.|States, Transitions, Events, Guards, Finite State Machines (FSM).|
|Interface Viewpoint|Contracts for interaction between components. Defines the protocols and signatures for communication.|APIs, Function Signatures, Protocols, I/O Definitions, Message Formats.|

5

### 2.2 ISO/IEC 12207: The Process Dimension

While IEEE 1016 governs the product (the document), ISO/IEC 12207 (Systems and software engineering â€“ Software life cycle processes) governs the process of design. It serves as a foundational standard for establishing the maturity of an organization's engineering capabilities. ISO/IEC 12207 distinguishes clearly between the Architectural Design Process (defining the top-level structure) and the Detailed Design Process (defining lower-level components).9

Adherence to ISO/IEC 12207 ensures that the SDD is not a static artifact generated in isolation but is the output of rigorous activities including:

1. Stakeholder Requirement Analysis: Ensuring design decisions trace back to business needs.
    
2. Architecture Evaluation: Assessing alternative architectures against non-functional requirements (performance, maintainability).
    
3. Verification: Confirming that the detailed design conforms to the architecture.10
    

### 2.3 Vietnamese Standards (TCVN): Security and Compliance

For systems developed or deployed within Vietnam, particularly those serving government entities or critical infrastructure, the TCVN (TiÃªu chuáº©n Viá»‡t Nam) framework applies. The most critical standard for system design in this context is TCVN 11930:2017 (Information technology â€“ Security techniques â€“ Basic requirements for securing information systems by level).12

TCVN 11930:2017 classifies information systems into five levels (Level 1 to Level 5) based on the potential impact of their compromise. This classification fundamentally alters the requirements of the SDD.

- Mandatory Security Design Sections: An SDD for a TCVN-compliant system must explicitly document the "Security Architecture" tailored to the system's level.
    

- Network Zoning (VÃ¹ng máº¡ng): The design must show the separation of the system into distinct zones (e.g., DMZ, Application Zone, Database Zone, Management Zone).12
    
- High Availability (Dá»± phÃ²ng nÃ³ng): For Level 3+ systems, the SDD must detail "Hot Standby" mechanisms where redundant components operate simultaneously to ensure zero downtime.12
    
- Authentication Mechanisms: The design must specify multi-factor authentication (MFA) strategies for administrative access, a requirement for higher-level systems.12
    

This localized standard serves as the technical basis for acceptance testing by the Ministry of Information and Communications (MIC). Therefore, an SDD in Vietnam that follows IEEE 1016 but ignores TCVN 11930 may fail regulatory audits.13

## 3. High-Level Design (HLD) vs. Low-Level Design (LLD)

In practical application, the monolithic SDD is often bifurcated into two distinct levels of abstraction: High-Level Design (HLD) and Low-Level Design (LLD). This separation enables different stakeholders to engage with the documentation at the appropriate level of technical depth.

### 3.1 High-Level Design (HLD): Macro-Architecture

The HLD, also referred to as the System Architecture Document, provides the "bird's-eye view" of the entire solution. It functions as the primary vehicle for communicating the system's structure to project managers, architects, and business stakeholders.14

- Strategic Focus: The HLD focuses on the decomposition of the system into major subsystems and the relationships between them. It answers "What" the system does and "Where" components are located.16
    
- Key Artifacts:
    

- System Context Diagrams (showing external integrations).
    
- Technology Stack Selection (e.g., React vs. Angular, PostgreSQL vs. Mongo).
    
- Infrastructure Topology (Cloud zones, Load Balancers).
    
- Non-functional constraint analysis (Scalability, Security).
    

- Risk Mitigation: The HLD identifies architectural bottlenecks (e.g., single points of failure) before development begins.16
    

### 3.2 Low-Level Design (LLD): Micro-Architecture

The LLD acts as the engineering specification for the developers. It translates the broad strokes of the HLD into granular logic, serving as a guide for implementation and unit testing.16

- Tactical Focus: The LLD focuses on the internal logic of specific modules. It answers "How" a specific component functions.15
    
- Key Artifacts:
    

- Class Diagrams (attributes, methods, relationships).
    
- Database Schema (tables, columns, types, constraints).
    
- Pseudocode for complex algorithms.
    
- API Signatures (endpoints, request/response bodies).
    
- Error Handling implementation details.
    

- Traceability: A robust LLD must trace every module back to a component in the HLD, ensuring no architectural requirements are orphaned.16
    

|   |   |   |
|---|---|---|
|Feature|High-Level Design (HLD)|Low-Level Design (LLD)|
|Primary Audience|Architects, Product Managers, Leads|Senior Developers, Programmers, Testers|
|Abstraction Level|Black-box (Components as wholes)|White-box (Internal logic of components)|
|Scope|System-wide ecosystem|Individual modules or classes|
|Design Artifacts|Architecture Diagrams, Flowcharts|Class Diagrams, Pseudo-code, Unit Tests|
|Input Source|System Requirements Specification (SRS)|Reviewed and Approved HLD|

18

## 4. Visual Modeling Methodologies: The Language of Design

An SDD relies heavily on visual models to communicate complex structures. Two primary methodologies dominate the industry: the formal Unified Modeling Language (UML) and the modern C4 Model.

### 4.1 The C4 Model: Context, Containers, Components, Code

Developed by Simon Brown, the C4 model addresses the complexity and steep learning curve of UML by using a hierarchical, map-like approach to diagramming. It is particularly effective for HLD and architectural overviews.21

1. Level 1: System Context Diagram: This is the highest level of abstraction. It places the software system in the center and depicts the people (users) and external software systems (e.g., Payment Gateways, Email Services) that interact with it. It clarifies the system boundaries.23
    
2. Level 2: Container Diagram: This level zooms into the system to show the high-level technical building blocks, or "containers." A container is a separately deployable unit, such as a Single-Page Application (SPA), a Server-Side API, a Mobile App, or a Database. It shows the technology choices and communication protocols (e.g., HTTPS/JSON) between them.24
    
3. Level 3: Component Diagram: This zooms into an individual container to show the internal components (e.g., "Sign In Controller," "Email Component"). This bridges the gap between HLD and LLD.
    
4. Level 4: Code: This corresponds to UML class diagrams. C4 recommends automating this level from the code itself rather than manually drawing it, as it becomes obsolete instantly.21
    

Why Use C4? C4 is superior for communicating with non-technical stakeholders and for "onboarding" developers, as it provides a clear "Google Maps" style zoom-in capability.25

### 4.2 Unified Modeling Language (UML)

UML (ISO/IEC 19501) remains the standard for detailed engineering design, particularly for LLD. It offers precision that C4 lacks regarding behavioral logic.23

- Structural Diagrams:
    

- Class Diagrams: The backbone of Object-Oriented Design. They define the static structure, showing classes, attributes, operations, and relationships (inheritance, aggregation). Essential for the LLD of complex domains.25
    
- Deployment Diagrams: Map software artifacts to physical hardware nodes, useful for infrastructure planning.
    

- Behavioral Diagrams:
    

- Sequence Diagrams: Critical for Interface Design. They model the interaction between objects in a time sequence, showing the exact order of API calls and messages.
    
- State Machine Diagrams: Essential for defining the lifecycle of complex entities (e.g., an Order moving from "Placed" to "Paid" to "Shipped" to "Delivered").
    

Synthesis Recommendation: A modern SDD should utilize the C4 Model for the System Architecture (HLD) sections to provide clarity and context, while reserving UML Sequence and Class diagrams for the Component Design (LLD) sections where precise logical flows must be specified.23

## 5. Comprehensive Master SDD Template

Drawing from IEEE 1016-2009, ISO/IEC 12207, and best practices from industry leaders (Atlassian, CMS), the following is a comprehensive template for a System Design Document. This template integrates the requirements of both HLD and LLD into a unified document structure suitable for complex enterprise systems.

### 

---

Section 1: Introduction

This section establishes the governance and context of the document.

- 1.1 Purpose: Clearly identify the software system under design and the intended audience (e.g., "This SDD details the architecture for the E-Commerce Platform V2.0, intended for the Backend Engineering Team and Security Auditors").
    
- 1.2 Scope: Define the boundaries of the design. Explicitly list what is In-Scope (e.g., "Real-time inventory tracking") and what is Out-of-Scope (e.g., "Legacy data migration," "Warehousing hardware integration") to prevent scope creep.3
    
- 1.3 References: List all binding documents, including the SRS, BRD, and applicable standards (e.g., "Compliance with TCVN 11930:2017 Level 3").
    
- 1.4 Glossary & Acronyms: Define domain-specific terms to ensure a common ubiquitous language across the team.26
    

### Section 2: System Overview & Design Strategies

This section articulates the philosophy behind the technical choices.

- 2.1 System Context: A narrative description of the business problem and how the system fits into the enterprise ecosystem.
    
- 2.2 Design Goals & Tenets: List the "North Star" principles guiding the architecture.
    

- Example: "Latency over Consistency" (for a social feed) vs. "Consistency over Availability" (for a banking ledger).
    
- Example: "Mobile-First Design" or "Cloud-Agnostic Deployment."
    

- 2.3 Constraints: Technical or business limitations.
    

- Regulatory: GDPR, HIPAA, TCVN.
    
- Technical: Legacy system integration, bandwidth limitations in remote areas.27
    

- 2.4 Architectural Strategies:
    

- Pattern Selection: Justify the high-level pattern (e.g., Microservices, Event-Driven, Monolithic, Serverless). Explain why this pattern was chosen over alternatives.14
    
- Technology Stack: A detailed table of selected technologies for Frontend, Backend, Database, Message Broker, and DevOps, including version numbers and licensing considerations.
    

### Section 3: System Architecture (HLD)

The structural core of the document, utilizing the Context and Composition Viewpoints.

- 3.1 Conceptual Architecture (C4 Level 1 & 2):
    

- System Context Diagram: Visualizing users and external systems.
    
- Container Diagram: Visualizing the high-level deployable units (Web App, API, DB).
    

- 3.2 Subsystem Decomposition: Breakdown of the system into functional modules (e.g., "Identity Service," "Payment Gateway," "Notification Engine").
    

- Responsibilities: Define the Single Responsibility of each module.
    
- Interfaces: High-level description of how modules communicate (e.g., REST, gRPC, Kafka topics).1
    

- 3.3 External Interfaces: A list of all third-party dependencies (e.g., Stripe, Google Maps API, Government Tax Gateways).
    

### Section 4: Data Design

The Information Viewpoint, detailing how data is structured, stored, and managed.

- 4.1 Data Architecture: Strategy for persistence.
    

- Database Selection: Justification for SQL vs. NoSQL.
    
- Partitioning Strategy: If the system is large, detail the sharding logic (e.g., "Sharding by UserID" vs. "Sharding by Geo-Region").28
    
- Replication: Master-Slave vs. Multi-Master configurations for high availability.
    

- 4.2 Data Models (Logical & Physical):
    

- ER Diagrams: Entity-Relationship diagrams showing tables, foreign keys, and cardinality (1:1, 1:N, N:M).
    
- NoSQL Schemas: JSON document structures for document stores (e.g., MongoDB collections).29
    

- 4.3 Data Dictionary: A tabular definition of the data elements.
    

- Columns: Field Name, Data Type (INT, VARCHAR), Constraints (PK, FK, Unique, NotNull), Default Value, Description.
    
- Sensitivity: Classification of fields (e.g., "Public," "Internal," "Confidential/PII") to guide security controls.30
    

### Section 5: Component Design (LLD)

The Logical and Interaction Viewpoints, detailing the internals of the subsystems defined in Section 3.

- 5.1 Class Design: UML Class diagrams for critical business logic modules.
    
- 5.2 Process Flow & Interaction:
    

- Sequence Diagrams: Detailed step-by-step visualization of critical use cases (e.g., "User Login Flow," "Checkout Transaction"). This must show success paths and failure paths.16
    
- Activity Diagrams: Flowcharts for complex algorithms (e.g., "Fraud Detection Logic," "Pricing Calculation").
    

- 5.3 Error Handling Strategy: Standardized approach to exceptions.
    

- Logging: What data is logged? (Ensure no PII is logged).
    
- Retries: Exponential backoff strategies for network calls.32
    

### Section 6: Interface Design (API Specification)

The Interface Viewpoint, strictly defining the contracts between components.

- 6.1 API Architecture: Definition of the architectural style (REST Level 2/3, GraphQL, SOAP).
    
- 6.2 Endpoint Definitions:
    

- Format: HTTP Method (GET/POST), URI Resource Path (/api/v1/orders), Request Headers, Request Body Schema, Response Body Schema, HTTP Status Codes (200, 400, 401, 500).
    
- Automation: It is best practice to reference an external OpenAPI/Swagger file here rather than duplicating the full spec in the document text.33
    

- 6.3 Interface Control Documents (ICD): For distinct system-to-system integrations (especially in government or defense), an ICD section is required. It details the physical connectivity, handshake protocols, heartbeat mechanisms, and strict data formats.35
    

### Section 7: Human-Machine Interface (UI/UX)

- 7.1 User Flows: Diagrams showing the navigation path of a user through the application.
    
- 7.2 Screen Layouts: Wireframes or references to high-fidelity prototypes (Figma/Adobe XD).
    
- 7.3 Usability Requirements: Accessibility compliance (WCAG 2.1), responsive breakpoints, and localization support.1
    

### Section 8: Infrastructure & Non-Functional Requirements

Addressing the "Quality Attributes" of the system.

- 8.1 Security Architecture (TCVN 11930 Compliance):
    

- Authentication: OAuth2/OIDC flows, Multi-Factor Authentication (MFA).
    
- Authorization: Role-Based Access Control (RBAC) matrix.
    
- Encryption: Protocols for Data at Rest (AES-256) and Data in Transit (TLS 1.3).12
    

- 8.2 Reliability & Availability:
    

- Disaster Recovery (DR): RTO (Recovery Time Objective) and RPO (Recovery Point Objective) targets.
    
- Backup Strategy: Frequency and retention policies.
    

- 8.3 Performance: Throughput targets (RPS), Latency budgets (e.g., "API response < 200ms for 95th percentile").3
    

## 

---

6. Advanced Topics in Data and API Documentation

### 6.1 The Data Dictionary: The Semantic Backbone

A rigorous SDD must go beyond simple ER diagrams. The Data Dictionary is the semantic backbone that ensures all developers and analysts understand the data in the same way. According to best practices 30, a data dictionary must include:

- Variable Name: The physical column name (e.g., cust_dob).
    
- Business Definition: A human-readable explanation (e.g., "The date of birth of the customer, used for age verification").
    
- Data Type & Length: (e.g., DATE, VARCHAR(255)).
    
- Allowable Values: Enumerated lists or ranges (e.g., "Must be > 1900").
    
- Source: Where the data originates (e.g., "User Input," "Computed," "External API").
    

In systems compliant with TCVN 11930, the data dictionary must also include a Security Classification column (e.g., Public, Internal, Secret) to automate data masking policies in the UI and logs.12

### 6.2 API Specification: Design-First with OpenAPI

In modern microservices architectures, the API is the product. Traditional "Code-First" approaches, where documentation is generated after the code is written, often lead to poor developer experience. The SDD should advocate for a Design-First approach using the OpenAPI Specification (OAS).33

- Single Source of Truth: The OAS file (openapi.yaml) serves as the contract. The SDD references this file.
    
- Mocking: By defining the API in the design phase, frontend teams can use mock servers (e.g., Prism) to start development before the backend is implemented.
    
- Standardization: The SDD must enforce API standards, such as:
    

- Naming: Use plural nouns for resources (/users not /user).
    
- Versioning: Explicit versioning in the URI (/v1/) or Header.
    
- Status Codes: Strict adherence to HTTP semantics (e.g., returning 201 Created for POST requests, not 200 OK).38
    

## 7. Modern Documentation Workflows: Docs as Code and ADRs

The era of maintaining the SDD as a static, 500-page Microsoft Word document is ending. Such documents inevitably become "shelfware"â€”outdated the moment they are printed. Modern engineering teams are transitioning to Docs as Code (DaC) and Architecture Decision Records (ADRs).

### 7.1 Docs as Code (DaC)

DaC philosophy treats documentation with the same rigor as source code.

- Format: Documentation is written in lightweight markup languages like Markdown or AsciiDoc, which are human-readable but machine-parsable.39
    
- Version Control: The SDD resides in the Git repository alongside the code (e.g., /docs/design/sdd.md). This ensures that documentation is versioned, branched, and merged in sync with the feature code.40
    
- CI/CD Integration: Automated pipelines (using tools like Jekyll, Hugo, or Docusaurus) compile the Markdown files into a static website. "Linters" can check for broken links or missing sections automatically.41
    
- Collaboration: Changes to the design require a Pull Request (PR). This allows the team to review design changes using the same diff-based tools used for code reviews, fostering a culture where documentation is a collective responsibility.42
    

### 7.2 Architecture Decision Records (ADR)

While the SDD describes the current state of the system, it often fails to capture the history of decisions. Why did we choose PostgreSQL over MySQL five years ago? ADRs solve this by capturing the context and consequences of architectural choices at a specific point in time.4

A standard ADR template (based on Michael Nygardâ€™s model) includes:

1. Title: Short noun phrase (e.g., "Use OAuth2 for Authentication").
    
2. Status: Proposed, Accepted, Deprecated, Superseded.
    
3. Context: The constraints and forces at play (e.g., "We need to support mobile apps and third-party integrations").
    
4. Decision: The choice made (e.g., "We will implement OAuth2 with JWT").
    
5. Consequences: The resulting context, including pros and cons (e.g., "Pro: Standard security. Con: Tokens increase payload size").44
    

Integration: The SDD should describe the what and how, while referencing the ADRs to explain the why. This keeps the SDD clean while preserving the institutional memory.

## 8. Conclusion

The creation of a System Design Document is a disciplined engineering activity that lays the foundation for software success. It is not a passive activity of recording "what happened" but an active process of defining "what will be." By adhering to international standards like IEEE 1016-2009 for structure and ISO/IEC 12207 for process, and by integrating localized requirements such as TCVN 11930:2017, organizations can ensure their systems are robust, secure, and compliant.

Furthermore, the evolution of design documentation from static definitions to dynamic Docs as Code workflows reflects the agile nature of modern software development. By leveraging the C4 Model for high-level context and UML for low-level precision, and by enforcing strict Data Dictionaries and OpenAPI contracts, engineering teams can significantly reduce integration risks and technical debt. Ultimately, the SDD transforms from a mandatory deliverable into a vital strategic asset that enables scalability, maintainability, and long-term operational excellence.

### 

---

Appendix: SDD Checklist for Reviewers

- [ ] Scope Defined: Is "Out of Scope" explicitly stated?
    
- [ ] Standard Compliance: Does the document map to IEEE 1016 viewpoints?
    
- [ ] Security (TCVN): Are network zones and authentication levels defined per TCVN 11930?
    
- [ ] Data: Is the Data Dictionary complete with types and sensitivity?
    
- [ ] Interfaces: Are APIs defined with request/response schemas (OpenAPI)?
    
- [ ] Diagrams: Are C4 Context and Container diagrams present? Are complex flows mapped in Sequence diagrams?
    
- [ ] Traceability: Does every component trace back to a requirement in the SRS?
    

#### Nguá»“n trÃ­ch dáº«n

1. Software Design Document [Tips & Best Practices] | The Workstream - Atlassian, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.atlassian.com/work-management/knowledge-sharing/documentation/software-design-document](https://www.atlassian.com/work-management/knowledge-sharing/documentation/software-design-document)
    
2. Creating a Software Design Document (SDD): What you need to know - Document360, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://document360.com/blog/software-design-document/](https://document360.com/blog/software-design-document/)
    
3. A Step-by-Step Guide to Write a System Design Document - DZone, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://dzone.com/articles/guide-to-write-a-system-design-document](https://dzone.com/articles/guide-to-write-a-system-design-document)
    
4. ADR process - AWS Prescriptive Guidance, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html](https://docs.aws.amazon.com/prescriptive-guidance/latest/architectural-decision-records/adr-process.html)
    
5. Software design description - Wikipedia, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://en.wikipedia.org/wiki/Software_design_description](https://en.wikipedia.org/wiki/Software_design_description)
    
6. IEEE Std 1016-2009 (Revision of IEEE Std 1016-1998), IEEE Standard for Information Technologyâ€”Systems Designâ€”Software Design, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://cengproject.cankaya.edu.tr/wp-content/uploads/sites/10/2017/12/SDD-ieee-1016-2009.pdf](https://cengproject.cankaya.edu.tr/wp-content/uploads/sites/10/2017/12/SDD-ieee-1016-2009.pdf)
    
7. Software Design Descriptions (SDD), truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://wildart.github.io/MISG5020/SDD.html](https://wildart.github.io/MISG5020/SDD.html)
    
8. IEEE Std 1016-2009 (Revision of IEEE Std 1016-1998), IEEE Standard for Information Technologyâ€”Systems Designâ€”Software Design - IEEE Xplore, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://ieeexplore.ieee.org/iel5/5167253/5167254/05167255.pdf](https://ieeexplore.ieee.org/iel5/5167253/5167254/05167255.pdf)
    
9. ISO/IEC 12207 - Wikipedia, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://en.wikipedia.org/wiki/ISO/IEC_12207](https://en.wikipedia.org/wiki/ISO/IEC_12207)
    
10. ISO/IEC/IEEE 12207 - Software Life Cycle Processes - arc42 Quality Model, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://quality.arc42.org/standards/iso12207](https://quality.arc42.org/standards/iso12207)
    
11. ISO 12207 Software Life Cycle Process Management System - CFE Certification, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://cfecert.com/iso-12207-software-life-cycle-process-management-system/](https://cfecert.com/iso-12207-software-life-cycle-process-management-system/)
    
12. TCVN 11930:2017 - CEBID, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://cebid.vn/wp-content/uploads/2023/07/303609_tcvn11930-2017.pdf](https://cebid.vn/wp-content/uploads/2023/07/303609_tcvn11930-2017.pdf)
    
13. TI ÃŠ UCHU áº¨ NQU á» CGIA TCVN 11930:2017 - VTC Family, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://family.vtc.vn/upload/media/2021/4/27/135430-TCVN-11930-2017-Final-.pdf](https://family.vtc.vn/upload/media/2021/4/27/135430-TCVN-11930-2017-Final-.pdf)
    
14. High-Level Design vs. Low-Level Design: Understanding the Key Differences - Orhan Ergun, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://orhanergun.net/high-level-design-vs-low-level-design-understanding-the-key-differences](https://orhanergun.net/high-level-design-vs-low-level-design-understanding-the-key-differences)
    
15. LLD vs HLD Key Differences In Custom Software - Odyssey Computing, Inc., truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://odysseyinc.com/low-level-design-vs-high-level-design-key-differences-and-why-they-matter-in-custom-software/](https://odysseyinc.com/low-level-design-vs-high-level-design-key-differences-and-why-they-matter-in-custom-software/)
    
16. High-Level Design (HLD) vs. Low-Level Design (LLD) - testRigor AI-Based Automated Testing Tool, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://testrigor.com/blog/high-level-design-hld-vs-low-level-design-lld/](https://testrigor.com/blog/high-level-design-hld-vs-low-level-design-lld/)
    
17. Difference between High Level Design(HLD) and Low Level Design(LLD) - GeeksforGeeks, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.geeksforgeeks.org/system-design/difference-between-high-level-design-and-low-level-design/](https://www.geeksforgeeks.org/system-design/difference-between-high-level-design-and-low-level-design/)
    
18. Difference between HLD, LLD, DLD Explained for EHR Integration - HUSPI, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://huspi.com/blog-open/what-the-differences-lld-hld-dld/](https://huspi.com/blog-open/what-the-differences-lld-hld-dld/)
    
19. Design Phase in SDLC: Key Activities, Types & Examples (2025) - Teaching Agile, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://teachingagile.com/sdlc/design](https://teachingagile.com/sdlc/design)
    
20. what are the major differences between HLD,DLD,LLD? - Informatica Network, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://network.informatica.com/s/question/0D56S0000AD6ZS4SQN/what-are-the-major-differences-between-hlddldlld](https://network.informatica.com/s/question/0D56S0000AD6ZS4SQN/what-are-the-major-differences-between-hlddldlld)
    
21. Introduction | C4 model, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://c4model.com/introduction](https://c4model.com/introduction)
    
22. FAQ - C4 model, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://c4model.com/faq](https://c4model.com/faq)
    
23. C4 Model vs UML: Key Differences for Architects, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.diagrams-ai.com/blog/c4-model-vs-uml-comparison-for-architects/](https://www.diagrams-ai.com/blog/c4-model-vs-uml-comparison-for-architects/)
    
24. UML vs C4: Why I Stopped Drawing Spaghetti Architecture Diagrams - Medium, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://medium.com/@octera/uml-vs-c4-why-i-stopped-drawing-spaghetti-architecture-diagrams-2dbe87ca8076](https://medium.com/@octera/uml-vs-c4-why-i-stopped-drawing-spaghetti-architecture-diagrams-2dbe87ca8076)
    
25. Comparison - C4 model vs UML - IcePanel, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://icepanel.io/blog/2024-07-29-comparison-c4-model-vs-uml](https://icepanel.io/blog/2024-07-29-comparison-c4-model-vs-uml)
    
26. Software Design Document (SDD) Template (summarized from IEEE, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://wildart.github.io/MISG5020/standards/SDD_Template.pdf](https://wildart.github.io/MISG5020/standards/SDD_Template.pdf)
    
27. A Software Design Specification Template - Brad Appleton's, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.bradapp.net/docs/sdd.html](https://www.bradapp.net/docs/sdd.html)
    
28. Database Schema Design for Scalability: Best Practices, Techniques, and Real-World Examples for High-Performance Systems - DEV Community, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://dev.to/dhanush___b/database-schema-design-for-scalability-best-practices-techniques-and-real-world-examples-for-ida](https://dev.to/dhanush___b/database-schema-design-for-scalability-best-practices-techniques-and-real-world-examples-for-ida)
    
29. Best Practices For Documenting Database Design - GeeksforGeeks, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.geeksforgeeks.org/dbms/best-practices-for-documenting-database-design/](https://www.geeksforgeeks.org/dbms/best-practices-for-documenting-database-design/)
    
30. API Schema & Data Dictionary - Wikimedia Enterprise, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://enterprise.wikimedia.com/docs/data-dictionary/](https://enterprise.wikimedia.com/docs/data-dictionary/)
    
31. Data Dictionary: Examples, Templates, & Best practices - Atlan, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://atlan.com/what-is-a-data-dictionary/](https://atlan.com/what-is-a-data-dictionary/)
    
32. How to Write a Great Technical Design Document | by Shay Yacobinski | Taranis Tech, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://medium.com/taranis-ag/how-to-write-a-great-technical-design-document-356aaaad9385](https://medium.com/taranis-ag/how-to-write-a-great-technical-design-document-356aaaad9385)
    
33. Best Practices | OpenAPI Documentation, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://learn.openapis.org/best-practices.html](https://learn.openapis.org/best-practices.html)
    
34. OpenAPI Specification Guide: Structure Implementation & Best Practices - Gravitee, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.gravitee.io/blog/openapi-specification-structure-best-practices](https://www.gravitee.io/blog/openapi-specification-structure-best-practices)
    
35. Interface control document - Wikipedia, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://en.wikipedia.org/wiki/Interface_control_document](https://en.wikipedia.org/wiki/Interface_control_document)
    
36. Interface Control Document (ICD) - CMS, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.cms.gov/files/zip/interfacecontroldocumentzip](https://www.cms.gov/files/zip/interfacecontroldocumentzip)
    
37. Data Dictionary - Harvard Biomedical Data Management, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://datamanagement.hms.harvard.edu/collect-analyze/documentation-metadata/data-dictionary](https://datamanagement.hms.harvard.edu/collect-analyze/documentation-metadata/data-dictionary)
    
38. Best Practices in API Design - Swagger, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://swagger.io/resources/articles/best-practices-in-api-design/](https://swagger.io/resources/articles/best-practices-in-api-design/)
    
39. Docs as Code â€“ A Technical Writing Approach From The Software Industry - Quanos, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://quanos.com/en/blog/technical-documentation/detail/docs-as-code/](https://quanos.com/en/blog/technical-documentation/detail/docs-as-code/)
    
40. Making Documentation Simpler and Practical: Our Docs-as-Code Journey - Squarespace Engineering Blog, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://engineering.squarespace.com/blog/2025/making-documentation-simpler-and-practical-our-docs-as-code-journey](https://engineering.squarespace.com/blog/2025/making-documentation-simpler-and-practical-our-docs-as-code-journey)
    
41. Documentation As Code - Docs-as-Code, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://docs-as-co.de/](https://docs-as-co.de/)
    
42. Tools and techniques for effective code documentation - GitHub, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://github.com/resources/articles/tools-and-techniques-for-effective-code-documentation](https://github.com/resources/articles/tools-and-techniques-for-effective-code-documentation)
    
43. Architectural Decision Records, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://adr.github.io/](https://adr.github.io/)
    
44. Architecture decision record (ADR) examples for software planning, IT leadership, and template documentation - GitHub, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://github.com/joelparkerhenderson/architecture-decision-record](https://github.com/joelparkerhenderson/architecture-decision-record)
    
45. ADRs and Technical Design Documents | Oliver Davies, truy cáº­p vÃ o thÃ¡ng 12 16, 2025, [https://www.oliverdavies.uk/daily/2022/09/23/adrs-technical-design-documents](https://www.oliverdavies.uk/daily/2022/09/23/adrs-technical-design-documents)
    

**