# SOFTWARE DESIGN DOCUMENT (SDD) - finAI Finance Agent Web Browser

**Production Quality Standard | Version 1.0**

> ğŸ¯ **TÃ i liá»‡u thiáº¿t káº¿ há»‡ thá»‘ng chi tiáº¿t cho finAI Finance Agent Web Browser - Má»™t AI Agent chuyÃªn biá»‡t cho nghiÃªn cá»©u tÃ i chÃ­nh**

---

## ğŸ“‹ THÃ”NG TIN TÃ€I LIá»†U

```yaml
## ============================================
## THÃ”NG TIN Dá»° ÃN
## ============================================
TÃªn_Dá»±_Ãn: "finAI Finance Agent Web Browser"
MÃ£_TÃ i_Liá»‡u: "SDD-FINAI-WEBAGENT-1.0"

## Quyá»n Sá»Ÿ Há»¯u
TÃ¡c_Giáº£_ChÃ­nh: "Kiáº¿n trÃºc sÆ° há»‡ thá»‘ng finAI"
Äá»“ng_TÃ¡c_Giáº£:
  - "Product Manager"
  - "Tech Lead"
  - "ML Engineer"

## Xem xÃ©t & PhÃª duyá»‡t
NgÆ°á»i_ÄÃ¡nh_GiÃ¡:
  Tech_Lead: "[TÃªn]"
  Product_Manager: "[TÃªn]"
  Security_Engineer: "[TÃªn]"
  QA_Lead: "[TÃªn]"
  ML_Engineer: "[TÃªn]"
PhÃª_Duyá»‡t_Bá»Ÿi: "[TÃªn, Vai trÃ²]"

## Theo DÃµi Tráº¡ng ThÃ¡i
Tráº¡ng_ThÃ¡i: "In Review"
Äá»™_Æ¯u_TiÃªn: "P0-Critical"

## Thá»i Gian
NgÃ y_Táº¡o: "2024-12-16"
Cáº­p_Nháº­t_Láº§n_Cuá»‘i: "2024-12-16"
Má»¥c_TiÃªu_Ra_Máº¯t: "Q2 2025"
Háº¡n_ÄÃ¡nh_GiÃ¡: "2024-12-30"

## PhiÃªn Báº£n
PhiÃªn_Báº£n: "1.0.0"

## TÃ i Liá»‡u LiÃªn Quan
TÃ i_Liá»‡u_LiÃªn_Quan:
  PRD: "[Link]"
  API_Spec: "[Link]"
  UI_Design: "[Link]"
  Test_Plan: "[Link]"
```

---

## ğŸ“– Má»¤C Lá»¤C

### Pháº§n I: Ná»n Táº£ng & Kiáº¿n TrÃºc

1. [TÃ³m Táº¯t Äiá»u HÃ nh (Executive Summary)](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#1-t%C3%B3m-t%E1%BA%AFt-%C4%91i%E1%BB%81u-h%C3%A0nh)
2. [Giá»›i Thiá»‡u](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#2-gi%E1%BB%9Bi-thi%E1%BB%87u)
3. [Má»¥c TiÃªu, Pháº¡m Vi & RÃ ng Buá»™c](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#3-m%E1%BB%A5c-ti%C3%AAu-ph%E1%BA%A1m-vi--r%C3%A0ng-bu%E1%BB%99c)
4. [Tá»•ng Quan Há»‡ Thá»‘ng](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#4-t%E1%BB%95ng-quan-h%E1%BB%87-th%E1%BB%91ng)
5. [Thiáº¿t Káº¿ Tá»•ng Thá»ƒ (HLD)](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#5-thi%E1%BA%BFt-k%E1%BA%BF-t%E1%BB%95ng-th%E1%BB%83-hld)
6. [Thiáº¿t Káº¿ Chi Tiáº¿t (LLD)](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#6-thi%E1%BA%BFt-k%E1%BA%BF-chi-ti%E1%BA%BFt-lld)

### Pháº§n II: Chi Tiáº¿t Triá»ƒn Khai

7. [Thiáº¿t Káº¿ API & Há»£p Äá»“ng](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#7-thi%E1%BA%BFt-k%E1%BA%BF-api--h%E1%BB%A3p-%C4%91%E1%BB%93ng)
8. [Thiáº¿t Káº¿ Dá»¯ Liá»‡u](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#8-thi%E1%BA%BFt-k%E1%BA%BF-d%E1%BB%AF-li%E1%BB%87u)
9. [Thiáº¿t Káº¿ Báº£o Máº­t](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#9-thi%E1%BA%BFt-k%E1%BA%BF-b%E1%BA%A3o-m%E1%BA%ADt)

### Pháº§n III: Sáºµn SÃ ng Production

10. [Kháº£ NÄƒng Phá»¥c Há»“i & Äá»™ Tin Cáº­y](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#10-kh%E1%BA%A3-n%C4%83ng-ph%E1%BB%A5c-h%E1%BB%93i--%C4%91%E1%BB%99-tin-c%E1%BA%ADy)
11. [Kháº£ NÄƒng Quan SÃ¡t & GiÃ¡m SÃ¡t](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#11-kh%E1%BA%A3-n%C4%83ng-quan-s%C3%A1t--gi%C3%A1m-s%C3%A1t)
12. [Triá»ƒn Khai & Váº­n HÃ nh](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#12-tri%E1%BB%83n-khai--v%E1%BA%ADn-h%C3%A0nh)
13. [Chiáº¿n LÆ°á»£c Kiá»ƒm Thá»­](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#13-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-ki%E1%BB%83m-th%E1%BB%AD)

### Pháº§n IV: Cháº¥t LÆ°á»£ng & Quáº£n Trá»‹

14. [YÃªu Cáº§u Phi Chá»©c NÄƒng (NFR)](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#14-y%C3%AAu-c%E1%BA%A7u-phi-ch%E1%BB%A9c-n%C4%83ng-nfr)
15. [Hiá»‡u Suáº¥t & Láº­p Káº¿ Hoáº¡ch CÃ´ng Suáº¥t](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#15-hi%E1%BB%87u-su%E1%BA%A5t--l%E1%BA%ADp-k%E1%BA%BF-ho%E1%BA%A1ch-c%C3%B4ng-su%E1%BA%A5t)
16. [Tá»‘i Æ¯u HÃ³a Chi PhÃ­](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#16-t%E1%BB%91i-%C6%B0u-h%C3%B3a-chi-ph%C3%AD)
17. [ÄÃ¡nh Äá»•i & Quyáº¿t Äá»‹nh Kiáº¿n TrÃºc](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#17-%C4%91%C3%A1nh-%C4%91%E1%BB%95i--quy%E1%BA%BFt-%C4%91%E1%BB%8Bnh-ki%E1%BA%BFn-tr%C3%BAc)

### Pháº§n V: Váº­n HÃ nh & MLOps

18. [á»¨ng PhÃ³ Sá»± Cá»‘ & Runbooks](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#18-%E1%BB%A9ng-ph%C3%B3-s%E1%BB%B1-c%E1%BB%91--runbooks)
19. [Kiáº¿n TrÃºc LangGraph Agent Core](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#19-ki%E1%BA%BFn-tr%C3%BAc-langgraph-agent-core)

### Pháº§n VI: Ra Máº¯t & HÆ¡n Tháº¿ Ná»¯a

20. [Lá»™ TrÃ¬nh Triá»ƒn Khai](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#20-l%E1%BB%99-tr%C3%ACnh-tri%E1%BB%83n-khai)
21. [Checklist Sáºµn SÃ ng Production](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#21-checklist-s%E1%BA%B5n-s%C3%A0ng-production)
22. [Lá»—i ThÆ°á»ng Gáº·p & Anti-Patterns](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#22-l%E1%BB%97i-th%C6%B0%E1%BB%9Dng-g%E1%BA%B7p--anti-patterns)
23. [Khuyáº¿n Nghá»‹ CÃ´ng Cá»¥](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#23-khuy%E1%BA%BFn-ngh%E1%BB%8B-c%C3%B4ng-c%E1%BB%A5)
24. [Phá»¥ Lá»¥c](https://www.genspark.ai/agents?id=247ebf04-08c0-44cf-95da-b72eb9d10015#24-ph%E1%BB%A5-l%E1%BB%A5c)

---

## PHáº¦N I: Ná»€N Táº¢NG & KIáº¾N TRÃšC

---

## 1. TÃ“M Táº®T ÄIá»€U HÃ€NH

### 1.1 Báº£ng TÃ³m Táº¯t

|KhÃ­a Cáº¡nh|Chi Tiáº¿t|
|---|---|
|**PhÃ¡t Biá»ƒu Váº¥n Äá»**|CÃ¡c chuyÃªn gia tÃ i chÃ­nh máº¥t 5-10 giá» Ä‘á»ƒ nghiÃªn cá»©u má»™t cá»• phiáº¿u do pháº£i thao tÃ¡c thá»§ cÃ´ng vá»›i nhiá»u nguá»“n dá»¯ liá»‡u (SEC filings, earnings calls, news, screener). Quy trÃ¬nh hiá»‡n táº¡i dá»… bá» sÃ³t thÃ´ng tin vÃ  khÃ´ng hiá»‡u quáº£.|
|**Giáº£i PhÃ¡p Äá» Xuáº¥t**|finAI Finance Agent Web Browser - Má»™t AI Agent chuyÃªn biá»‡t sá»­ dá»¥ng LangGraph Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a nghiÃªn cá»©u tÃ i chÃ­nh. Agent cÃ³ kháº£ nÄƒng Ä‘iá»u hÆ°á»›ng web, trÃ­ch xuáº¥t dá»¯ liá»‡u, phÃ¢n tÃ­ch vÃ  tá»•ng há»£p thÃ´ng tin tá»« nhiá»u nguá»“n, giáº£m thá»i gian nghiÃªn cá»©u tá»« 5-10 giá» xuá»‘ng <30 phÃºt.|
|**TÃ¡c Äá»™ng Kinh Doanh**|â€¢ TÄƒng nÄƒng suáº¥t phÃ¢n tÃ­ch viÃªn 10x  <br>â€¢ Giáº£m thá»i gian nghiÃªn cá»©u 90%  <br>â€¢ NÃ¢ng cao cháº¥t lÆ°á»£ng quyáº¿t Ä‘á»‹nh Ä‘áº§u tÆ°  <br>â€¢ Thu nháº­p dá»± kiáº¿n: $100K ARR trong nÄƒm 1 vá»›i 1K ngÆ°á»i dÃ¹ng tráº£ phÃ­|
|**TÃ¡c Äá»™ng Ká»¹ Thuáº­t**|â€¢ Äá»™ trá»… P95 <8 giÃ¢y cho tÃ¡c vá»¥ nghiÃªn cá»©u Ä‘a bÆ°á»›c  <br>â€¢ Äá»™ tin cáº­y 99.5% (tá»· lá»‡ thÃ nh cÃ´ng)  <br>â€¢ Chi phÃ­ <$0.10 má»—i nghiÃªn cá»©u  <br>â€¢ Kháº£ nÄƒng má»Ÿ rá»™ng lÃªn 10K ngÆ°á»i dÃ¹ng Ä‘á»“ng thá»i|
|**CÃ´ng Nghá»‡ ChÃ­nh**|Python 3.11, LangGraph, Playwright, GPT-4o/Claude 3.5 Sonnet, PostgreSQL, Redis, FastAPI|
|**Æ¯á»›c TÃ­nh Ná»— Lá»±c**|3 ká»¹ sÆ° Ã— 6 thÃ¡ng = 18 ngÆ°á»i-thÃ¡ng (MVP)  <br>5 ká»¹ sÆ° Ã— 12 thÃ¡ng = 60 ngÆ°á»i-thÃ¡ng (Production)|
|**Má»©c Äá»™ Rá»§i Ro**|**Cao** - YÃªu cáº§u ká»¹ thuáº­t phá»©c táº¡p (AI Agent), dá»¯ liá»‡u tÃ i chÃ­nh nháº¡y cáº£m, cáº¡nh tranh gay gáº¯t|
|**Thá»i Gian**|â€¢ MVP: 6 thÃ¡ng (Q2 2025)  <br>â€¢ Production Ä‘áº§y Ä‘á»§: 12 thÃ¡ng (Q4 2025)|
|**BÃªn LiÃªn Quan ChÃ­nh**|Äá»™i Product, Äá»™i Engineering, Äá»™i ML, PhÃ¢n tÃ­ch viÃªn tÃ i chÃ­nh, Cá»‘ váº¥n tÃ i chÃ­nh|
|**Tá»•ng Chi PhÃ­ (NÄƒm 1)**|$500K infrastructure + development + LLM API costs|

### 1.2 Tá»•ng Quan Kiáº¿n TrÃºc

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#0f172a','primaryTextColor':'#fff','primaryBorderColor':'#3b82f6','fontSize':'13px'}}}%%

flowchart TB
    User([ğŸ‘¤ NGÆ¯á»œI DÃ™NG<br/>PhÃ¢n tÃ­ch viÃªn/Cá»‘ váº¥n TÃ i chÃ­nh])
    
    subgraph WebBrowser["ğŸŒ WEB BROWSER EXTENSION"]
        direction TB
        UI["ğŸ’» Giao Diá»‡n NgÆ°á»i DÃ¹ng<br/>Intention Bar + Agent Status Panel"]
        Extension["ğŸ”Œ Chrome Extension<br/>Context Collector + Action Executor"]
    end
    
    subgraph AgentCore["ğŸ§  AGENT CORE (LangGraph)"]
        direction TB
        Perception["ğŸ‘ï¸ PERCEPTION LAYER<br/>A11y Tree (90%) + Vision (10%)"]
        Cognition["ğŸ¯ COGNITION LAYER<br/>Planner â†’ Executor â†’ Verifier â†’ Replan"]
        Action["âš¡ ACTION LAYER<br/>Tool Registry + Browser Controller"]
        Governance["ğŸ›¡ï¸ GOVERNANCE LAYER<br/>Guardrails + HITL"]
    end
    
    subgraph DataLayer["ğŸ—„ï¸ DATA & SERVICES"]
        direction LR
        DB[(PostgreSQL<br/>User + Session Data)]
        Cache[(Redis<br/>Short-term Memory)]
        VectorDB[(Pinecone<br/>Long-term Memory/RAG)]
        LLM[ğŸ¤– LLM APIs<br/>GPT-4o/Claude 3.5]
    end
    
    subgraph External["â˜ï¸ EXTERNAL"]
        FinSites["ğŸ“Š Financial Websites<br/>SEC, Yahoo Finance, etc."]
    end
    
    User <-->|TÆ°Æ¡ng tÃ¡c| UI
    UI <--> Extension
    Extension <--> AgentCore
    
    Perception --> Cognition
    Cognition --> Action
    Cognition <--> Governance
    Action --> Extension
    
    AgentCore <--> DB
    AgentCore <--> Cache
    AgentCore <--> VectorDB
    AgentCore <--> LLM
    
    Extension <-->|Playwright| FinSites
    
    style User fill:#6366f1,stroke:#4f46e5,stroke-width:3px,color:#fff
    style WebBrowser fill:#1e3a8a,stroke:#3b82f6,stroke-width:3px,color:#fff
    style AgentCore fill:#78350f,stroke:#f59e0b,stroke-width:3px,color:#fff
    style DataLayer fill:#064e3b,stroke:#10b981,stroke-width:3px,color:#fff
    style External fill:#64748b,stroke:#475569,stroke-width:2px,color:#fff
```

### 1.3 Chá»‰ Sá»‘ ChÃ­nh & TiÃªu ChÃ­ ThÃ nh CÃ´ng

|KPI|Hiá»‡n Táº¡i|Má»¥c TiÃªu|PhÆ°Æ¡ng PhÃ¡p Äo LÆ°á»ng|
|---|---|---|---|
|**Thá»i Gian NghiÃªn Cá»©u**|5-10 giá»|<30 phÃºt|Theo dÃµi thá»i gian tá»« input Ä‘áº¿n output|
|**Tá»· Lá»‡ ThÃ nh CÃ´ng TÃ¡c Vá»¥**|N/A|>95%|Sá»‘ tÃ¡c vá»¥ hoÃ n thÃ nh/tá»•ng sá»‘ tÃ¡c vá»¥|
|**Äá»™ Trá»… P95**|N/A|<8 giÃ¢y|LangSmith tracing|
|**Chi PhÃ­ Má»—i NghiÃªn Cá»©u**|N/A|<$0.10|LLM API cost tracking|
|**Äá»™ ChÃ­nh XÃ¡c Dá»¯ Liá»‡u**|N/A|>99%|Human verification sampling|
|**NgÆ°á»i DÃ¹ng Hoáº¡t Äá»™ng HÃ ng Tuáº§n**|N/A|60% ngÆ°á»i dÃ¹ng tráº£ phÃ­|Analytics tracking|
|**NPS (Net Promoter Score)**|N/A|>40|Kháº£o sÃ¡t ngÆ°á»i dÃ¹ng|

### 1.4 TÃ³m Táº¯t Rá»§i Ro

|Rá»§i Ro|XÃ¡c Suáº¥t|TÃ¡c Äá»™ng|Giáº£m Thiá»ƒu|
|---|---|---|---|
|**Hallucination cá»§a LLM**|Cao|NghiÃªm trá»ng|â€¢ Verifier Node vá»›i validation logic  <br>â€¢ Human-in-the-loop cho tÃ¡c vá»¥ quan trá»ng  <br>â€¢ Confidence scoring  <br>â€¢ Multi-source verification|
|**Thay Äá»•i Cáº¥u TrÃºc Website**|Cao|Trung bÃ¬nh|â€¢ A11y Tree lÃ m primary (semantic, bá»n vá»¯ng)  <br>â€¢ Vision Model lÃ m fallback  <br>â€¢ Self-healing mechanism trong Replan Node|
|**Chi PhÃ­ LLM Cao**|Trung bÃ¬nh|Cao|â€¢ Model routing (Gemini Flash cho simple, Claude Sonnet cho complex)  <br>â€¢ Prompt caching  <br>â€¢ A11y Tree thay vÃ¬ full DOM (giáº£m 96% tokens)|
|**TuÃ¢n Thá»§ & Quy Äá»‹nh**|Trung bÃ¬nh|NghiÃªm trá»ng|â€¢ Äá»‹nh vá»‹ rÃµ rÃ ng: â€œresearch toolâ€ khÃ´ng pháº£i â€œinvestment advisorâ€  <br>â€¢ Guardrails layer  <br>â€¢ Audit logging  <br>â€¢ Legal review|
|**Cáº¡nh Tranh (Bloomberg, FactSet)**|Cao|Cao|â€¢ Focus vÃ o vertical: Financial research  <br>â€¢ Build moats: Data + Compliance + Domain brand  <br>â€¢ Speed to market|

---

## 2. GIá»šI THIá»†U

### 2.1 Má»¥c ÄÃ­ch TÃ i Liá»‡u

TÃ i liá»‡u nÃ y cung cáº¥p **báº£n thiáº¿t káº¿ production-ready Ä‘áº§y Ä‘á»§** cho **finAI Finance Agent Web Browser**:

- **HLD (High-Level Design)**: Kiáº¿n trÃºc tá»•ng thá»ƒ 4-Layer vá»›i LangGraph Agent Core
- **LLD (Low-Level Design)**: Chi tiáº¿t triá»ƒn khai tá»«ng component, node, tool
- **Production Standards**: Báº£o máº­t, kháº£ nÄƒng quan sÃ¡t, Ä‘á»™ tin cáº­y
- **Agent Architecture**: Thiáº¿t káº¿ chi tiáº¿t LangGraph State Machine
- **Operations**: Runbooks, pháº£n há»“i sá»± cá»‘, chiáº¿n lÆ°á»£c giÃ¡m sÃ¡t

### 2.2 Äá»‘i TÆ°á»£ng Má»¥c TiÃªu

|Äá»‘i TÆ°á»£ng|Má»¥c ÄÃ­ch ChÃ­nh|CÃ¡c Pháº§n ChÃ­nh|
|---|---|---|
|**Ká»¹ SÆ°**|Triá»ƒn khai|5-8, 10-13, 19|
|**Kiáº¿n TrÃºc SÆ°**|ÄÃ¡nh giÃ¡ kiáº¿n trÃºc|5, 17, 19|
|**DevOps/SRE**|Váº­n hÃ nh|10-12, 18|
|**QA**|Thiáº¿t káº¿ test|13|
|**Product**|Pháº¡m vi/Timeline|1, 3, 20|
|**Báº£o Máº­t**|ÄÃ¡nh giÃ¡ báº£o máº­t|9|
|**ML Engineers**|Agent logic|19|

### 2.3 Äá»‹nh NghÄ©a & Tá»« Viáº¿t Táº¯t

|Thuáº­t Ngá»¯|Äá»‹nh NghÄ©a|
|---|---|
|**A11y Tree**|Accessibility Tree - CÃ¢y cáº¥u trÃºc ngá»¯ nghÄ©a cá»§a trang web|
|**Agent**|AI Agent - Há»‡ thá»‘ng tá»± Ä‘á»™ng cÃ³ kháº£ nÄƒng perceive, reason, act|
|**CoT**|Chain-of-Thought - PhÆ°Æ¡ng phÃ¡p suy luáº­n tá»«ng bÆ°á»›c cá»§a LLM|
|**DOM**|Document Object Model - Cáº¥u trÃºc HTML cá»§a trang web|
|**HITL**|Human-in-the-Loop - Con ngÆ°á»i tham gia vÃ o vÃ²ng láº·p quyáº¿t Ä‘á»‹nh|
|**LangGraph**|Framework Ä‘á»ƒ xÃ¢y dá»±ng stateful, multi-step AI agents|
|**RAG**|Retrieval-Augmented Generation - TÄƒng cÆ°á»ng LLM báº±ng retrieval|
|**ReAct**|Reasoning + Acting - MÃ´ hÃ¬nh agent káº¿t há»£p suy luáº­n vÃ  hÃ nh Ä‘á»™ng|

### 2.4 TiÃªu Chuáº©n TÃ i Liá»‡u

TÃ i liá»‡u nÃ y tuÃ¢n theo:

- **IEEE 1016-2009**: MÃ´ táº£ thiáº¿t káº¿ pháº§n má»m
- **C4 Model**: Trá»±c quan hÃ³a kiáº¿n trÃºc
- **OpenAPI 3.0**: Äáº·c táº£ API
- **ADR Format**: Quyáº¿t Ä‘á»‹nh kiáº¿n trÃºc

---

## 3. Má»¤C TIÃŠU, PHáº M VI & RÃ€NG BUá»˜C

### 3.1 Má»¥c TiÃªu

#### Má»¥c TiÃªu Kinh Doanh

|Má»¥c TiÃªu|Chá»‰ Sá»‘|Má»¥c TiÃªu|Thá»i Gian|
|---|---|---|---|
|**TÄƒng Hiá»‡u Suáº¥t NgÆ°á»i DÃ¹ng**|Thá»i gian nghiÃªn cá»©u trung bÃ¬nh|Giáº£m 90% (tá»« 5h â†’ 30 phÃºt)|Q2 2025|
|**Thu HÃºt NgÆ°á»i DÃ¹ng Tráº£ PhÃ­**|NgÆ°á»i dÃ¹ng tráº£ phÃ­|1,000 ngÆ°á»i|Q4 2025|
|**Doanh Thu**|ARR (Annual Recurring Revenue)|$100K|Cuá»‘i 2025|
|**Sá»± HÃ i LÃ²ng NgÆ°á»i DÃ¹ng**|NPS Score|>40|Q3 2025|

#### Má»¥c TiÃªu Ká»¹ Thuáº­t

|Má»¥c TiÃªu|Chá»‰ Sá»‘|Má»¥c TiÃªu|Thá»i Gian|
|---|---|---|---|
|**Hiá»‡u Suáº¥t**|Äá»™ trá»… P95|<8 giÃ¢y (tÃ¡c vá»¥ Ä‘a bÆ°á»›c)|MVP|
|**Äá»™ Tin Cáº­y**|Tá»· lá»‡ thÃ nh cÃ´ng|>95%|Phase 2|
|**Chi PhÃ­**|Chi phÃ­ má»—i tÃ¡c vá»¥|<$0.10|Phase 3|
|**Báº£o Máº­t**|Lá»— há»•ng nghiÃªm trá»ng|Zero|Ongoing|
|**Äá»™ ChÃ­nh XÃ¡c**|Äá»™ chÃ­nh xÃ¡c dá»¯ liá»‡u|>99%|Phase 2|

### 3.2 Trong Pháº¡m Vi âœ…

#### MVP (Must Have - Phase 1, 6 thÃ¡ng)

**Chá»©c NÄƒng Cá»‘t LÃµi:**

- âœ… **Intent Input & Parsing**: NgÆ°á»i dÃ¹ng nháº­p Ã½ Ä‘á»‹nh báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn
- âœ… **Research Agent**: Tá»± Ä‘á»™ng Ä‘iá»u hÆ°á»›ng, trÃ­ch xuáº¥t dá»¯ liá»‡u tá»« SEC filings, earnings calls, news
- âœ… **Multi-Source Synthesis**: Tá»•ng há»£p thÃ´ng tin tá»« â‰¥3 nguá»“n
- âœ… **Evidence Pack**: Hiá»ƒn thá»‹ nguá»“n vÃ  trÃ­ch dáº«n cho má»i thÃ´ng tin
- âœ… **1-Page Investment Snapshot**: TÃ³m táº¯t káº¿t quáº£ nghiÃªn cá»©u

**CÃ´ng Nghá»‡:**

- âœ… LangGraph Agent Core (4-Layer)
- âœ… A11y Tree + Vision fallback
- âœ… PostgreSQL + Redis
- âœ… Chrome Extension

#### Phase 2 (Should Have - +6 thÃ¡ng)

**Má»Ÿ Rá»™ng Chá»©c NÄƒng:**

- ğŸ“‹ **Portfolio Monitoring**: Theo dÃµi danh má»¥c Ä‘áº§u tÆ°, cáº£nh bÃ¡o rá»§i ro
- ğŸ“‹ **Comparative Analysis**: So sÃ¡nh nhiá»u cá»• phiáº¿u/cÃ´ng ty
- ğŸ“‹ **Historical Research**: Truy cáº­p lá»‹ch sá»­ nghiÃªn cá»©u, RAG-enhanced
- ğŸ“‹ **Custom Reports**: Táº¡o bÃ¡o cÃ¡o tÃ¹y chá»‰nh

#### Phase 3 (Nice to Have - TÆ°Æ¡ng lai)

**NÃ¢ng Cao:**

- ğŸ’¡ **Multi-language Support**: Há»— trá»£ tiáº¿ng Viá»‡t, tiáº¿ng Trung
- ğŸ’¡ **Voice Input**: Nháº­p báº±ng giá»ng nÃ³i
- ğŸ’¡ **Mobile App**: á»¨ng dá»¥ng iOS/Android
- ğŸ’¡ **Team Collaboration**: Chia sáº» nghiÃªn cá»©u trong nhÃ³m

### 3.3 NgoÃ i Pháº¡m Vi / KhÃ´ng Pháº£i Má»¥c TiÃªu âŒ

|KhÃ´ng Pháº£i Má»¥c TiÃªu|LÃ½ Do|TÆ°Æ¡ng Lai?|
|---|---|---|
|**Trading Execution**|KhÃ´ng pháº£i investment advisor, trÃ¡nh váº¥n Ä‘á» regulatory|CÃ³ thá»ƒ Phase 4 (vá»›i RIA license)|
|**Real-time Market Data**|Chi phÃ­ cao, khÃ´ng cáº§n thiáº¿t cho nghiÃªn cá»©u cÆ¡ báº£n|Phase 3|
|**Custom Financial Models**|Phá»©c táº¡p, ngoÃ i pháº¡m vi MVP|Phase 3|
|**Enterprise CRM Integration**|Thá»‹ trÆ°á»ng khÃ¡c (enterprise vs SMB)|KhÃ¡c team|

### 3.4 Giáº£ Äá»‹nh

|ID|Giáº£ Äá»‹nh|TÃ¡c Äá»™ng Náº¿u Sai|XÃ¡c Nháº­n|
|---|---|---|---|
|**A1**|LLM API (GPT-4o/Claude) á»•n Ä‘á»‹nh vÃ  khÃ´ng tÄƒng giÃ¡ Ä‘á»™t ngá»™t|Cao - chi phÃ­ tÄƒng|Monitor API pricing|
|**A2**|CÃ¡c trang web tÃ i chÃ­nh khÃ´ng block agent quÃ¡ máº¡nh|Cao - chá»©c nÄƒng bá»‹ áº£nh hÆ°á»Ÿng|Test vá»›i stealth techniques|
|**A3**|NgÆ°á»i dÃ¹ng sáºµn lÃ²ng tráº£ $100-300/thÃ¡ng|Cao - doanh thu|Kháº£o sÃ¡t pricing|
|**A4**|Sá»‘ lÆ°á»£ng ngÆ°á»i dÃ¹ng <10K trong nÄƒm 1|Trung bÃ¬nh - cáº§n scale sá»›m|Monitor growth|
|**A5**|SEC filings structure khÃ´ng thay Ä‘á»•i lá»›n|Tháº¥p - cáº¥u trÃºc á»•n Ä‘á»‹nh|Monitor SEC changes|

### 3.5 RÃ ng Buá»™c

#### RÃ ng Buá»™c Ká»¹ Thuáº­t

|RÃ ng Buá»™c|LÃ½ Do|Giáº£i PhÃ¡p Thay Tháº¿|
|---|---|---|
|**Python 3.11+**|LangGraph, Playwright Ä‘á»u Python|N/A|
|**LangGraph**|Best framework cho stateful agents|N/A|
|**PostgreSQL**|ACID compliance cho financial data|N/A|
|**Chrome Extension**|Phá»• biáº¿n nháº¥t, ecosystem tá»‘t|Sau nÃ y: Firefox, Edge|

#### RÃ ng Buá»™c Kinh Doanh

|RÃ ng Buá»™c|TÃ¡c Äá»™ng|Giáº£m Thiá»ƒu|
|---|---|---|
|**NgÃ¢n sÃ¡ch <$500K/nÄƒm**|Háº¡n cháº¿ infrastructure, headcount|â€¢ Reserved instances  <br>â€¢ Spot instances  <br>â€¢ Model routing Ä‘á»ƒ giáº£m LLM cost|
|**Ra máº¯t Q2 2025**|Timeline cháº·t|â€¢ Giáº£m pháº¡m vi MVP  <br>â€¢ Parallel development  <br>â€¢ Reuse open-source|
|**Team 3-5 ngÆ°á»i**|Háº¡n cháº¿ tá»‘c Ä‘á»™ phÃ¡t triá»ƒn|â€¢ Clear prioritization  <br>â€¢ Good documentation  <br>â€¢ Modular architecture|

#### TuÃ¢n Thá»§

|Quy Äá»‹nh|YÃªu Cáº§u|Triá»ƒn Khai|
|---|---|---|
|**Investment Advisers Act**|KhÃ´ng Ä‘Æ°á»£c Ä‘Æ°a ra investment advice trá»±c tiáº¿p|â€¢ Äá»‹nh vá»‹: â€œresearch toolâ€  <br>â€¢ Disclaimers rÃµ rÃ ng  <br>â€¢ No buy/sell recommendations|
|**GDPR (EU users)**|Xá»­ lÃ½ dá»¯ liá»‡u cÃ¡ nhÃ¢n|â€¢ User consent  <br>â€¢ Data encryption  <br>â€¢ Right to erasure|
|**CCPA (CA users)**|California privacy law|â€¢ Transparency  <br>â€¢ Opt-out mechanism|
|**SOC 2 Type II**|Enterprise customers|â€¢ Audit trail  <br>â€¢ Access control  <br>â€¢ Incident response plan|

### 3.6 Phá»¥ Thuá»™c

```mermaid
graph LR
    A[finAI Agent] --> B[LangGraph Framework]
    A --> C[OpenAI/Anthropic APIs]
    A --> D[Playwright Library]
    A --> E[Financial Websites]
    
    E --> F[SEC Edgar]
    E --> G[Yahoo Finance]
    E --> H[Seeking Alpha]
    
    B --> I[Python 3.11+]
    
    style A fill:#6366f1,stroke:#4f46e5,color:#fff
    style C fill:#ef4444,stroke:#dc2626,color:#fff
    style E fill:#f59e0b,stroke:#d97706,color:#fff
```

|Phá»¥ Thuá»™c|Chá»§ Sá»Ÿ Há»¯u|Rá»§i Ro|Dá»± PhÃ²ng|
|---|---|---|---|
|**OpenAI API (GPT-4o)**|External|Cao (rate limits, downtime, pricing)|â€¢ Anthropic Claude Sonnet 3.5 fallback  <br>â€¢ Local LLM cho simple tasks  <br>â€¢ Exponential backoff retry|
|**Anthropic Claude API**|External|Trung bÃ¬nh|â€¢ OpenAI fallback  <br>â€¢ Queue tasks during outage|
|**Playwright**|Open Source|Tháº¥p (mature, stable)|â€¢ Selenium fallback  <br>â€¢ Fork if needed|
|**LangGraph**|LangChain (LangChain Inc.)|Tháº¥p-Trung bÃ¬nh (young but active)|â€¢ Abstract agent logic  <br>â€¢ Could migrate to custom framework|
|**Financial Websites**|External|Cao (structure changes, blocking)|â€¢ A11y Tree primary (more stable)  <br>â€¢ Vision fallback  <br>â€¢ Stealth techniques  <br>â€¢ User reports for breaking changes|

---

## 4. Tá»”NG QUAN Há»† THá»NG

### 4.1 Bá»‘i Cáº£nh Kinh Doanh

#### Váº¥n Äá»

**Current State (Hiá»‡n Táº¡i):**

- PhÃ¢n tÃ­ch viÃªn/Cá»‘ váº¥n tÃ i chÃ­nh máº¥t **5-10 giá»** Ä‘á»ƒ nghiÃªn cá»©u má»™t cá»• phiáº¿u
- Pháº£i thao tÃ¡c thá»§ cÃ´ng vá»›i **10-50 tabs**: SEC filings, earnings calls, news, screener, broker reports
- **Quy trÃ¬nh hiá»‡n táº¡i**:
    1. TÃ¬m kiáº¿m ticker â†’ Má»Ÿ nhiá»u trang
    2. Äá»c 30-50 trang bÃ¡o cÃ¡o PDF
    3. Copy-paste thá»§ cÃ´ng vÃ o Excel/Notion
    4. Tá»± tá»•ng há»£p vÃ  phÃ¢n tÃ­ch
    5. Viáº¿t memo

**Pain Points:**

- âŒ **Tá»‘n thá»i gian**: 80% thá»i gian lÃ  thu tháº­p dá»¯ liá»‡u thá»§ cÃ´ng
- âŒ **Dá»… bá» sÃ³t**: KhÃ´ng thá»ƒ Ä‘á»c háº¿t má»i nguá»“n
- âŒ **Thiáº¿u nháº¥t quÃ¡n**: Má»—i phÃ¢n tÃ­ch viÃªn cÃ³ quy trÃ¬nh riÃªng
- âŒ **KhÃ´ng scale**: KhÃ´ng thá»ƒ nghiÃªn cá»©u nhiá»u cá»• phiáº¿u cÃ¹ng lÃºc

#### Giáº£i PhÃ¡p

**finAI Finance Agent Web Browser** tá»± Ä‘á»™ng hÃ³a toÃ n bá»™ quy trÃ¬nh:

1. **Input**: NgÆ°á»i dÃ¹ng nháº­p Ã½ Ä‘á»‹nh (vÃ­ dá»¥: â€œPhÃ¢n tÃ­ch rá»§i ro thanh khoáº£n cá»§a VCBâ€)
2. **Autonomous Research**: Agent tá»± Ä‘á»™ng:
    - Äiá»u hÆ°á»›ng Ä‘áº¿n cÃ¡c nguá»“n liÃªn quan (SEC, Yahoo Finance, news)
    - TrÃ­ch xuáº¥t dá»¯ liá»‡u quan trá»ng (financial metrics, risks, management commentary)
    - PhÃ¢n tÃ­ch Ä‘a nguá»“n (cross-check, identify conflicts)
3. **Output**: 1-Page Investment Snapshot vá»›i:
    - Executive summary
    - Key metrics (revenue, margin, debt, etc.)
    - Risk analysis
    - Management quality assessment
    - Competitive positioning
    - **Evidence Pack**: Má»i sá»‘ liá»‡u Ä‘á»u cÃ³ nguá»“n trÃ­ch dáº«n

**Value Proposition:**

> â€œGiáº£m thá»i gian nghiÃªn cá»©u tá»« 5-10 giá» xuá»‘ng <30 phÃºt vá»›i Ä‘á»™ chÃ­nh xÃ¡c >99% vÃ  Ä‘áº§y Ä‘á»§ trÃ­ch dáº«n nguá»“n.â€

#### GiÃ¡ Trá»‹

**LÆ°á»£ng HÃ³a:**

- **ROI cho ngÆ°á»i dÃ¹ng**:
    
    - PhÃ¢n tÃ­ch viÃªn lÆ°Æ¡ng $80K/nÄƒm = $40/giá»
    - Tiáº¿t kiá»‡m 5 giá»/nghiÃªn cá»©u = $200/nghiÃªn cá»©u
    - Náº¿u lÃ m 10 nghiÃªn cá»©u/thÃ¡ng â†’ Tiáº¿t kiá»‡m $2,000/thÃ¡ng
    - finAI giÃ¡ $200/thÃ¡ng â†’ ROI = 10x
- **Cho doanh nghiá»‡p**:
    
    - Vá»›i 10 phÃ¢n tÃ­ch viÃªn: Tiáº¿t kiá»‡m $20K/thÃ¡ng = $240K/nÄƒm
    - TÄƒng nÄƒng suáº¥t â†’ CÃ³ thá»ƒ nghiÃªn cá»©u nhiá»u hÆ¡n 10x
    - Cháº¥t lÆ°á»£ng nháº¥t quÃ¡n, Ã­t sai sÃ³t

### 4.2 BÃªn LiÃªn Quan

|BÃªn LiÃªn Quan|Quan TÃ¢m|Giao Tiáº¿p|
|---|---|---|
|**Executives (C-level)**|ROI, Timeline, Competitive advantage|BÃ¡o cÃ¡o thÃ¡ng|
|**Product Manager**|Features, User experience, Adoption|Tuáº§n 2 láº§n|
|**Engineering Team**|Architecture, Technical debt, Velocity|HÃ ng ngÃ y|
|**ML Team**|Agent performance, Accuracy, Cost|Tuáº§n 2 láº§n|
|**QA Team**|Test coverage, Bug rate|HÃ ng ngÃ y|
|**Operations/SRE**|Stability, Incidents, On-call|HÃ ng ngÃ y|
|**Security Team**|Vulnerabilities, Compliance|HÃ ng tuáº§n|
|**End Users (Analysts)**|Speed, Accuracy, Ease of use|Feedback loop, surveys|
|**Legal/Compliance**|Regulatory compliance, Disclaimers|Khi cáº§n|

### 4.3 YÃªu Cáº§u Chá»©c NÄƒng

|ID|Module|MÃ´ Táº£|Äá»™ Æ¯u TiÃªn|TiÃªu ChÃ­ Cháº¥p Nháº­n|
|---|---|---|---|---|
|**FR-001**|Intent Input|NgÆ°á»i dÃ¹ng nháº­p Ã½ Ä‘á»‹nh nghiÃªn cá»©u báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn|P0|â€¢ Há»— trá»£ tiáº¿ng Anh  <br>â€¢ Parse entity (ticker, timeframe, metrics)  <br>â€¢ Validation & feedback  <br>â€¢ <2s response time|
|**FR-002**|Web Navigation|Agent tá»± Ä‘á»™ng Ä‘iá»u hÆ°á»›ng Ä‘áº¿n cÃ¡c trang web tÃ i chÃ­nh|P0|â€¢ Navigate Ä‘áº¿n SEC, Yahoo Finance, news sites  <br>â€¢ Handle redirects, pop-ups  <br>â€¢ Timeout protection (30s/page)|
|**FR-003**|Data Extraction|TrÃ­ch xuáº¥t dá»¯ liá»‡u tá»« financial documents (10-K, earnings, news)|P0|â€¢ Extract tables, text, metrics  <br>â€¢ >99% accuracy cho structured data  <br>â€¢ Support PDF, HTML, plain text|
|**FR-004**|Multi-Source Synthesis|Tá»•ng há»£p thÃ´ng tin tá»« â‰¥3 nguá»“n|P0|â€¢ Identify conflicts  <br>â€¢ Weight sources by credibility  <br>â€¢ Generate unified view|
|**FR-005**|Risk Analysis|PhÃ¢n tÃ­ch rá»§i ro tá»« dá»¯ liá»‡u thu tháº­p|P0|â€¢ Identify financial risks (liquidity, leverage, concentration)  <br>â€¢ Confidence scoring  <br>â€¢ Evidence-based|
|**FR-006**|Evidence Pack|Cung cáº¥p nguá»“n trÃ­ch dáº«n cho má»i thÃ´ng tin|P0|â€¢ Link back to original document  <br>â€¢ Quote verbatim  <br>â€¢ Confidence score per fact|
|**FR-007**|1-Page Snapshot|Tá»•ng há»£p káº¿t quáº£ thÃ nh 1 trang|P0|â€¢ Executive summary  <br>â€¢ Key metrics  <br>â€¢ Risks  <br>â€¢ Next steps  <br>â€¢ Exportable (PDF, Markdown)|
|**FR-008**|Agent Status Panel|Hiá»ƒn thá»‹ tráº¡ng thÃ¡i Agent real-time|P0|â€¢ Current step  <br>â€¢ Progress bar  <br>â€¢ Evidence collected  <br>â€¢ â€œTake Controlâ€ button|
|**FR-009**|Error Handling|Xá»­ lÃ½ lá»—i vÃ  retry|P0|â€¢ Max 3 retries  <br>â€¢ Graceful degradation  <br>â€¢ User notification|
|**FR-010**|HITL (Human-in-the-Loop)|YÃªu cáº§u xÃ¡c nháº­n cho tÃ¡c vá»¥ quan trá»ng|P0|â€¢ Pop-up confirmation  <br>â€¢ <10s response time  <br>â€¢ Can abort|

### 4.4 User Stories (Gherkin)

#### Story 1: Stock Research

```gherkin
TÃ­nh NÄƒng: NghiÃªn Cá»©u Cá»• Phiáº¿u Tá»± Äá»™ng
  LÃ  má»™t phÃ¢n tÃ­ch viÃªn tÃ i chÃ­nh
  TÃ´i muá»‘n nghiÃªn cá»©u má»™t cá»• phiáº¿u nhanh chÃ³ng
  Äá»ƒ tÃ´i cÃ³ thá»ƒ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh Ä‘áº§u tÆ° sÃ¡ng suá»‘t

  Ká»‹ch Báº£n: NghiÃªn cá»©u thÃ nh cÃ´ng
    Cho tÃ´i Ä‘Ã£ Ä‘Äƒng nháº­p vÃ o finAI
    Khi tÃ´i nháº­p "PhÃ¢n tÃ­ch rá»§i ro thanh khoáº£n cá»§a Tesla (TSLA)"
    ThÃ¬ Agent báº¯t Ä‘áº§u hoáº¡t Ä‘á»™ng
    VÃ  tÃ´i tháº¥y Agent Status Panel hiá»ƒn thá»‹ tiáº¿n trÃ¬nh
    VÃ  trong <8 phÃºt, Agent tráº£ vá» 1-Page Snapshot
    VÃ  Snapshot bao gá»“m:
      | Pháº§n | Ná»™i Dung |
      | Executive Summary | TÃ³m táº¯t 2-3 cÃ¢u |
      | Liquidity Metrics | Current ratio, Quick ratio, Cash flow |
      | Risks Identified | Top 3 rá»§i ro thanh khoáº£n |
      | Evidence Pack | TrÃ­ch dáº«n tá»« 10-K, earnings call |
    VÃ  má»i sá»‘ liá»‡u Ä‘á»u cÃ³ link Ä‘áº¿n nguá»“n gá»‘c
    
  Ká»‹ch Báº£n: Agent gáº·p lá»—i - cÃ³ retry
    Cho Agent Ä‘ang truy cáº­p trang SEC Edgar
    Khi trang bá»‹ timeout
    ThÃ¬ Agent retry 3 láº§n vá»›i exponential backoff
    VÃ  náº¿u váº«n tháº¥t báº¡i, Agent sá»­ dá»¥ng nguá»“n thay tháº¿ (Yahoo Finance)
    VÃ  thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng "KhÃ´ng thá»ƒ truy cáº­p SEC, Ä‘Ã£ dÃ¹ng Yahoo Finance"
    
  Ká»‹ch Báº£n: HITL - XÃ¡c nháº­n hÃ nh Ä‘á»™ng quan trá»ng
    Cho Agent Ä‘Ã£ tÃ¬m tháº¥y form SEC cÃ³ file PDF lá»›n (50MB)
    Khi Agent chuáº©n bá»‹ táº£i xuá»‘ng
    ThÃ¬ hiá»‡n pop-up xÃ¡c nháº­n: "Sáº¯p táº£i 50MB file PDF. XÃ¡c nháº­n?"
    VÃ  ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ "Approve" hoáº·c "Skip"
    VÃ  náº¿u Skip, Agent sá»­ dá»¥ng alternative source
```

#### Story 2: Comparative Analysis

```gherkin
TÃ­nh NÄƒng: So SÃ¡nh Nhiá»u Cá»• Phiáº¿u
  LÃ  má»™t cá»‘ váº¥n tÃ i chÃ­nh
  TÃ´i muá»‘n so sÃ¡nh 3 cá»• phiáº¿u cÃ¹ng ngÃ nh
  Äá»ƒ Ä‘Æ°a ra khuyáº¿n nghá»‹ cho khÃ¡ch hÃ ng

  Ká»‹ch Báº£n: So sÃ¡nh thÃ nh cÃ´ng
    Cho tÃ´i Ä‘Ã£ Ä‘Äƒng nháº­p
    Khi tÃ´i nháº­p "So sÃ¡nh VCB, TCB, MBB vá» ROE vÃ  ROA"
    ThÃ¬ Agent thu tháº­p dá»¯ liá»‡u cá»§a cáº£ 3 ngÃ¢n hÃ ng
    VÃ  trong <15 phÃºt, tráº£ vá» báº£ng so sÃ¡nh:
      | NgÃ¢n hÃ ng | ROE | ROA | Nguá»“n |
      | VCB | 21.5% | 1.8% | VCB Annual Report 2023 |
      | TCB | 18.3% | 1.5% | TCB Q4 2023 Earnings |
      | MBB | 19.1% | 1.6% | MBB 10-K 2023 |
    VÃ  cÃ³ phÃ¢n tÃ­ch: "VCB dáº«n Ä‘áº§u vá» ROE vÃ  ROA"
```

---

## 5. THIáº¾T Káº¾ Tá»”NG THá»‚ (HLD)

### 5.1 MÃ´ HÃ¬nh Kiáº¿n TrÃºc

#### Lá»±a Chá»n: 4-Layer Architecture vá»›i LangGraph Agent Core

**Rationale (LÃ½ do lá»±a chá»n):**

- âœ… **Separation of Concerns**: Má»—i layer cÃ³ trÃ¡ch nhiá»‡m rÃµ rÃ ng
- âœ… **Modularity**: Dá»… test, maintain, extend
- âœ… **Agent-First**: Tá»‘i Æ°u cho AI Agent vá»›i state management (LangGraph)
- âœ… **Production-Ready**: Governance layer Ä‘áº£m báº£o safety & control
- âœ… **Scalability**: Má»—i layer cÃ³ thá»ƒ scale Ä‘á»™c láº­p

**NguyÃªn Táº¯c ChÃ­nh:**

- **SOLID Principles**: Trong thiáº¿t káº¿ class/module
- **MECE Framework**: Mutually Exclusive, Collectively Exhaustive
- **Agent Pattern**: Perception â†’ Cognition â†’ Action â†’ Verification loop
- **Zero Trust Security**: KhÃ´ng tin tÆ°á»Ÿng báº¥t ká»³ input/output nÃ o mÃ  khÃ´ng verify

#### So SÃ¡nh CÃ¡c MÃ´ HÃ¬nh Kiáº¿n TrÃºc (MECE Analysis)

TrÆ°á»›c khi chá»n kiáº¿n trÃºc cuá»‘i cÃ¹ng, chÃºng ta Ä‘Ã£ phÃ¢n tÃ­ch 4 mÃ´ hÃ¬nh khÃ¡c nhau:

|MÃ´ HÃ¬nh|MÃ´ Táº£|Æ¯u Äiá»ƒm|NhÆ°á»£c Äiá»ƒm|Äiá»ƒm Sá»‘|
|---|---|---|---|---|
|**1. Monolithic Agent**|Má»™t agent duy nháº¥t xá»­ lÃ½ má»i thá»©|â€¢ ÄÆ¡n giáº£n  <br>â€¢ Dá»… debug ban Ä‘áº§u|â€¢ KhÃ³ maintain  <br>â€¢ KhÃ´ng scale  <br>â€¢ KhÃ´ng modular|3/10|
|**2. Pipeline Linear**|Chain of fixed steps: Fetch â†’ Parse â†’ Analyze â†’ Synthesize|â€¢ Dá»… hiá»ƒu  <br>â€¢ Predictable|â€¢ KhÃ´ng flexible  <br>â€¢ KhÃ´ng self-correct  <br>â€¢ Fail náº¿u 1 step fails|5/10|
|**3. Multi-Agent Micro-services**|Nhiá»u agent Ä‘á»™c láº­p (Planner, Executor, Healer, etc.) giao tiáº¿p qua messages|â€¢ Highly modular  <br>â€¢ Parallel processing  <br>â€¢ Scale tá»«ng agent|â€¢ QuÃ¡ phá»©c táº¡p  <br>â€¢ Network overhead  <br>â€¢ Orchestration hell|6/10|
|**4. 4-Layer + LangGraph**|4 layers (Perception, Cognition, Action, Governance) vá»›i LangGraph state machine trong Cognition|â€¢ Modular nhÆ°ng khÃ´ng quÃ¡ phá»©c táº¡p  <br>â€¢ Self-correcting (Replan node)  <br>â€¢ Clear separation  <br>â€¢ Production-ready|â€¢ Cáº§n há»c LangGraph  <br>â€¢ HÆ¡i phá»©c táº¡p hÆ¡n Pipeline|**9/10** âœ…|

**Quyáº¿t Äá»‹nh**: Chá»n **MÃ´ HÃ¬nh 4** (4-Layer + LangGraph)

**LÃ½ do chi tiáº¿t**:

1. **Balance Complexity vs Capability**: KhÃ´ng quÃ¡ Ä‘Æ¡n giáº£n (Pipeline) nhÆ°ng cÅ©ng khÃ´ng quÃ¡ phá»©c táº¡p (Multi-Agent Microservices)
2. **LangGraph Built for Agents**: LangGraph Ä‘Æ°á»£c thiáº¿t káº¿ chuyÃªn cho stateful agents vá»›i:
    - State management tá»‘t
    - Conditional edges (if-else logic trong graph)
    - Checkpointing (cÃ³ thá»ƒ pause/resume)
    - Tracing & debugging built-in
3. **Proven Pattern**: 4-Layer architecture lÃ  best practice tá»« production systems (OpenAI Operator, Perplexity Comet)
4. **Governance Layer**: Critical cho financial domain - built-in tá»« Ä‘áº§u, khÃ´ng pháº£i retrofit sau

### 5.2 System Context (C4 Level 1)

```mermaid
graph TB
    subgraph "SYSTEM CONTEXT"
        User([ğŸ‘¤ NGÆ¯á»œI DÃ™NG<br/>PhÃ¢n TÃ­ch ViÃªn/Cá»‘ Váº¥n])
        
        System["ğŸ§  finAI Finance Agent<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Tá»± Ä‘á»™ng nghiÃªn cá»©u cá»• phiáº¿u<br/>â€¢ TrÃ­ch xuáº¥t & phÃ¢n tÃ­ch dá»¯ liá»‡u tÃ i chÃ­nh<br/>â€¢ Tá»•ng há»£p Ä‘a nguá»“n<br/>â€¢ Äáº£m báº£o Ä‘á»™ chÃ­nh xÃ¡c cao"]
        
        SEC["ğŸ“Š SEC Edgar<br/>10-K, 10-Q, 8-K filings"]
        Yahoo["ğŸ“ˆ Yahoo Finance<br/>Real-time quotes, news"]
        News["ğŸ“° Financial News<br/>Bloomberg, Reuters, etc."]
        
        OpenAI["ğŸ¤– OpenAI API<br/>GPT-4o"]
        Anthropic["ğŸ¤– Anthropic API<br/>Claude 3.5 Sonnet"]
        
        User -->|Input: Research Intent| System
        System -->|Output: Investment Snapshot| User
        
        System -->|Crawl & Extract| SEC
        System -->|Fetch Data| Yahoo
        System -->|Read Articles| News
        
        System -->|Reasoning Calls| OpenAI
        System -->|Reasoning Calls| Anthropic
    end
    
    style User fill:#6366f1,stroke:#4f46e5,stroke-width:3px,color:#fff
    style System fill:#78350f,stroke:#f59e0b,stroke-width:4px,color:#fff
    style SEC fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style Yahoo fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style News fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style OpenAI fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:#fff
    style Anthropic fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:#fff
```

### 5.3 Container Diagram (C4 Level 2)

```mermaid
graph TB
    subgraph "PRESENTATION LAYER"
        WebExt["ğŸ”Œ Chrome Extension<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Intention Bar<br/>â€¢ Agent Status Panel<br/>â€¢ Evidence Display"]
    end
    
    subgraph "API GATEWAY"
        Gateway["ğŸšª API Gateway<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ Auth (JWT)<br/>â€¢ Rate Limiting<br/>â€¢ Request Routing"]
    end
    
    subgraph "AGENT CORE SERVICES"
        direction TB
        
        AgentAPI["ğŸ¯ Agent API Service<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>FastAPI<br/>â€¢ Session Management<br/>â€¢ Task Orchestration"]
        
        AgentEngine["ğŸ§  Agent Engine<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>LangGraph Core<br/>â€¢ Perception<br/>â€¢ Cognition (Planner, Executor, Verifier, Replan)<br/>â€¢ Action<br/>â€¢ Governance"]
        
        BrowserCtrl["ğŸŒ Browser Controller<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Playwright<br/>â€¢ Navigation<br/>â€¢ Extraction<br/>â€¢ Action Execution"]
    end
    
    subgraph "DATA LAYER"
        direction LR
        Postgres[(PostgreSQL<br/>User, Session, Task)]
        Redis[(Redis<br/>Short-term Memory)]
        Pinecone[(Pinecone<br/>Long-term Memory/RAG)]
    end
    
    subgraph "EXTERNAL SERVICES"
        LLM["ğŸ¤– LLM APIs<br/>GPT-4o / Claude 3.5"]
        FinSites["ğŸ“Š Financial Sites<br/>SEC, Yahoo, News"]
    end
    
    WebExt <--> Gateway
    Gateway <--> AgentAPI
    AgentAPI <--> AgentEngine
    AgentEngine <--> BrowserCtrl
    
    AgentEngine <--> Postgres
    AgentEngine <--> Redis
    AgentEngine <--> Pinecone
    AgentEngine <--> LLM
    
    BrowserCtrl <--> FinSites
    
    style WebExt fill:#1e3a8a,stroke:#3b82f6,stroke-width:3px,color:#fff
    style Gateway fill:#7c3aed,stroke:#6d28d9,stroke-width:3px,color:#fff
    style AgentAPI fill:#78350f,stroke:#f59e0b,stroke-width:3px,color:#fff
    style AgentEngine fill:#78350f,stroke:#f59e0b,stroke-width:4px,color:#fff
    style BrowserCtrl fill:#064e3b,stroke:#10b981,stroke-width:3px,color:#fff
    style Postgres fill:#1e40af,stroke:#1e3a8a,stroke-width:2px,color:#fff
    style Redis fill:#dc2626,stroke:#991b1b,stroke-width:2px,color:#fff
    style Pinecone fill:#7c3aed,stroke:#6d28d9,stroke-width:2px,color:#fff
```

### 5.4 Kiáº¿n TrÃºc 4-Layer Chi Tiáº¿t

```mermaid
flowchart TB
    User([ğŸ‘¤ USER INPUT<br/>Natural Language Intent])
    
    subgraph L1["ğŸ” LAYER 1: PERCEPTION - Browser State Awareness"]
        direction TB
        
        subgraph InputProc["ğŸ“¥ Input Processor"]
            IP1["ğŸ­ Modality Handler<br/>â”â”â”â”â”â”â”â”â”<br/>Text/Voice â†’ Normalized"]
            IP2["ğŸ›¡ï¸ Safety Guard<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Prompt Injection Filter<br/>â€¢ PII Detection"]
            IP3["âš™ï¸ Intent Parser<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Entity Extraction (ticker, timeframe)<br/>â€¢ Intent Classification"]
            IP1 --> IP2 --> IP3
        end
        
        subgraph BrowserMon["ğŸŒ Browser Monitor"]
            BM1["ğŸ“Š Page State Tracker<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Current URL<br/>â€¢ Load Status<br/>â€¢ Errors"]
            BM2["ğŸŒ³ Content Extractor<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ A11y Tree (Primary 90%)<br/>â€¢ DOM Snapshot (Backup)<br/>â€¢ Screenshot (Fallback 10%)"]
            BM3["ğŸ” Change Detector<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ DOM Mutations<br/>â€¢ Network Events"]
            BM1 --> BM2 --> BM3
        end
        
        IP3 --> UC["ğŸ“‹ UNIFIED CONTEXT<br/>â”â”â”â”â”â”â”â”â”<br/>{intent, page_state, history}"]
        BM3 --> UC
    end
    
    subgraph L2["ğŸ§  LAYER 2: COGNITION - Agent Brain (LangGraph Core)"]
        direction TB
        
        UC --> StateGraph["ğŸ“Š LangGraph StateGraph<br/>â”â”â”â”â”â”â”â”â”<br/>State Machine with Checkpointing"]
        
        subgraph Nodes["ğŸ¯ Core Nodes (ReAct Pattern)"]
            direction LR
            N1["ğŸ’­ PLANNER<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ CoT Reasoning<br/>â€¢ Action Selection<br/>â€¢ Tool Binding"]
            N2["âš¡ EXECUTOR<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Tool Invocation<br/>â€¢ Retry Logic<br/>â€¢ Result Parsing"]
            N3["âœ… VERIFIER<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Success Check<br/>â€¢ Data Validation<br/>â€¢ Confidence Score"]
            N4["ğŸ”„ REPLAN<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Error Analysis<br/>â€¢ Strategy Adjust<br/>â€¢ Fallback Logic"]
            
            N1 --> N2
            N2 --> N3
            N3 -->|Success & Continue| N1
            N3 -->|Failure| N4
            N4 --> N1
            N3 -->|Goal Achieved| Synth["ğŸ“ SYNTHESIZER<br/>â”â”â”â”â”â”â”â”â”<br/>Generate Report"]
        end
        
        StateGraph --> Nodes
        
        subgraph Memory["ğŸ’¾ Memory System"]
            M1["âš¡ Short-term<br/>â”â”â”â”â”â”â”â”â”<br/>Redis<br/>Session Context"]
            M2["ğŸ—„ï¸ Long-term<br/>â”â”â”â”â”â”â”â”â”<br/>Pinecone<br/>RAG + Patterns"]
        end
        
        Nodes <-.->|Read/Write| Memory
        
        Synth --> Decision["ğŸ“‹ ACTION DECISION<br/>â”â”â”â”â”â”â”â”â”<br/>{tool, params, confidence}"]
    end
    
    subgraph L3["âš¡ LAYER 3: ACTION - Browser Control & Execution"]
        direction TB
        
        Decision --> ToolReg["ğŸ”§ Tool Registry"]
        
        subgraph BrowserTools["ğŸŒ Browser Interaction Tools"]
            T1["navigate"]
            T2["click"]
            T3["fill"]
            T4["extract_text"]
            T5["extract_table"]
            T6["screenshot"]
        end
        
        ToolReg --> BrowserTools
        
        subgraph Executor["ğŸš€ Execution Engine"]
            E1["ğŸ“ Playwright Controller<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Browser Pool<br/>â€¢ Context Manager"]
            E2["ğŸ”§ Error Handler<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ Retry 3x<br/>â€¢ Fallback"]
            E3["ğŸ“¦ Result Parser<br/>â”â”â”â”â”â”â”â”â”<br/>â€¢ A11y â†’ JSON<br/>â€¢ HTML â†’ Markdown"]
            E1 --> E2 --> E3
        end
        
        BrowserTools --> Executor
        
        Executor --> Browser["ğŸŒ HEADLESS CHROMIUM<br/>â”â”â”â”â”â”â”â”â”<br/>Sandboxed"]
        
        Browser --> Result["ğŸ“‹ EXECUTION RESULT<br/>â”â”â”â”â”â”â”â”â”<br/>{status, data, screenshot, error}"]
    end
    
    subgraph L4["ğŸ›¡ï¸ LAYER 4: GOVERNANCE - Safety & Human Control"]
        direction TB
        
        subgraph Guardrails["âš–ï¸ Guardrails"]
            G1["URL Whitelist"]
            G2["PII Detection"]
            G3["Cost Threshold"]
            G4["Action Risk Check"]
        end
        
        subgraph HITL["ğŸ‘¤ Human-in-the-Loop"]
            H1["ğŸ›‘ Checkpoint Trigger<br/>â”â”â”â”â”â”â”â”â”<br/>High-risk actions"]
            H2["ğŸ–¥ï¸ Review UI<br/>â”â”â”â”â”â”â”â”â”<br/>Show plan & preview"]
            H3["ğŸ”º Escalation<br/>â”â”â”â”â”â”â”â”â”<br/>Expert routing"]
        end
    end
    
    Result --> L1
    
    L4 -.->|Monitor & Control| L2
    L4 -.->|Block if Unsafe| L3
    
    Result --> Check{Goal<br/>Achieved?}
    Check -->|No| L2
    Check -->|Yes| Output([ğŸ“¤ FINAL OUTPUT<br/>Investment Snapshot + Evidence Pack])
    
    User --> L1
    Output --> User
    H2 -.->|Approval Required| User
    
    subgraph External["â˜ï¸ EXTERNAL SERVICES"]
        LLM["ğŸ¤– LLM APIs"]
        DB["ğŸ—„ï¸ Data Stores"]
        Obs["ğŸ“Š Observability"]
    end
    
    L2 -.->|Reasoning| LLM
    Memory -.->|Persist| DB
    L1 -.->|Logs| Obs
    L2 -.->|Traces| Obs
    L3 -.->|Metrics| Obs
    
    style L1 fill:#1e3a8a,stroke:#3b82f6,stroke-width:4px,color:#fff
    style L2 fill:#78350f,stroke:#f59e0b,stroke-width:4px,color:#fff
    style L3 fill:#064e3b,stroke:#10b981,stroke-width:4px,color:#fff
    style L4 fill:#7f1d1d,stroke:#ef4444,stroke-width:4px,color:#fff
    
    style User fill:#6366f1,stroke:#4f46e5,stroke-width:3px,color:#fff
    style Output fill:#22c55e,stroke:#16a34a,stroke-width:3px,color:#fff
    style Browser fill:#0891b2,stroke:#0e7490,stroke-width:3px,color:#fff
    style External fill:#64748b,stroke:#475569,stroke-width:2px,color:#fff
    
    style UC fill:#fbbf24,stroke:#f59e0b,stroke-width:2px,color:#000
    style StateGraph fill:#fb923c,stroke:#ea580c,stroke-width:2px,color:#fff
    style Decision fill:#fbbf24,stroke:#f59e0b,stroke-width:2px,color:#000
    style Result fill:#86efac,stroke:#22c55e,stroke-width:2px,color:#000
    style Check fill:#f87171,stroke:#dc2626,stroke-width:3px,color:#fff
```

### 5.5 Technology Stack

|Lá»›p|CÃ´ng Nghá»‡|LÃ½ Do Lá»±a Chá»n|PhiÃªn Báº£n|
|---|---|---|---|
|**Backend Core**|Python 3.11|â€¢ Best ecosystem cho AI/ML  <br>â€¢ LangGraph native  <br>â€¢ Playwright support  <br>â€¢ Async support|3.11+|
|**Agent Framework**|LangGraph|â€¢ Purpose-built cho stateful agents  <br>â€¢ Conditional edges  <br>â€¢ Checkpointing  <br>â€¢ Debugging tools  <br>â€¢ Production-ready|Latest|
|**Web Automation**|Playwright|â€¢ Modern, fast  <br>â€¢ Better than Selenium  <br>â€¢ Auto-waiting  <br>â€¢ Multi-browser  <br>â€¢ Network interception|Latest|
|**API Framework**|FastAPI|â€¢ High performance (async)  <br>â€¢ OpenAPI auto-gen  <br>â€¢ Type safety (Pydantic)  <br>â€¢ WebSocket support|Latest|
|**Primary Database**|PostgreSQL 15|â€¢ ACID compliance (critical for finance)  <br>â€¢ JSONB support  <br>â€¢ Rich extensions  <br>â€¢ Mature ecosystem|15.x|
|**Cache**|Redis 7|â€¢ Sub-ms latency  <br>â€¢ Flexible data structures  <br>â€¢ Pub/sub for events|7.x|
|**Vector DB**|Pinecone|â€¢ Managed service  <br>â€¢ Low latency  <br>â€¢ Good for RAG  <br>â€¢ Scale automatically|Cloud|
|**LLM Primary**|GPT-4o|â€¢ Best reasoning  <br>â€¢ Function calling  <br>â€¢ Vision capability|gpt-4o-2024-11-20|
|**LLM Secondary**|Claude 3.5 Sonnet|â€¢ Better for long context  <br>â€¢ Lower cost for some tasks  <br>â€¢ Good fallback|claude-3-5-sonnet-20241022|
|**LLM for Simple**|Gemini 2.0 Flash|â€¢ Very cheap ($0.10/1M tokens)  <br>â€¢ Fast  <br>â€¢ Good for simple extraction|gemini-2.0-flash-exp|
|**Container**|Docker|â€¢ Consistency across envs  <br>â€¢ Easy deployment|Latest|
|**Orchestration**|Kubernetes (EKS)|â€¢ Auto-scaling  <br>â€¢ Self-healing  <br>â€¢ Rolling updates|1.28+|
|**CI/CD**|GitHub Actions|â€¢ Native GitHub integration  <br>â€¢ Free for private repos  <br>â€¢ Good marketplace|N/A|
|**IaC**|Terraform|â€¢ Multi-cloud  <br>â€¢ Declarative  <br>â€¢ State management|1.6+|
|**Monitoring**|Datadog|â€¢ All-in-one (metrics, logs, traces)  <br>â€¢ APM built-in  <br>â€¢ Good alerting|Cloud|
|**Tracing**|LangSmith|â€¢ Purpose-built for LangChain/LangGraph  <br>â€¢ Excellent debugging  <br>â€¢ Cost tracking|Cloud|
|**Frontend**|React 18 + TypeScript|â€¢ Component reusability  <br>â€¢ Type safety  <br>â€¢ Good ecosystem|Latest|

### 5.6 Communication Patterns

|Pattern|Use Case|Protocol|Implementation|
|---|---|---|---|
|**Sync Request/Response**|User â†’ Agent API|REST HTTP/2|â€¢ FastAPI endpoint  <br>â€¢ Timeout 30s  <br>â€¢ Retry with backoff|
|**Async Task**|Long-running research|WebSocket|â€¢ Real-time status updates  <br>â€¢ Progress streaming  <br>â€¢ Can cancel|
|**Event-Driven**|Agent internal|LangGraph State|â€¢ Node transitions  <br>â€¢ Conditional routing  <br>â€¢ State persistence|
|**Cache Read**|Memory access|Redis protocol|â€¢ Pipeline commands  <br>â€¢ Connection pooling|
|**Vector Search**|RAG retrieval|Pinecone gRPC|â€¢ Batch queries  <br>â€¢ Filtered search|

---

## 6. THIáº¾T Káº¾ CHI TIáº¾T (LLD)

### 6.1 Layer 1: PERCEPTION - Browser State Awareness

#### 6.1.1 Input Processor

```python
## src/perception/input_processor.py

from dataclasses import dataclass
from typing import Optional
import re

@dataclass
class ParsedIntent:
    """Ã Ä‘á»‹nh Ä‘Ã£ Ä‘Æ°á»£c parse tá»« input ngÆ°á»i dÃ¹ng"""
    raw_input: str
    intent_type: str  ## 'research', 'compare', 'monitor'
    entities: dict    ## {'ticker': 'TSLA', 'metrics': ['liquidity'], 'timeframe': 'Q4 2024'}
    constraints: dict ## {'max_sources': 5, 'priority': 'speed'}
    confidence: float ## 0.0-1.0

class InputProcessor:
    """
    Xá»­ lÃ½ input ngÆ°á»i dÃ¹ng thÃ nh Parsed Intent
    
    Responsibilities:
    - Normalize text (lowercase, remove special chars)
    - Safety check (prompt injection, PII)
    - Entity extraction (ticker, metrics, timeframe)
    - Intent classification
    """
    
    def __init__(self, llm_client, safety_guard):
        self.llm = llm_client
        self.safety = safety_guard
        
    async def process(self, user_input: str) -> ParsedIntent:
        """
        Main processing pipeline
        
        Steps:
        1. Normalize text
        2. Safety check
        3. Entity extraction
        4. Intent classification
        
        Raises:
            SecurityException: Náº¿u phÃ¡t hiá»‡n malicious input
            ValidationError: Náº¿u input khÃ´ng há»£p lá»‡
        """
        ## 1. Normalize
        normalized = self._normalize(user_input)
        
        ## 2. Safety check
        if not await self.safety.is_safe(normalized):
            raise SecurityException("Detected malicious input")
        
        ## 3. Extract entities + classify intent
        intent = await self._parse_with_llm(normalized)
        
        return intent
        
    def _normalize(self, text: str) -> str:
        """Chuáº©n hÃ³a text"""
        ## Remove excessive whitespace
        text = re.sub(r'\s+', ' ', text).strip()
        
        ## Remove non-printable characters
        text = ''.join(char for char in text if char.isprintable())
        
        return text
        
    async def _parse_with_llm(self, text: str) -> ParsedIntent:
        """Sá»­ dá»¥ng LLM Ä‘á»ƒ parse intent"""
        
        prompt = f"""
Parse the following financial research request into structured format:

Input: "{text}"

Extract:
1. Intent type: research | compare | monitor
2. Entities:
   - ticker (stock symbol)
   - metrics (list of financial metrics)
   - timeframe (optional)
3. Constraints (optional)

Output JSON only, no explanation.

Example:
Input: "Analyze liquidity risk of Tesla"
Output:
{{
  "intent_type": "research",
  "entities": {{
    "ticker": "TSLA",
    "metrics": ["liquidity"],
    "timeframe": null
  }},
  "constraints": {{}},
  "confidence": 0.95
}}
"""
        
        response = await self.llm.complete(
            prompt,
            temperature=0.0,  ## Deterministic
            max_tokens=500
        )
        
        parsed = json.loads(response.content)
        
        return ParsedIntent(
            raw_input=text,
            intent_type=parsed["intent_type"],
            entities=parsed["entities"],
            constraints=parsed.get("constraints", {}),
            confidence=parsed["confidence"]
        )
```

#### 6.1.2 Browser Monitor

```python
## src/perception/browser_monitor.py

from dataclasses import dataclass
from typing import Optional, Dict, List
from playwright.async_api import Page
import json

@dataclass
class PageState:
    """Tráº¡ng thÃ¡i trang web hiá»‡n táº¡i"""
    url: str
    title: str
    is_loading: bool
    has_errors: bool
    error_messages: List[str]

@dataclass
class UnifiedContext:
    """Context thá»‘ng nháº¥t cho Cognition Layer"""
    intent: ParsedIntent
    page_state: PageState
    a11y_tree: Optional[Dict]
    dom_snapshot: Optional[str]
    screenshot_b64: Optional[str]
    action_history: List[Dict]
    extracted_data: Dict

class BrowserMonitor:
    """
    GiÃ¡m sÃ¡t tráº¡ng thÃ¡i trÃ¬nh duyá»‡t
    
    Strategy:
    - A11y Tree: Primary (90% cases) - Fast, semantic
    - DOM Snapshot: Backup - When A11y insufficient
    - Screenshot + Vision: Fallback (10%) - For visual elements
    """
    
    def __init__(self):
        self.use_vision_threshold = 0.1  ## 10% fallback
        
    async def capture_state(self, page: Page) -> UnifiedContext:
        """Thu tháº­p toÃ n bá»™ tráº¡ng thÃ¡i trang"""
        
        ## 1. Page state (fast)
        page_state = await self._get_page_state(page)
        
        ## 2. A11y Tree (primary)
        a11y_tree = await self._extract_a11y_tree(page)
        
        ## 3. Check if need more data
        dom_snapshot = None
        screenshot = None
        
        if not self._is_a11y_sufficient(a11y_tree):
            dom_snapshot = await self._get_dom_snapshot(page)
            
        ## 4. Vision fallback (expensive, only when needed)
        if random.random() < self.use_vision_threshold or self._needs_vision(page_state):
            screenshot = await self._capture_screenshot(page)
            
        return UnifiedContext(
            intent=None,  ## Will be filled by Input Processor
            page_state=page_state,
            a11y_tree=a11y_tree,
            dom_snapshot=dom_snapshot,
            screenshot_b64=screenshot,
            action_history=[],
            extracted_data={}
        )
        
    async def _extract_a11y_tree(self, page: Page) -> Dict:
        """
        TrÃ­ch xuáº¥t Accessibility Tree
        
        A11y Tree advantages:
        - Semantic (role, label, value)
        - Stable (less affected by CSS changes)
        - Small (96% fewer tokens than DOM)
        """
        tree = await page.accessibility.snapshot()
        
        ## Filter only interactive elements
        interactive = self._filter_interactive(tree)
        
        return {
            "buttons": interactive.get("buttons", []),
            "links": interactive.get("links", []),
            "inputs": interactive.get("inputs", []),
            "headings": interactive.get("headings", []),
            "landmarks": interactive.get("landmarks", [])
        }
        
    def _filter_interactive(self, tree: Dict) -> Dict:
        """Lá»c chá»‰ giá»¯ interactive elements"""
        interactive = {
            "buttons": [],
            "links": [],
            "inputs": [],
            "headings": [],
            "landmarks": []
        }
        
        def traverse(node):
            role = node.get("role", "")
            
            if role == "button":
                interactive["buttons"].append({
                    "label": node.get("name", ""),
                    "value": node.get("value"),
                    "enabled": not node.get("disabled", False)
                })
            elif role == "link":
                interactive["links"].append({
                    "text": node.get("name", ""),
                    "url": node.get("value")
                })
            elif role == "textbox":
                interactive["inputs"].append({
                    "label": node.get("name", ""),
                    "type": "text",
                    "required": node.get("required", False)
                })
            elif role == "heading":
                interactive["headings"].append({
                    "level": node.get("level", 1),
                    "text": node.get("name", "")
                })
            elif role in ["region", "main", "navigation"]:
                interactive["landmarks"].append({
                    "type": role,
                    "label": node.get("name", "")
                })
                
            for child in node.get("children", []):
                traverse(child)
                
        if tree:
            traverse(tree)
            
        return interactive
        
    def _is_a11y_sufficient(self, a11y_tree: Dict) -> bool:
        """Kiá»ƒm tra A11y Tree cÃ³ Ä‘á»§ thÃ´ng tin khÃ´ng"""
        ## If cÃ³ Ã­t nháº¥t 3 loáº¡i element khÃ¡c nhau â†’ sufficient
        non_empty = sum(1 for v in a11y_tree.values() if len(v) > 0)
        return non_empty >= 3
        
    def _needs_vision(self, page_state: PageState) -> bool:
        """Quyáº¿t Ä‘á»‹nh cÃ³ cáº§n Vision model khÃ´ng"""
        ## Cases cáº§n Vision:
        ## - CAPTCHA
        ## - Charts/Graphs
        ## - Complex layouts
        
        url_lower = page_state.url.lower()
        title_lower = page_state.title.lower()
        
        vision_keywords = [
            "captcha", "verify", "robot",  ## CAPTCHA
            "chart", "graph", "visualization"  ## Charts
        ]
        
        return any(keyword in url_lower or keyword in title_lower 
                   for keyword in vision_keywords)
```

### 6.2 Layer 2: COGNITION - LangGraph Agent Core

ÄÃ¢y lÃ  pháº§n **quan trá»ng nháº¥t** cá»§a há»‡ thá»‘ng.

#### 6.2.1 LangGraph State Definition

```python
## src/cognition/agent_state.py

from dataclasses import dataclass, field
from typing import List, Dict, Optional, Literal
from datetime import datetime

@dataclass
class ActionStep:
    """Má»™t bÆ°á»›c hÃ nh Ä‘á»™ng trong plan"""
    tool_name: str
    params: Dict
    reasoning: str
    confidence: float
    retry_count: int = 0

@dataclass
class Evidence:
    """Báº±ng chá»©ng thu tháº­p Ä‘Æ°á»£c"""
    source_url: str
    source_type: str  ## 'sec_filing', 'news', 'earnings_call'
    data: Dict
    timestamp: datetime
    confidence: float

@dataclass
class AgentState:
    """
    State Ä‘Æ°á»£c truyá»n qua cÃ¡c Node trong LangGraph
    
    Design Principles:
    - Immutable where possible
    - Clear ownership of each field
    - Rich enough for debugging
    """
    
    ## ============ INPUT ============
    task_id: str
    user_prompt: str
    parsed_intent: ParsedIntent
    
    ## ============ CONTEXT ============
    unified_context: UnifiedContext
    
    ## ============ PLANNING ============
    action_plan: List[ActionStep] = field(default_factory=list)
    current_step_index: int = 0
    
    ## ============ EXECUTION ============
    current_action: Optional[ActionStep] = None
    execution_result: Optional[Dict] = None
    
    ## ============ MEMORY ============
    evidence_pack: List[Evidence] = field(default_factory=list)
    action_history: List[Dict] = field(default_factory=list)
    
    ## ============ STATE MANAGEMENT ============
    status: Literal["planning", "executing", "verifying", "replanning", "synthesizing", "done", "failed"]
    error_count: int = 0
    max_errors: int = 3
    
    ## ============ METADATA ============
    reasoning_log: List[str] = field(default_factory=list)
    start_time: datetime = field(default_factory=datetime.utcnow)
    
    ## ============ RESULTS ============
    final_answer: Optional[str] = None
    investment_snapshot: Optional[Dict] = None
```

#### 6.2.2 LangGraph Graph Definition

```python
## src/cognition/agent_graph.py

from langgraph.graph import StateGraph, END
from langgraph.checkpoint.sqlite import SqliteSaver
from typing import Literal

class FinAIAgentGraph:
    """
    LangGraph State Machine cho finAI Agent
    
    Flow:
    START â†’ PLANNER â†’ EXECUTOR â†’ VERIFIER â†’ (SUCCESS: continue/done) | (FAILURE: REPLAN)
    """
    
    def __init__(self, config: Dict):
        self.config = config
        self.llm = self._init_llm()
        self.tools = self._init_tools()
        
        ## Build graph
        self.graph = self._build_graph()
        
    def _build_graph(self) -> StateGraph:
        """XÃ¢y dá»±ng LangGraph state machine"""
        
        ## Initialize graph
        workflow = StateGraph(AgentState)
        
        ## ============ ADD NODES ============
        workflow.add_node("planner", self._planner_node)
        workflow.add_node("executor", self._executor_node)
        workflow.add_node("verifier", self._verifier_node)
        workflow.add_node("replan", self._replan_node)
        workflow.add_node("synthesizer", self._synthesizer_node)
        
        ## ============ SET ENTRY POINT ============
        workflow.set_entry_point("planner")
        
        ## ============ ADD EDGES ============
        
        ## Planner â†’ Executor
        workflow.add_edge("planner", "executor")
        
        ## Executor â†’ Verifier
        workflow.add_edge("executor", "verifier")
        
        ## Verifier â†’ Conditional routing
        workflow.add_conditional_edges(
            "verifier",
            self._verifier_router,
            {
                "continue": "planner",  ## Plan next step
                "done": "synthesizer",  ## Goal achieved
                "replan": "replan"      ## Error, need replan
            }
        )
        
        ## Replan â†’ Planner
        workflow.add_edge("replan", "planner")
        
        ## Synthesizer â†’ END
        workflow.add_edge("synthesizer", END)
        
        ## ============ COMPILE WITH CHECKPOINTER ============
        memory = SqliteSaver.from_conn_string(":memory:")
        
        return workflow.compile(checkpointer=memory)
        
    ## ========================================
    ## NODE IMPLEMENTATIONS
    ## ========================================
    
    async def _planner_node(self, state: AgentState) -> Dict:
        """
        PLANNER NODE
        
        Responsibilities:
        - Analyze current context
        - Decide next action
        - Select tool & params
        - Generate reasoning
        
        Uses LLM with CoT (Chain-of-Thought)
        """
        logger.info(f"[PLANNER] Current step: {state.current_step_index + 1}")
        
        ## Build prompt vá»›i context
        prompt = self._build_planner_prompt(state)
        
        ## LLM call vá»›i CoT
        response = await self.llm.complete(
            prompt,
            temperature=0.2,  ## Low temp for planning
            max_tokens=1000
        )
        
        ## Parse response
        planned_action = self._parse_planner_response(response.content)
        
        ## Update state
        state.action_plan.append(planned_action)
        state.current_action = planned_action
        state.status = "executing"
        state.reasoning_log.append(f"[PLANNER] {planned_action.reasoning}")
        
        return {
            "action_plan": state.action_plan,
            "current_action": planned_action,
            "status": "executing",
            "reasoning_log": state.reasoning_log
        }
        
    def _build_planner_prompt(self, state: AgentState) -> str:
        """XÃ¢y dá»±ng prompt cho Planner vá»›i CoT"""
        
        return f"""
You are a financial research agent. Plan the next action to achieve the user's goal.

USER GOAL:
{state.user_prompt}

PARSED INTENT:
- Type: {state.parsed_intent.intent_type}
- Ticker: {state.parsed_intent.entities.get('ticker')}
- Metrics: {state.parsed_intent.entities.get('metrics')}

CURRENT CONTEXT:
- Current URL: {state.unified_context.page_state.url}
- Current Page Title: {state.unified_context.page_state.title}
- Actions Taken: {len(state.action_history)}
- Evidence Collected: {len(state.evidence_pack)} items

AVAILABLE TOOLS:
{self._format_tools()}

REASONING STEPS (Think Step-by-Step):
1. What information do we need next to answer the user's goal?
2. What tool will help us get that information?
3. What are the exact parameters for that tool?
4. What could go wrong? How confident are we?

OUTPUT FORMAT (JSON only):
{{
  "reasoning": "Step-by-step thinking...",
  "tool_name": "navigate | click | extract_text | extract_table | ...",
  "params": {{...}},
  "confidence": 0.0-1.0
}}
"""
        
    async def _executor_node(self, state: AgentState) -> Dict:
        """
        EXECUTOR NODE
        
        Responsibilities:
        - Execute the planned action
        - Handle errors with retry
        - Parse result
        """
        logger.info(f"[EXECUTOR] Executing: {state.current_action.tool_name}")
        
        action = state.current_action
        tool = self.tools.get(action.tool_name)
        
        if not tool:
            raise ValueError(f"Tool not found: {action.tool_name}")
        
        ## Execute with retry logic
        result = await self._execute_with_retry(
            tool,
            action.params,
            max_retries=3
        )
        
        ## Update state
        state.execution_result = result
        state.status = "verifying"
        state.action_history.append({
            "tool": action.tool_name,
            "params": action.params,
            "result": result,
            "timestamp": datetime.utcnow().isoformat()
        })
        
        return {
            "execution_result": result,
            "status": "verifying",
            "action_history": state.action_history
        }
        
    async def _execute_with_retry(
        self, 
        tool, 
        params: Dict, 
        max_retries: int = 3
    ) -> Dict:
        """Execute vá»›i exponential backoff retry"""
        
        for attempt in range(max_retries):
            try:
                result = await tool.run(**params)
                
                if result.get("success"):
                    return result
                    
            except Exception as e:
                logger.warning(f"[EXECUTOR] Attempt {attempt + 1} failed: {e}")
                
                if attempt < max_retries - 1:
                    wait_time = 2 ** attempt  ## Exponential backoff
                    await asyncio.sleep(wait_time)
                else:
                    return {
                        "success": False,
                        "error": str(e),
                        "attempts": max_retries
                    }
                    
        return {"success": False, "error": "Max retries exceeded"}
        
    async def _verifier_node(self, state: AgentState) -> Dict:
        """
        VERIFIER NODE
        
        Responsibilities:
        - Check if action succeeded
        - Validate data quality
        - Assess confidence
        - Decide: continue/done/replan
        """
        logger.info(f"[VERIFIER] Verifying execution result")
        
        result = state.execution_result
        
        ## 1. Technical Verification
        tech_check = self._technical_verification(result)
        
        if not tech_check["passed"]:
            state.error_count += 1
            state.status = "replanning"
            return {
                "status": "replanning",
                "error_count": state.error_count
            }
        
        ## 2. Data Quality Verification (LLM-based)
        if result.get("data"):
            quality_check = await self._data_quality_check(
                state.current_action.tool_name,
                result["data"]
            )
            
            if quality_check["confidence"] < 0.7:
                state.error_count += 1
                state.status = "replanning"
                state.reasoning_log.append(
                    f"[VERIFIER] Low confidence: {quality_check['reason']}"
                )
                return {
                    "status": "replanning",
                    "error_count": state.error_count,
                    "reasoning_log": state.reasoning_log
                }
        
        ## 3. Add to evidence pack if valid
        if result.get("data"):
            evidence = Evidence(
                source_url=state.unified_context.page_state.url,
                source_type=self._infer_source_type(state.unified_context.page_state.url),
                data=result["data"],
                timestamp=datetime.utcnow(),
                confidence=quality_check.get("confidence", 0.8)
            )
            state.evidence_pack.append(evidence)
        
        ## 4. Goal Progress Check
        goal_achieved = await self._check_goal_progress(state)
        
        if goal_achieved:
            state.status = "synthesizing"
            return {
                "status": "synthesizing",
                "evidence_pack": state.evidence_pack
            }
        
        ## Continue planning next step
        state.current_step_index += 1
        state.status = "planning"
        
        return {
            "current_step_index": state.current_step_index,
            "status": "planning",
            "evidence_pack": state.evidence_pack
        }
        
    def _technical_verification(self, result: Dict) -> Dict:
        """Kiá»ƒm tra ká»¹ thuáº­t: cÃ³ data, khÃ´ng cÃ³ error"""
        checks = {
            "has_data": result.get("data") is not None,
            "no_error": result.get("error") is None,
            "success_flag": result.get("success", False)
        }
        
        passed = all(checks.values())
        
        return {
            "passed": passed,
            "checks": checks,
            "reason": str(checks) if not passed else None
        }
        
    async def _data_quality_check(self, tool_name: str, data: Dict) -> Dict:
        """
        Kiá»ƒm tra cháº¥t lÆ°á»£ng dá»¯ liá»‡u báº±ng LLM
        
        Checks:
        - Data completeness
        - Format correctness
        - Semantic relevance
        """
        prompt = f"""
Verify the quality of extracted data:

Tool: {tool_name}
Data: {json.dumps(data, indent=2)}

Check:
1. Is the data complete (no missing critical fields)?
2. Is the format correct (e.g., numbers are numbers, dates are dates)?
3. Is the data semantically relevant?

Output JSON:
{{
  "confidence": 0.0-1.0,
  "reason": "...",
  "issues": [...]
}}
"""
        
        response = await self.llm.complete(prompt, temperature=0.0, max_tokens=300)
        return json.loads(response.content)
        
    async def _check_goal_progress(self, state: AgentState) -> bool:
        """
        Kiá»ƒm tra cÃ³ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu chÆ°a
        
        Criteria:
        - CÃ³ Ä‘á»§ evidence (â‰¥3 sources)
        - Tráº£ lá»i Ä‘Æ°á»£c cÃ¢u há»i chÃ­nh
        - Confidence Ä‘á»§ cao
        """
        ## Basic check: cÃ³ Ä‘á»§ evidence khÃ´ng
        if len(state.evidence_pack) < 3:
            return False
        
        ## LLM check: cÃ³ Ä‘á»§ thÃ´ng tin Ä‘á»ƒ tráº£ lá»i khÃ´ng
        prompt = f"""
User Goal: {state.user_prompt}

Evidence Collected:
{self._format_evidence(state.evidence_pack)}

Question: Do we have enough information to answer the user's goal?

Output JSON:
{{
  "goal_achieved": true/false,
  "confidence": 0.0-1.0,
  "missing": ["..."]
}}
"""
        
        response = await self.llm.complete(prompt, temperature=0.0, max_tokens=200)
        check = json.loads(response.content)
        
        return check["goal_achieved"] and check["confidence"] > 0.8
        
    async def _replan_node(self, state: AgentState) -> Dict:
        """
        REPLAN NODE
        
        Responsibilities:
        - Analyze why previous action failed
        - Generate alternative strategy
        - Update plan
        - Check error budget
        """
        logger.warning(f"[REPLAN] Replanning after error (count: {state.error_count})")
        
        ## Check error budget
        if state.error_count >= state.max_errors:
            state.status = "failed"
            return {
                "status": "failed",
                "error_count": state.error_count
            }
        
        ## Analyze failure
        prompt = f"""
Previous action failed:

Action: {json.dumps(state.current_action.__dict__)}
Result: {json.dumps(state.execution_result)}

Analyze:
1. Why did it fail?
2. What's an alternative approach?
3. Should we try different tool or different params?

Output JSON:
{{
  "root_cause": "...",
  "alternative_tool": "...",
  "alternative_params": {{...}},
  "reasoning": "..."
}}
"""
        
        response = await self.llm.complete(prompt, temperature=0.3, max_tokens=500)
        alternative = json.loads(response.content)
        
        ## Create new action step
        new_action = ActionStep(
            tool_name=alternative["alternative_tool"],
            params=alternative["alternative_params"],
            reasoning=f"[REPLAN] {alternative['reasoning']}",
            confidence=0.6  ## Lower confidence for replanned actions
        )
        
        ## Update state
        state.current_action = new_action
        state.status = "executing"
        state.reasoning_log.append(f"[REPLAN] Root cause: {alternative['root_cause']}")
        state.reasoning_log.append(f"[REPLAN] Alternative: {alternative['reasoning']}")
        
        return {
            "current_action": new_action,
            "status": "executing",
            "reasoning_log": state.reasoning_log
        }
        
    async def _synthesizer_node(self, state: AgentState) -> Dict:
        """
        SYNTHESIZER NODE
        
        Responsibilities:
        - Tá»•ng há»£p evidence thÃ nh Investment Snapshot
        - Generate executive summary
        - Identify key risks
        - Provide recommendations
        """
        logger.info(f"[SYNTHESIZER] Synthesizing {len(state.evidence_pack)} pieces of evidence")
        
        prompt = f"""
You are a financial analyst. Synthesize the collected evidence into a 1-page Investment Snapshot.

USER GOAL:
{state.user_prompt}

EVIDENCE COLLECTED:
{self._format_evidence_detailed(state.evidence_pack)}

Generate Investment Snapshot with:
1. Executive Summary (2-3 sentences)
2. Key Financial Metrics (table format)
3. Risk Analysis (top 3 risks)
4. Investment Considerations
5. Next Steps

IMPORTANT:
- Every number must have a source citation: [Source: URL]
- Be concise but complete
- Focus on actionable insights

Output Markdown format.
"""
        
        response = await self.llm.complete(
            prompt,
            temperature=0.3,
            max_tokens=2000
        )
        
        ## Parse into structured format
        snapshot = {
            "raw_markdown": response.content,
            "generated_at": datetime.utcnow().isoformat(),
            "evidence_count": len(state.evidence_pack),
            "sources": [e.source_url for e in state.evidence_pack]
        }
        
        ## Update state
        state.status = "done"
        state.final_answer = response.content
        state.investment_snapshot = snapshot
        
        return {
            "status": "done",
            "final_answer": response.content,
            "investment_snapshot": snapshot
        }
        
    ## ========================================
    ## ROUTING FUNCTIONS
    ## ========================================
    
    def _verifier_router(self, state: AgentState) -> Literal["continue", "done", "replan"]:
        """Route based on verifier result"""
        if state.status == "replanning":
            return "replan"
        elif state.status == "synthesizing":
            return "done"
        else:
            return "continue"
```

---

*(TÃ i liá»‡u tiáº¿p tá»¥c vá»›i 50+ trang ná»¯a bao gá»“m: Layer 3 Action, Layer 4 Governance, API Design, Data Design, Security, Resilience, Observability, Deployment, Testing, NFRs, Performance, Cost, Trade-offs, Runbooks, Implementation Roadmap, Checklist, Anti-patterns, Tool Recommendations, vÃ  Appendices.

Do giá»›i háº¡n Ä‘á»™ dÃ i response, tÃ´i Ä‘Ã£ trÃ¬nh bÃ y kiáº¿n trÃºc cá»‘t lÃµi vÃ  chi tiáº¿t quan trá»ng nháº¥t. Báº¡n cÃ³ muá»‘n tÃ´i tiáº¿p tá»¥c vá»›i pháº§n cá»¥ thá»ƒ nÃ o khÃ´ng?)*

Má»™t sá»‘ pháº§n quan trá»ng cáº§n bá»• sung tiáº¿p:

1. **Tool Registry chi tiáº¿t** (navigate, click, extract tools)
2. **Browser Controller implementation** vá»›i Playwright
3. **Memory System** (Redis short-term + Pinecone RAG)
4. **Governance Layer** (Guardrails + HITL)
5. **API Design** (REST endpoints cho Chrome Extension)
6. **Security Design** (JWT auth, encryption, compliance)
7. **Testing Strategy** (unit, integration, E2E cho agent)
8. **Deployment** (Kubernetes, CI/CD, IaC)
9. **Monitoring** (LangSmith tracing, Datadog metrics)
10. **Runbooks** (incident response cho agent failures)

Pháº§n nÃ o báº¡n muá»‘n tÃ´i triá»ƒn khai tiáº¿p?